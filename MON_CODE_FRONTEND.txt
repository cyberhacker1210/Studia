CONTEXTE : EXPORT CODE FRONTEND
Nombre de fichiers : 68
Nombre total de lignes : 8742
--------------------------------------------------
LISTE DES FICHIERS :
- frontend/app/layout.tsx
- frontend/app/page.tsx
- frontend/app/globals.css
- frontend/app/sign-up/[[...sign-up]]/page.tsx
- frontend/app/workspace/layout.tsx
- frontend/app/workspace/page.tsx
- frontend/app/workspace/capture/page.tsx
- frontend/app/workspace/flashcards/page.tsx
- frontend/app/workspace/flashcards/generate/page.tsx
- frontend/app/workspace/flashcards/[deckId]/page.tsx
- frontend/app/workspace/chat/page.tsx
- frontend/app/workspace/quiz/page.tsx
- frontend/app/workspace/quiz/retake/[id]/page.tsx
- frontend/app/workspace/quiz/history/page.tsx
- frontend/app/workspace/quiz/generate/page.tsx
- frontend/app/workspace/courses/page.tsx
- frontend/app/workspace/courses/[id]/page.tsx
- frontend/app/workspace/courses/[id]/mastery/page.tsx
- frontend/app/workspace/courses/[id]/generate-quiz/page.tsx
- frontend/app/workspace/courses/[id]/generate-flashcards/page.tsx
- frontend/app/workspace/stats/page.tsx
- frontend/app/api/waitlist/route.ts
- frontend/app/sign-in/[[...sign-in]]/page.tsx
- frontend/components/Hero.tsx
- frontend/components/Navbar.tsx
- frontend/components/LanguageToggle.tsx
- frontend/components/InstallPWA.tsx
- frontend/components/Features.tsx
- frontend/components/Footer.tsx
- frontend/components/CTA.tsx
- frontend/components/Creator.tsx
- frontend/components/WhyStudia.tsx
- frontend/components/About.tsx
- frontend/components/ui/LoadingSpinner.tsx
- frontend/components/ui/Toast.tsx
- frontend/components/layout/Sidebar.tsx
- frontend/components/workspace/QuizDisplay.tsx
- frontend/components/workspace/InstallPWA.tsx
- frontend/components/workspace/CourseChat.tsx
- frontend/components/workspace/MotivatorWidget.tsx
- frontend/components/workspace/ImageUpload.tsx
- frontend/components/workspace/MultiImageCapture.tsx
- frontend/components/workspace/QuizGenerator.tsx
- frontend/components/workspace/CourseActions.tsx
- frontend/components/workspace/QuizHistoryCard.tsx
- frontend/components/workspace/LoadingFeedback.tsx
- frontend/components/workspace/QuizResults.tsx
- frontend/components/workspace/WorkspaceNavbar.tsx
- frontend/components/workspace/FlashcardViewer.tsx
- frontend/components/workspace/OfflineIndicator.tsx
- frontend/components/workspace/GlobalSearch.tsx
- frontend/components/workspace/XpBar.tsx
- frontend/public/offline.html
- frontend/public/manifest.json
- frontend/public/sw.js
- frontend/hooks/useQuizLimit.ts
- frontend/lib/useSupabaseUser.ts
- frontend/lib/api.ts
- frontend/lib/exportService.ts
- frontend/lib/translations.ts
- frontend/lib/themeStore.ts
- frontend/lib/courseService.ts
- frontend/lib/supabase.ts
- frontend/lib/flashcardService.ts
- frontend/lib/gamificationService.ts
- frontend/lib/pwaService.ts
- backend/src/studia/quiz.json
- venv_studia/lib/python3.13/site-packages/urllib3/contrib/emscripten/emscripten_fetch_worker.js
--------------------------------------------------


==================================================
FICHIER : frontend/app/layout.tsx
==================================================

import type { Metadata } from "next";
import { Inter } from "next/font/google";
import "./globals.css";
import { LanguageProvider } from "@/contexts/LanguageContext";
import { ClerkProvider } from '@clerk/nextjs'; // üëà L'import vital

// Configuration de la police
const inter = Inter({
  subsets: ["latin"],
  variable: '--font-inter',
  display: 'swap',
});

export const metadata: Metadata = {
  title: "Studia",
  description: "Apprenez mieux, pas plus dur.",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    // üëá C'est ICI que Clerk est activ√© pour TOUT le site
    <ClerkProvider>
      <html lang="fr" className={inter.variable}>
        <body className="min-h-screen flex flex-col bg-white selection:bg-slate-900 selection:text-white">
          <LanguageProvider>
            {children}
          </LanguageProvider>
        </body>
      </html>
    </ClerkProvider>
  );
}

==================================================
FICHIER : frontend/app/page.tsx
==================================================

'use client';

import Link from 'next/link';
import { Brain, ArrowRight, Zap, Layers, Sparkles, Check } from 'lucide-react';

export default function LandingPage() {
  return (
    <main className="min-h-screen flex flex-col font-sans">

      {/* NAVBAR */}
      <nav className="fixed top-0 w-full bg-white/95 backdrop-blur border-b border-slate-100 z-50">
        <div className="max-w-6xl mx-auto px-6 h-16 flex justify-between items-center">
          <div className="flex items-center gap-2 text-xl font-extrabold tracking-tight">
             <Brain size={24} className="text-slate-900" fill="black" />
             Studia.
          </div>
          <div className="flex items-center gap-4">
            <Link href="/sign-in" className="font-bold text-slate-500 hover:text-slate-900 text-sm">
              Se connecter
            </Link>
            <Link href="/sign-up" className="btn-b-primary text-sm py-2 px-4 h-10">
              S'inscrire
            </Link>
          </div>
        </div>
      </nav>

      {/* HERO */}
      <section className="pt-32 pb-20 px-6 text-center max-w-4xl mx-auto">
        <div className="animate-in fade-in slide-in-from-bottom-8 duration-700">
            <h1 className="text-5xl md:text-7xl font-extrabold text-slate-900 mb-6 leading-tight tracking-tight">
              Apprenez <span className="text-blue-600">interactivement</span>.
            </h1>
            <p className="text-xl text-slate-500 font-medium mb-10 max-w-2xl mx-auto leading-relaxed">
              Studia remplace les cours passifs par des quiz et des d√©fis interactifs g√©n√©r√©s par IA. La meilleure fa√ßon de retenir.
            </p>

            <div className="flex flex-col sm:flex-row justify-center gap-4 mb-16">
              <Link href="/sign-up" className="btn-b-primary text-lg px-10">
                Commencer Gratuitement
              </Link>
              <Link href="#demo" className="btn-b-secondary text-lg px-10">
                Voir la d√©mo
              </Link>
            </div>

            {/* VISUAL DEMO */}
            <div className="relative mx-auto max-w-3xl">
                <div className="absolute inset-0 bg-gradient-to-b from-blue-500/20 to-purple-500/20 blur-3xl -z-10 rounded-full"></div>
                <div className="bg-white border-2 border-slate-200 rounded-[2rem] shadow-2xl overflow-hidden">
                    <div className="bg-slate-50 p-4 border-b border-slate-200 flex gap-2">
                        <div className="w-3 h-3 bg-slate-300 rounded-full"></div>
                        <div className="w-3 h-3 bg-slate-300 rounded-full"></div>
                    </div>
                    <div className="p-8 md:p-12 grid md:grid-cols-2 gap-8 items-center text-left">
                         <div>
                             <div className="text-xs font-bold text-blue-600 uppercase mb-2">G√©n√©ration IA</div>
                             <h3 className="text-2xl font-bold mb-2">De la photo au Quiz.</h3>
                             <p className="text-slate-500 mb-4">Uploadez votre cours. Studia cr√©e instantan√©ment un module interactif.</p>
                             <div className="flex items-center gap-2 text-sm font-bold text-slate-900">
                                 <Check size={16} className="text-green-500" /> Pr√©cision 99%
                             </div>
                         </div>
                         <div className="space-y-3">
                             {[1,2,3].map(i => (
                                 <div key={i} className="bg-white border-2 border-slate-100 p-3 rounded-xl flex items-center gap-3 shadow-sm animate-pulse">
                                     <div className="w-8 h-8 bg-slate-100 rounded-lg"></div>
                                     <div className="h-2 bg-slate-100 rounded w-24"></div>
                                 </div>
                             ))}
                         </div>
                    </div>
                </div>
            </div>
        </div>
      </section>

      {/* VALUE PROPS (Grid style Brilliant) */}
      <section className="py-24 bg-slate-50 px-6 border-t border-slate-200">
          <div className="max-w-6xl mx-auto">
              <div className="grid md:grid-cols-3 gap-6">
                  {[
                      { title: "Compr√©hension Visuelle", desc: "Des flashcards claires g√©n√©r√©es automatiquement.", icon: Layers, color: "blue" },
                      { title: "Feedback Imm√©diat", desc: "Sachez tout de suite si vous avez compris.", icon: Zap, color: "amber" },
                      { title: "Tuteur Personnel", desc: "Posez des questions √† votre cours comme √† un prof.", icon: Sparkles, color: "purple" }
                  ].map((item, i) => (
                      <div key={i} className="bg-white border-2 border-slate-100 rounded-[2rem] p-8 hover:-translate-y-1 hover:shadow-xl transition-all duration-300">
                          <div className={`w-16 h-16 bg-${item.color}-50 text-${item.color}-600 rounded-2xl flex items-center justify-center mb-6`}>
                              <item.icon size={32} strokeWidth={2} />
                          </div>
                          <h3 className="text-xl font-bold text-slate-900 mb-3">{item.title}</h3>
                          <p className="text-slate-500 font-medium leading-relaxed">{item.desc}</p>
                      </div>
                  ))}
              </div>
          </div>
      </section>

      {/* FOOTER */}
      <footer className="mt-auto py-12 bg-white border-t border-slate-100 text-center">
          <div className="font-bold text-slate-900 text-xl mb-2">Studia.</div>
          <p className="text-slate-400 text-sm">Con√ßu pour les esprits curieux.</p>
      </footer>
    </main>
  );
}

==================================================
FICHIER : frontend/app/globals.css
==================================================

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply bg-white text-slate-900 antialiased;
  }
}

@layer components {
  /* BOUTON "BRILLIANT STYLE" (Effet 3D) */
  .btn-b-primary {
    @apply bg-slate-900 text-white font-bold py-3 px-6 rounded-2xl
    border-b-4 border-slate-700 hover:bg-slate-800 hover:border-slate-600
    active:border-b-0 active:translate-y-1 active:mb-1
    transition-all duration-100 flex items-center justify-center gap-2 disabled:opacity-50 disabled:pointer-events-none;
  }

  .btn-b-secondary {
    @apply bg-white text-slate-600 font-bold py-3 px-6 rounded-2xl
    border-2 border-slate-200 border-b-4 hover:border-slate-300 hover:bg-slate-50
    active:border-b-2 active:translate-y-[2px] active:mb-[2px]
    transition-all duration-100 flex items-center justify-center gap-2;
  }

  .btn-b-accent {
    @apply bg-blue-600 text-white font-bold py-3 px-6 rounded-2xl
    border-b-4 border-blue-800 hover:bg-blue-500 hover:border-blue-700
    active:border-b-0 active:translate-y-1 active:mb-1
    transition-all duration-100 flex items-center justify-center gap-2;
  }

  /* CARTES INTERACTIVES */
  .card-b {
    @apply bg-white border-2 border-slate-100 rounded-3xl p-6
    hover:border-slate-300 hover:shadow-lg transition-all duration-300 cursor-pointer block;
  }

  /* INPUTS */
  .input-b {
    @apply w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-900
    focus:outline-none focus:border-slate-900 focus:bg-white transition-colors placeholder:text-slate-400 placeholder:font-medium;
  }
}

==================================================
FICHIER : frontend/app/sign-up/[[...sign-up]]/page.tsx
==================================================

import { SignUp } from '@clerk/nextjs';

export default function SignUpPage() {
  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-white">
      <SignUp />
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/layout.tsx
==================================================

'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { UserButton } from '@clerk/nextjs';
import { Home, PlusCircle, MessageCircle, Library, Brain } from 'lucide-react';

export default function WorkspaceLayout({ children }: { children: React.ReactNode }) {
  const pathname = usePathname();

  const NavItem = ({ href, icon: Icon, label }: { href: string, icon: any, label: string }) => {
    const isActive = pathname === href;
    return (
      <Link
        href={href}
        className={`group flex items-center gap-3 px-4 py-3 rounded-2xl transition-all duration-200 font-bold ${
          isActive 
            ? 'bg-slate-900 text-white shadow-lg shadow-slate-200' 
            : 'text-slate-500 hover:bg-slate-100 hover:text-slate-900'
        }`}
      >
        <Icon size={20} strokeWidth={isActive ? 2.5 : 2} />
        <span>{label}</span>
      </Link>
    );
  };

  return (
    <div className="min-h-screen bg-white flex">
      {/* SIDEBAR DESKTOP */}
      <aside className="w-72 hidden md:flex flex-col border-r border-slate-100 h-screen sticky top-0 p-6">
        <div className="flex items-center gap-2 font-bold text-xl tracking-tight mb-10 px-2">
            <div className="w-8 h-8 bg-slate-900 text-white flex items-center justify-center rounded-lg">
              <Brain size={18} />
            </div>
            Studia
        </div>

        <nav className="flex-1 space-y-2">
          <NavItem href="/workspace" icon={Home} label="Tableau de bord" />
          <NavItem href="/workspace/courses" icon={Library} label="Mes Cours" />
          <NavItem href="/workspace/chat" icon={MessageCircle} label="Tuteur IA" />
        </nav>

        <div className="mt-auto">
            <Link href="/workspace/capture" className="flex items-center justify-center gap-2 w-full bg-blue-600 text-white font-bold py-3 rounded-2xl shadow-lg hover:bg-blue-700 transition-all mb-6 active:scale-95">
                <PlusCircle size={20} />
                <span>Nouveau Cours</span>
            </Link>

            <div className="flex items-center gap-3 p-3 bg-slate-50 rounded-2xl border border-slate-100">
                <UserButton afterSignOutUrl="/" />
                <div className="text-xs font-bold text-slate-900">Mon Profil</div>
            </div>
        </div>
      </aside>

      {/* MOBILE CONTENT WRAPPER */}
      <div className="flex-1 flex flex-col min-w-0">
         {/* MOBILE HEADER */}
         <header className="md:hidden h-16 border-b border-slate-100 flex items-center justify-between px-4 sticky top-0 bg-white/90 backdrop-blur z-40">
            <div className="font-bold text-lg flex items-center gap-2">
                <Brain size={20} className="text-slate-900"/> Studia
            </div>
            <UserButton afterSignOutUrl="/" />
         </header>

         <main className="flex-1 p-4 md:p-8 lg:p-12 overflow-y-auto">
             <div className="max-w-5xl mx-auto">
                {children}
             </div>
         </main>

         {/* MOBILE BOTTOM NAV */}
         <nav className="md:hidden h-16 bg-white border-t border-slate-100 flex items-center justify-around px-2 fixed bottom-0 w-full z-50 pb-safe">
            <Link href="/workspace" className="p-2 text-slate-500 hover:text-slate-900"><Home size={24}/></Link>
            <Link href="/workspace/capture" className="p-3 bg-slate-900 text-white rounded-full -mt-8 shadow-lg border-4 border-white"><PlusCircle size={24}/></Link>
            <Link href="/workspace/chat" className="p-2 text-slate-500 hover:text-slate-900"><MessageCircle size={24}/></Link>
         </nav>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/page.tsx
==================================================

'use client';

import { useUser } from '@clerk/nextjs';
import Link from 'next/link';
import { useEffect, useState } from 'react';
import { Plus, Flame, ArrowRight, Book, Clock, Trophy } from 'lucide-react';
import { getUserCourses, Course } from '@/lib/courseService';

export default function WorkspacePage() {
  const { user } = useUser();
  const [courses, setCourses] = useState<Course[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (user) {
      getUserCourses(user.id).then(data => {
        setCourses(data);
        setLoading(false);
      });
    }
  }, [user]);

  return (
    <div className="animate-in fade-in duration-500 pb-20 md:pb-0">

      {/* HEADER & STREAK */}
      <div className="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-10">
        <div>
          <h1 className="text-3xl font-extrabold text-slate-900">
            Bon retour, {user?.firstName} üëã
          </h1>
          <p className="text-slate-500 font-medium mt-1">Pr√™t pour votre session du jour ?</p>
        </div>

        <div className="flex items-center gap-3 bg-white border-2 border-slate-100 px-4 py-2 rounded-xl shadow-sm">
             <Flame size={20} className="text-amber-500 fill-amber-500 animate-pulse" />
             <div className="flex flex-col">
                 <span className="text-[10px] font-bold text-slate-400 uppercase">S√©rie</span>
                 <span className="text-sm font-extrabold text-slate-900">1 Jour</span>
             </div>
        </div>
      </div>

      {/* HERO ACTION CARD */}
      <div className="grid md:grid-cols-3 gap-6 mb-12">
          {/* CREATE NEW (Large) */}
          <Link href="/workspace/capture" className="col-span-2 bg-slate-900 rounded-[2rem] p-8 relative overflow-hidden group hover:shadow-2xl hover:shadow-slate-900/20 hover:-translate-y-1 transition-all duration-300 cursor-pointer">
              <div className="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16 group-hover:bg-white/20 transition-colors"></div>
              <div className="relative z-10 h-full flex flex-col justify-between">
                  <div className="flex justify-between items-start">
                      <div className="w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center text-white">
                          <Plus size={32} />
                      </div>
                      <div className="bg-white/10 px-3 py-1 rounded-full text-xs font-bold text-white">
                          Nouveau
                      </div>
                  </div>
                  <div>
                      <h2 className="text-3xl font-bold text-white mb-2">Ajouter un cours</h2>
                      <p className="text-slate-300 font-medium mb-6">Transformez vos notes en exp√©rience interactive.</p>
                      <span className="inline-flex items-center gap-2 bg-white text-slate-900 px-6 py-3 rounded-xl font-bold text-sm group-hover:scale-105 transition-transform">
                          Commencer <ArrowRight size={16} />
                      </span>
                  </div>
              </div>
          </Link>

          {/* PROGRESS WIDGET */}
          <div className="bg-blue-50 border-2 border-blue-100 rounded-[2rem] p-8 flex flex-col justify-between">
               <div>
                   <div className="w-12 h-12 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center mb-4">
                       <Trophy size={24} strokeWidth={2.5} />
                   </div>
                   <h3 className="font-bold text-blue-900 text-lg">Niveau 3</h3>
                   <p className="text-blue-600/80 text-sm font-medium">Continuez comme √ßa !</p>
               </div>
               <div className="w-full bg-blue-200 h-3 rounded-full overflow-hidden">
                   <div className="bg-blue-600 h-full w-[65%] rounded-full"></div>
               </div>
          </div>
      </div>

      {/* COURSES GRID */}
      <div className="flex items-center justify-between mb-6">
          <h2 className="text-xl font-extrabold text-slate-900">Reprendre</h2>
          <Link href="/workspace/courses" className="text-sm font-bold text-slate-400 hover:text-slate-900 transition-colors">Tout voir</Link>
      </div>

      <div className="grid md:grid-cols-3 gap-6">
          {loading ? (
             [1,2,3].map(i => <div key={i} className="h-48 bg-slate-50 rounded-3xl animate-pulse"></div>)
          ) : courses.length === 0 ? (
             <div className="col-span-full py-12 text-center border-2 border-dashed border-slate-200 rounded-3xl">
                 <p className="text-slate-400 font-bold">Aucun cours. C'est le moment de s'y mettre !</p>
             </div>
          ) : (
             courses.map(course => (
                 <Link href={`/workspace/courses/${course.id}`} key={course.id} className="card-b group flex flex-col h-full">
                     <div className="flex items-start justify-between mb-4">
                         <div className="w-12 h-12 bg-slate-100 text-slate-900 rounded-xl flex items-center justify-center font-extrabold text-xl group-hover:bg-slate-900 group-hover:text-white transition-colors">
                             {course.title.charAt(0).toUpperCase()}
                         </div>
                     </div>

                     <h3 className="text-lg font-bold text-slate-900 mb-2 line-clamp-2 leading-tight group-hover:text-blue-600 transition-colors">
                         {course.title}
                     </h3>

                     <div className="mt-auto pt-4 flex items-center gap-3 text-xs font-bold text-slate-400 border-t border-slate-50">
                         <span className="flex items-center gap-1"><Book size={14}/> {new Date(course.created_at).toLocaleDateString()}</span>
                     </div>
                 </Link>
             ))
          )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/capture/page.tsx
==================================================

'use client';

import { useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { ArrowLeft, Loader2, UploadCloud, Layers, Sparkles } from 'lucide-react';
import { saveCourse } from '@/lib/courseService';
import { extractTextFromMultipleImages } from '@/lib/api';
import MultiImageCapture from '@/components/workspace/MultiImageCapture';
import { addXp } from '@/lib/gamificationService';

export default function CapturePage() {
  const { user } = useUser();
  const router = useRouter();
  const [selectedImages, setSelectedImages] = useState<string[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleImagesSelected = (images: string[]) => {
    setSelectedImages(images);
    setError(null);
  };

  const handleExtract = async () => {
    if (!user || selectedImages.length === 0) return;
    try {
      setLoading(true);
      setError(null);
      // Simulation UX
      await new Promise(resolve => setTimeout(resolve, 800));

      const result = await extractTextFromMultipleImages(selectedImages);
      const autoTitle = `Cours du ${new Date().toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
      const course = await saveCourse(user.id, result.extractedText, autoTitle);
      await addXp(user.id, 50, 'Nouveau cours cr√©√©');
      router.push(`/workspace/courses/${course.id}`);
    } catch (err: any) {
      console.error(err);
      setError(err.message || "Erreur d'analyse");
      setLoading(false);
    }
  };

  return (
    <div className="max-w-3xl mx-auto py-6 animate-in fade-in slide-in-from-bottom-4">

        <button onClick={() => router.push('/workspace')} className="flex items-center gap-2 text-slate-500 font-bold text-sm hover:text-slate-900 mb-8 transition-colors">
            <div className="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center"><ArrowLeft size={16}/></div>
            Retour
        </button>

        <div className="text-center mb-10">
            <div className="inline-flex items-center gap-2 bg-blue-50 text-blue-600 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider mb-3">
                <Sparkles size={12} /> IA G√©n√©rative
            </div>
            <h1 className="text-3xl font-extrabold text-slate-900 mb-2">Num√©riser un cours</h1>
            <p className="text-slate-500 font-medium">Prenez des photos claires pour un meilleur r√©sultat.</p>
        </div>

        <div className="bg-white border-2 border-slate-100 rounded-[2rem] p-8 shadow-sm">
             <MultiImageCapture
                onImagesSelected={handleImagesSelected}
                maxImages={10}
             />

             {selectedImages.length > 0 && (
                <div className="mt-8 pt-6 border-t-2 border-slate-50 flex flex-col sm:flex-row items-center justify-between gap-4 animate-in fade-in">
                    <div className="flex items-center gap-2 text-slate-600 font-bold text-sm bg-slate-50 px-4 py-2 rounded-xl">
                        <Layers size={18} className="text-blue-600"/> {selectedImages.length} images
                    </div>

                    <button
                        onClick={handleExtract}
                        disabled={loading}
                        className="btn-b-primary w-full sm:w-auto min-w-[200px]"
                    >
                        {loading ? <Loader2 className="animate-spin"/> : <UploadCloud />}
                        {loading ? 'Analyse...' : 'G√©n√©rer le Cours'}
                    </button>
                </div>
             )}
        </div>

        {error && (
            <div className="mt-6 p-4 bg-red-50 border-2 border-red-100 text-red-600 rounded-2xl font-bold text-center text-sm">
                {error}
            </div>
        )}
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/flashcards/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { getUserFlashcardDecks, deleteFlashcardDeck, FlashcardDeck } from '@/lib/flashcardService';
import { ArrowLeft, Layers, Trash2, Eye, Loader2, Calendar, Sparkles } from 'lucide-react';

export default function FlashcardsPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [decks, setDecks] = useState<FlashcardDeck[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (isLoaded && user) {
      loadDecks();
    }
  }, [isLoaded, user]);

  const loadDecks = async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await getUserFlashcardDecks(user.id);
      setDecks(data);
    } catch (err: any) {
      console.error('Erreur chargement decks:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (deckId: number) => {
    if (!confirm('√ätes-vous s√ªr de vouloir supprimer ce deck ?')) return;
    if (!user) return;

    try {
      await deleteFlashcardDeck(deckId, user.id);
      loadDecks();
    } catch (err: any) {
      alert(`Erreur: ${err.message}`);
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <div className="text-center">
          <Loader2 className="animate-spin h-12 w-12 text-purple-600 mx-auto mb-4" />
          <p className="text-gray-600">Chargement des flashcards...</p>
        </div>
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  const totalCards = decks.reduce((acc, deck) => acc + deck.flashcards.length, 0);

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="mb-8">
          <button
            onClick={() => router.push('/workspace')}
            className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
          >
            <ArrowLeft size={20} className="mr-2" />
            Retour au Workspace
          </button>

          <div className="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
            <div>
              <h1 className="text-4xl font-bold text-gray-900 mb-2">
                üé¥ Mes Flashcards
              </h1>
              <p className="text-gray-600 text-lg">
                Tous vos decks de r√©vision
              </p>
            </div>

            {/* Bouton Cr√©er */}
            <button
              onClick={() => router.push('/workspace/flashcards/generate')}
              className="mt-4 md:mt-0 px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover:from-purple-700 hover:to-pink-700 transition-all shadow-lg transform hover:scale-105 flex items-center space-x-2"
            >
              <Sparkles size={24} />
              <span>‚ú® Cr√©er des Flashcards</span>
            </button>
          </div>
        </div>

        {/* Stats */}
        <div className="grid md:grid-cols-2 gap-6 mb-8">
          <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-purple-600">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-gray-600 text-sm font-medium">Total de Decks</p>
                <p className="text-3xl font-bold text-gray-900 mt-1">{decks.length}</p>
              </div>
              <div className="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                <Layers size={24} className="text-purple-600" />
              </div>
            </div>
          </div>

          <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-indigo-600">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-gray-600 text-sm font-medium">Total de Cartes</p>
                <p className="text-3xl font-bold text-gray-900 mt-1">{totalCards}</p>
              </div>
              <div className="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center">
                <Calendar size={24} className="text-indigo-600" />
              </div>
            </div>
          </div>
        </div>

        {/* Error */}
        {error && (
          <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <p className="text-red-600">‚ùå {error}</p>
          </div>
        )}

        {/* Decks List */}
        {decks.length === 0 ? (
          <div className="bg-white rounded-2xl shadow-lg p-12 text-center">
            <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <Layers size={48} className="text-gray-400" />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-2">
              Aucun deck de flashcards
            </h3>
            <p className="text-gray-600 mb-6">
              Cr√©ez votre premier deck depuis un cours !
            </p>
            <div className="flex flex-col sm:flex-row gap-4 justify-center">
              <button
                onClick={() => router.push('/workspace/flashcards/generate')}
                className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-all"
              >
                ‚ú® Cr√©er des Flashcards
              </button>
              <button
                onClick={() => router.push('/workspace/courses')}
                className="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-all"
              >
                üìö Voir mes cours
              </button>
            </div>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {decks.map((deck) => (
              <div
                key={deck.id}
                className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl transition-all transform hover:scale-105"
              >
                {/* Header */}
                <div className="p-6 bg-gradient-to-br from-purple-50 to-indigo-50 border-b border-gray-200">
                  <div className="flex items-center justify-between mb-2">
                    <span className="px-3 py-1 bg-purple-200 text-purple-800 text-xs font-semibold rounded-full">
                      {deck.flashcards.length} cartes
                    </span>
                    <span className="text-xs text-gray-500 capitalize">
                      {deck.difficulty}
                    </span>
                  </div>
                  <h3 className="text-lg font-bold text-gray-900 line-clamp-2">
                    {deck.title}
                  </h3>
                </div>

                {/* Content */}
                <div className="p-6">
                  <div className="flex items-center text-sm text-gray-500 mb-4">
                    <Calendar size={16} className="mr-1" />
                    {new Date(deck.created_at).toLocaleDateString('fr-FR', {
                      day: 'numeric',
                      month: 'long',
                      year: 'numeric'
                    })}
                  </div>

                  {/* Preview */}
                  <div className="mb-4 p-3 bg-gray-50 rounded-lg border border-gray-200">
                    <p className="text-sm text-gray-600 font-medium mb-1">
                      Aper√ßu :
                    </p>
                    <p className="text-xs text-gray-700 line-clamp-2">
                      {deck.flashcards[0]?.front}
                    </p>
                  </div>

                  {/* Actions */}
                  <div className="flex gap-3">
                    <button
                      onClick={() => router.push(`/workspace/flashcards/${deck.id}`)}
                      className="flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-all"
                    >
                      <Eye size={18} />
                      <span>R√©viser</span>
                    </button>
                    <button
                      onClick={() => handleDelete(deck.id)}
                      className="p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                    >
                      <Trash2 size={20} />
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/flashcards/generate/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { getUserCourses, Course } from '@/lib/courseService';
import { ArrowLeft, Loader2, BookOpen, ChevronRight, Calendar } from 'lucide-react';

export default function SelectCourseForFlashcardsPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [courses, setCourses] = useState<Course[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (isLoaded && user) {
      loadCourses();
    }
  }, [isLoaded, user]);

  const loadCourses = async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await getUserCourses(user.id);
      setCourses(data);
    } catch (err: any) {
      console.error('Erreur chargement cours:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <div className="text-center">
          <Loader2 className="animate-spin h-12 w-12 text-purple-600 mx-auto mb-4" />
          <p className="text-gray-600">Chargement des cours...</p>
        </div>
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <button
          onClick={() => router.push('/workspace/flashcards')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour
        </button>

        <div className="text-center mb-12">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            üé¥ S√©lectionnez un Cours
          </h1>
          <p className="text-lg text-gray-600">
            Choisissez le cours depuis lequel g√©n√©rer des flashcards
          </p>
        </div>

        {/* Error */}
        {error && (
          <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <p className="text-red-600">‚ùå {error}</p>
          </div>
        )}

        {/* Courses List */}
        {courses.length === 0 ? (
          <div className="bg-white rounded-2xl shadow-lg p-12 text-center max-w-2xl mx-auto">
            <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <BookOpen size={48} className="text-gray-400" />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-2">
              Aucun cours disponible
            </h3>
            <p className="text-gray-600 mb-6">
              Capturez d'abord un cours pour pouvoir g√©n√©rer des flashcards
            </p>
            <button
              onClick={() => router.push('/workspace/capture')}
              className="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-all"
            >
              üì∏ Capturer un cours
            </button>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {courses.map((course) => (
              <button
                key={course.id}
                onClick={() => router.push(`/workspace/courses/${course.id}/generate-flashcards`)}
                className="group bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl hover:border-purple-500 transition-all transform hover:scale-105 text-left"
              >
                {/* Preview du texte */}
                <div className="p-6 bg-gradient-to-br from-purple-50 to-pink-50 border-b border-gray-200 h-32 overflow-hidden">
                  <p className="text-sm text-gray-700 line-clamp-4 font-mono">
                    {course.extracted_text.substring(0, 200)}...
                  </p>
                </div>

                {/* Content */}
                <div className="p-6">
                  <h3 className="text-lg font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-purple-600 transition-colors">
                    {course.title}
                  </h3>

                  <div className="flex items-center text-sm text-gray-500 mb-4">
                    <Calendar size={16} className="mr-1" />
                    {new Date(course.created_at).toLocaleDateString('fr-FR', {
                      day: 'numeric',
                      month: 'long',
                      year: 'numeric'
                    })}
                  </div>

                  <div className="text-xs text-gray-500 mb-4">
                    {course.extracted_text.length} caract√®res
                  </div>

                  {/* Action */}
                  <div className="flex items-center justify-between pt-4 border-t border-gray-200">
                    <span className="text-purple-600 font-semibold text-sm">
                      G√©n√©rer des flashcards
                    </span>
                    <ChevronRight className="text-purple-600 group-hover:translate-x-1 transition-transform" size={20} />
                  </div>
                </div>
              </button>
            ))}
          </div>
        )}

        {/* Quick Action */}
        {courses.length > 0 && (
          <div className="mt-12 text-center">
            <p className="text-gray-600 mb-4">Vous n'avez pas le bon cours ?</p>
            <button
              onClick={() => router.push('/workspace/capture')}
              className="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg"
            >
              üì∏ Capturer un nouveau cours
            </button>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/flashcards/[deckId]/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import { getFlashcardDeckById, FlashcardDeck, saveCardProgress } from '@/lib/flashcardService';
import { ArrowLeft, Loader2 } from 'lucide-react';
import FlashcardViewer from '@/components/workspace/FlashcardViewer';

export default function FlashcardReviewPage() {
  const params = useParams();
  const router = useRouter();
  const { user, isLoaded } = useUser();
  const [deck, setDeck] = useState<FlashcardDeck | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (isLoaded && user && params.deckId) {
      loadDeck();
    }
  }, [isLoaded, user, params.deckId]);

  const loadDeck = async () => {
    if (!user) return;

    try {
      const data = await getFlashcardDeckById(Number(params.deckId), user.id);
      if (!data) {
        router.push('/workspace/flashcards');
        return;
      }
      setDeck(data);
    } catch (err) {
      console.error('Erreur chargement deck:', err);
      router.push('/workspace/flashcards');
    } finally {
      setLoading(false);
    }
  };

  const handleProgress = async (cardIndex: number, remembered: boolean) => {
    if (!user || !deck) return;

    try {
      console.log('üíæ Tentative sauvegarde progression...');
      await saveCardProgress(user.id, deck.id, cardIndex, remembered);
      console.log(`‚úÖ Progression sauvegard√©e: carte ${cardIndex}, connu: ${remembered}`);
    } catch (err: any) {
      // ‚úÖ CORRECTION: Meilleur logging de l'erreur
      console.error('‚ùå Erreur sauvegarde progression:', {
        error: err,
        message: err?.message,
        code: err?.code,
        details: err?.details,
        hint: err?.hint,
        userId: user.id,
        deckId: deck.id,
        cardIndex
      });

      // Optionnel: Afficher un toast/notification √† l'utilisateur
      // toast.error('Impossible de sauvegarder la progression');
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <Loader2 className="animate-spin h-12 w-12 text-purple-600" />
      </div>
    );
  }

  if (!deck) return null;

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-4xl mx-auto">
        {/* Header */}
        <button
          onClick={() => router.push('/workspace/flashcards')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour aux flashcards
        </button>

        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-2">
            {deck.title}
          </h1>
          <p className="text-gray-600">
            {deck.flashcards.length} cartes ‚Ä¢ {deck.difficulty}
          </p>
        </div>

        {/* Flashcard Viewer */}
        <div className="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
          <FlashcardViewer
            flashcards={deck.flashcards}
            onProgress={handleProgress}
          />
        </div>

        {/* Back to List */}
        <div className="text-center mt-8">
          <button
            onClick={() => router.push('/workspace/flashcards')}
            className="px-8 py-3 bg-white text-gray-700 border-2 border-gray-300 rounded-xl font-bold hover:bg-gray-50 transition-all shadow-lg"
          >
            Voir tous mes decks
          </button>
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/chat/page.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { getUserCourses, Course } from '@/lib/courseService';
import CourseChat from '@/components/workspace/CourseChat';
import { MessageSquare, BookOpen, ArrowLeft, Loader2, Bot } from 'lucide-react';

export default function ChatPage() {
  const { user } = useUser();
  const router = useRouter();
  const [courses, setCourses] = useState<Course[]>([]);
  const [selectedCourse, setSelectedCourse] = useState<Course | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (user) loadCourses();
  }, [user]);

  const loadCourses = async () => {
    if (!user) return;
    try {
      const data = await getUserCourses(user.id);
      setCourses(data);
    } catch (error) {
      console.error(error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-white">
        <div className="flex flex-col items-center gap-4">
            <Loader2 className="w-8 h-8 text-slate-900 animate-spin" />
            <span className="text-slate-400 text-sm font-medium">Chargement de votre assistant...</span>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-white text-slate-900">
      <div className="max-w-6xl mx-auto px-6 py-8 h-screen flex flex-col">

        {/* Header */}
        <header className="flex items-center justify-between mb-8 shrink-0">
            <div className="flex items-center gap-4">
                <button
                onClick={() => selectedCourse ? setSelectedCourse(null) : router.push('/workspace')}
                className="w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:bg-slate-50 transition-colors"
                >
                <ArrowLeft size={18} />
                </button>
                <div>
                    <h1 className="text-2xl font-bold text-slate-900">Tuteur Socratique</h1>
                    <p className="text-slate-500 text-sm">Posez des questions sur vos cours</p>
                </div>
            </div>
        </header>

        {/* Main Content */}
        <div className="flex-1 overflow-hidden bg-white border border-slate-200 rounded-3xl shadow-sm relative flex flex-col">

            {!selectedCourse ? (
            // VIEW: SELECT COURSE
            <div className="flex-1 overflow-y-auto p-8 md:p-12">
                <h2 className="text-xl font-bold mb-6 text-center">Choisissez un sujet</h2>

                {courses.length === 0 ? (
                <div className="text-center py-20 border-2 border-dashed border-slate-200 rounded-2xl bg-slate-50">
                    <BookOpen size={40} className="mx-auto text-slate-300 mb-4" />
                    <p className="text-slate-500 font-medium mb-4">Aucun cours disponible.</p>
                    <button
                    onClick={() => router.push('/workspace/capture')}
                    className="text-slate-900 font-bold border-b-2 border-slate-900 hover:border-transparent transition-all"
                    >
                    Cr√©er mon premier cours
                    </button>
                </div>
                ) : (
                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {courses.map(course => (
                    <button
                        key={course.id}
                        onClick={() => setSelectedCourse(course)}
                        className="group flex flex-col items-start p-6 bg-white border border-slate-200 rounded-2xl hover:border-slate-900 hover:shadow-md transition-all text-left h-full"
                    >
                        <div className="w-10 h-10 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center mb-4 group-hover:bg-slate-900 group-hover:text-white transition-colors">
                            <BookOpen size={18} />
                        </div>
                        <h3 className="font-bold text-slate-900 mb-2 line-clamp-2">
                        {course.title}
                        </h3>
                        <p className="text-xs text-slate-400 mt-auto pt-4 border-t border-slate-100 w-full">
                        Ajout√© le {new Date(course.created_at).toLocaleDateString()}
                        </p>
                    </button>
                    ))}
                </div>
                )}
            </div>
            ) : (
            // VIEW: CHAT
            <div className="flex flex-col h-full animate-in fade-in">
                {/* Chat Header */}
                <div className="px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between shrink-0">
                    <div className="flex items-center gap-3">
                        <div className="w-8 h-8 bg-green-100 text-green-700 rounded-full flex items-center justify-center">
                            <Bot size={16} />
                        </div>
                        <div className="flex flex-col">
                            <span className="text-sm font-bold text-slate-900">{selectedCourse.title}</span>
                            <span className="text-[10px] font-bold text-green-600 uppercase tracking-wider">En ligne</span>
                        </div>
                    </div>
                    <button
                        onClick={() => router.push(`/workspace/courses/${selectedCourse.id}`)}
                        className="text-xs font-bold text-slate-500 hover:text-slate-900 px-3 py-1.5 rounded-lg hover:bg-white border border-transparent hover:border-slate-200 transition-all"
                    >
                        Voir le cours
                    </button>
                </div>

                {/* Chat Area */}
                <div className="flex-1 overflow-hidden relative">
                    <CourseChat
                        courseText={selectedCourse.extracted_text}
                        courseTitle={selectedCourse.title}
                    />
                </div>
            </div>
            )}
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/quiz/page.tsx
==================================================

'use client';

import { useRouter } from 'next/navigation';
import { ArrowLeft, FileQuestion, History, Sparkles } from 'lucide-react';

export default function QuizHubPage() {
  const router = useRouter();

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
      <div className="max-w-4xl mx-auto px-3 sm:px-6 py-4 sm:py-8 pb-20">

        {/* Back Button */}
        <button
          onClick={() => router.push('/workspace')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-4 sm:mb-6 transition-colors active:scale-95 text-sm sm:text-base"
        >
          <ArrowLeft size={18} className="mr-1.5 sm:mr-2" />
          <span>Retour</span>
        </button>

        {/* Header - Minimaliste */}
        <div className="text-center mb-6 sm:mb-10 px-2">
          <div className="inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl shadow-lg mb-3 sm:mb-4">
            <FileQuestion className="text-gray-900" size={28} />
          </div>
          <h1 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 mb-2 leading-tight">
            Quiz Generator üéØ
          </h1>
          <p className="text-sm sm:text-base md:text-lg text-gray-600 leading-relaxed">
            Cr√©ez ou consultez vos quiz
          </p>
        </div>

        {/* Options Grid - Compact */}
        <div className="grid sm:grid-cols-2 gap-4 sm:gap-6 max-w-3xl mx-auto mb-8 px-2">

          {/* Option 1: Cr√©er un Quiz */}
          <button
            onClick={() => router.push('/workspace/quiz/generate')}
            className="group relative bg-white rounded-2xl shadow-lg border-2 border-transparent hover:border-blue-500 active:scale-[0.98] transition-all p-5 sm:p-6 text-left overflow-hidden"
          >
            {/* Subtle background decoration */}
            <div className="absolute top-0 right-0 w-24 h-24 bg-blue-100 rounded-full -mr-12 -mt-12 opacity-50 group-hover:scale-150 transition-transform duration-500"></div>

            <div className="relative z-10">
              {/* Icon */}
              <div className="w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center mb-3 sm:mb-4 group-hover:scale-110 transition-transform shadow-md">
                <Sparkles className="text-gray-900" size={24} />
              </div>

              {/* Badge */}
              <span className="inline-block px-2.5 py-0.5 sm:px-3 sm:py-1 bg-blue-100 text-blue-700 text-[10px] sm:text-xs font-semibold rounded-full mb-3">
                Populaire ‚≠ê
              </span>

              {/* Title */}
              <h2 className="text-lg sm:text-xl md:text-2xl font-bold text-gray-900 mb-2 leading-tight group-hover:text-blue-600 transition-colors">
                Cr√©er un Quiz
              </h2>

              {/* Description */}
              <p className="text-gray-600 text-xs sm:text-sm leading-relaxed mb-4">
                S√©lectionnez un cours et g√©n√©rez un quiz personnalis√©
              </p>

              {/* Arrow */}
              <div className="flex items-center text-blue-600 font-semibold text-sm group-hover:translate-x-1 transition-transform">
                <span>Commencer</span>
                <svg className="w-4 h-4 ml-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                </svg>
              </div>
            </div>
          </button>

          {/* Option 2: Historique */}
          <button
            onClick={() => router.push('/workspace/quiz/history')}
            className="group relative bg-white rounded-2xl shadow-lg border-2 border-transparent hover:border-purple-500 active:scale-[0.98] transition-all p-5 sm:p-6 text-left overflow-hidden"
          >
            {/* Subtle background decoration */}
            <div className="absolute top-0 right-0 w-24 h-24 bg-purple-100 rounded-full -mr-12 -mt-12 opacity-50 group-hover:scale-150 transition-transform duration-500"></div>

            <div className="relative z-10">
              {/* Icon */}
              <div className="w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl flex items-center justify-center mb-3 sm:mb-4 group-hover:scale-110 transition-transform shadow-md">
                <History className="text-gray-900" size={24} />
              </div>

              {/* Badge */}
              <span className="inline-block px-2.5 py-0.5 sm:px-3 sm:py-1 bg-purple-100 text-purple-700 text-[10px] sm:text-xs font-semibold rounded-full mb-3">
                Statistiques üìä
              </span>

              {/* Title */}
              <h2 className="text-lg sm:text-xl md:text-2xl font-bold text-gray-900 mb-2 leading-tight group-hover:text-purple-600 transition-colors">
                Mon Historique
              </h2>

              {/* Description */}
              <p className="text-gray-600 text-xs sm:text-sm leading-relaxed mb-4">
                Consultez vos quiz pr√©c√©dents et vos scores
              </p>

              {/* Arrow */}
              <div className="flex items-center text-purple-600 font-semibold text-sm group-hover:translate-x-1 transition-transform">
                <span>Voir l'historique</span>
                <svg className="w-4 h-4 ml-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                </svg>
              </div>
            </div>
          </button>

        </div>

        {/* Info Card - Minimaliste */}
        <div className="bg-white rounded-2xl shadow-sm border border-gray-200 p-4 sm:p-6 max-w-2xl mx-auto">
          <div className="flex items-start space-x-3">
            <div className="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
              <Sparkles className="text-blue-600" size={16} />
            </div>
            <div>
              <h3 className="text-sm sm:text-base font-bold text-gray-900 mb-1.5">
                Comment √ßa marche ?
              </h3>
              <ul className="space-y-1.5 text-gray-600 text-xs sm:text-sm leading-relaxed">
                <li className="flex items-start">
                  <span className="text-blue-600 mr-2 flex-shrink-0">1.</span>
                  <span>Choisissez un cours sauvegard√©</span>
                </li>
                <li className="flex items-start">
                  <span className="text-blue-600 mr-2 flex-shrink-0">2.</span>
                  <span>Configurez le nombre de questions</span>
                </li>
                <li className="flex items-start">
                  <span className="text-blue-600 mr-2 flex-shrink-0">3.</span>
                  <span>L'IA g√©n√®re le quiz instantan√©ment</span>
                </li>
                <li className="flex items-start">
                  <span className="text-blue-600 mr-2 flex-shrink-0">4.</span>
                  <span>Sauvegardez vos r√©sultats</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/quiz/retake/[id]/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import { supabase } from '@/lib/supabase';
import { Quiz } from '@/lib/api';
import QuizDisplay from '@/components/workspace/QuizDisplay';
import QuizResults from '@/components/workspace/QuizResults';
import { Loader2, ArrowLeft } from 'lucide-react';

type Step = 'loading' | 'taking' | 'results';

export default function RetakeQuizPage() {
  const params = useParams();
  const router = useRouter();
  const { user, isLoaded } = useUser();
  const [step, setStep] = useState<Step>('loading');
  const [quiz, setQuiz] = useState<Quiz | null>(null);
  const [userAnswers, setUserAnswers] = useState<number[]>([]);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (isLoaded && user && params.id) {
      loadQuiz();
    }
  }, [isLoaded, user, params.id]);

  const loadQuiz = async () => {
    if (!user) return;

    try {
      const { data, error } = await supabase
        .from('quiz_history')
        .select('quiz_data')
        .eq('id', params.id)
        .eq('user_id', user.id) // S√©curit√© : v√©rifier que c'est bien son quiz
        .single();

      if (error) throw error;

      if (!data) {
        throw new Error('Quiz non trouv√©');
      }

      setQuiz(data.quiz_data);
      setStep('taking');
    } catch (err: any) {
      console.error('Erreur chargement quiz:', err);
      setError(err.message);
    }
  };

  const handleQuizCompleted = (answers: number[]) => {
    setUserAnswers(answers);
    setStep('results');
  };

  const handleRetake = () => {
    setUserAnswers([]);
    setStep('taking');
  };

  const handleNewQuiz = () => {
    router.push('/workspace/quiz/generate');
  };

  if (!isLoaded || step === 'loading') {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-white">
        <div className="text-center">
          <Loader2 className="animate-spin h-12 w-12 text-blue-600 mx-auto mb-4" />
          <p className="text-gray-600">Chargement du quiz...</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-white px-4">
        <div className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center">
          <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <span className="text-3xl">‚ùå</span>
          </div>
          <h2 className="text-2xl font-bold text-gray-900 mb-2">Erreur</h2>
          <p className="text-gray-600 mb-6">{error}</p>
          <button
            onClick={() => router.push('/workspace/quiz/history')}
            className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all"
          >
            Retour √† l'historique
          </button>
        </div>
      </div>
    );
  }

  if (!quiz) {
    return null;
  }

  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-50 to-white">
      <div className="max-w-4xl mx-auto px-6 py-12">
        {/* Back Button */}
        <button
          onClick={() => router.push('/workspace/quiz/history')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour √† l'historique
        </button>

        {/* Header */}
        <div className="text-center mb-12">
          <div className="inline-block px-4 py-2 bg-purple-100 text-purple-700 rounded-full text-sm font-semibold mb-4">
            üîÑ Mode R√©vision
          </div>
          <h1 className="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
            Refaites ce Quiz
          </h1>
          <p className="text-lg text-gray-600">
            Testez vos connaissances √† nouveau
          </p>
        </div>

        {/* Content */}
        {step === 'taking' && (
          <QuizDisplay
            quiz={quiz}
            onComplete={handleQuizCompleted}
          />
        )}

        {step === 'results' && (
          <QuizResults
            quiz={quiz}
            userAnswers={userAnswers}
            onRetake={handleRetake}
            onNewQuiz={handleNewQuiz}
          />
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/quiz/history/page.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { ArrowLeft, Calendar, Award, BookOpen, Loader2 } from 'lucide-react';
import { supabase } from '@/lib/supabase';
import QuizHistoryCard from '@/components/workspace/QuizHistoryCard';

interface QuizHistory {
  id: number;
  quiz_id: string;
  score: number;
  total_questions: number;
  difficulty: string;
  source: string;
  created_at: string;
  answers: number[];
}

export default function QuizHistoryPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [history, setHistory] = useState<QuizHistory[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (isLoaded && user) {
      loadHistory();
    }
  }, [isLoaded, user]);

  const loadHistory = async () => {
    if (!user) return;

    try {
      const { data, error } = await supabase
        .from('quiz_history')
        .select('*')
        .eq('user_id', user.id)
        .order('created_at', { ascending: false });

      if (error) throw error;

      setHistory(data || []);
    } catch (err) {
      console.error('Erreur:', err);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (id: number) => {
    if (!confirm('Supprimer ce quiz ?')) return;

    try {
      const { error } = await supabase
        .from('quiz_history')
        .delete()
        .eq('id', id);

      if (error) throw error;

      setHistory(history.filter(q => q.id !== id));
    } catch (err) {
      console.error('Erreur:', err);
      alert('Erreur lors de la suppression');
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <Loader2 className="animate-spin h-12 w-12 text-blue-600" />
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  const totalQuizzes = history.length;
  const averageScore = history.length > 0
    ? Math.round(history.reduce((acc, q) => acc + (q.score / q.total_questions * 100), 0) / history.length)
    : 0;

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-5xl mx-auto">
        <button
          onClick={() => router.push('/workspace')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour au Workspace
        </button>

        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            üìä Historique des Quiz
          </h1>
          <p className="text-lg text-gray-600">
            Retrouvez tous vos quiz pass√©s et vos performances
          </p>
        </div>

        {/* Stats Summary */}
        <div className="grid md:grid-cols-2 gap-6 mb-8">
          <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
            <div className="flex items-center space-x-4">
              <div className="w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center">
                <BookOpen size={28} className="text-blue-600" />
              </div>
              <div>
                <p className="text-3xl font-bold text-gray-900">{totalQuizzes}</p>
                <p className="text-sm text-gray-600">Quiz compl√©t√©s</p>
              </div>
            </div>
          </div>

          <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
            <div className="flex items-center space-x-4">
              <div className="w-14 h-14 bg-green-100 rounded-xl flex items-center justify-center">
                <Award size={24} className="text-green-600" />
              </div>
              <div>
                <p className="text-3xl font-bold text-gray-900">{averageScore}%</p>
                <p className="text-sm text-gray-600">Score moyen</p>
              </div>
            </div>
          </div>
        </div>

        {/* History List */}
        {history.length === 0 ? (
          <div className="bg-white rounded-2xl shadow-xl p-12 text-center border border-gray-100">
            <BookOpen size={64} className="mx-auto text-gray-300 mb-4" />
            <h3 className="text-xl font-bold text-gray-900 mb-2">
              Aucun quiz encore
            </h3>
            <p className="text-gray-600 mb-6">
              Commencez par g√©n√©rer un quiz depuis un cours !
            </p>
            <button
              onClick={() => router.push('/workspace')}
              className="px-6 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-all"
            >
              Aller au Workspace
            </button>
          </div>
        ) : (
          <div className="space-y-4">
            {history.map((quiz) => (
              <QuizHistoryCard
                key={quiz.id}
                quiz={quiz}
                onDelete={handleDelete}
              />
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/quiz/generate/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { getUserCourses, Course } from '@/lib/courseService';
import { ArrowLeft, Loader2, BookOpen, ChevronRight, Calendar } from 'lucide-react';

export default function SelectCourseForQuizPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [courses, setCourses] = useState<Course[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (isLoaded && user) {
      loadCourses();
    }
  }, [isLoaded, user]);

  const loadCourses = async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await getUserCourses(user.id);
      setCourses(data);
    } catch (err: any) {
      console.error('Erreur chargement cours:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <div className="text-center">
          <Loader2 className="animate-spin h-12 w-12 text-blue-600 mx-auto mb-4" />
          <p className="text-gray-600">Chargement des cours...</p>
        </div>
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <button
          onClick={() => router.push('/workspace/quiz')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour
        </button>

        <div className="text-center mb-12">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            üìù S√©lectionnez un Cours
          </h1>
          <p className="text-lg text-gray-600">
            Choisissez le cours depuis lequel g√©n√©rer un quiz
          </p>
        </div>

        {/* Error */}
        {error && (
          <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <p className="text-red-600">‚ùå {error}</p>
          </div>
        )}

        {/* Courses List */}
        {courses.length === 0 ? (
          <div className="bg-white rounded-2xl shadow-lg p-12 text-center max-w-2xl mx-auto">
            <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <BookOpen size={48} className="text-gray-400" />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-2">
              Aucun cours disponible
            </h3>
            <p className="text-gray-600 mb-6">
              Capturez d'abord un cours pour pouvoir g√©n√©rer un quiz
            </p>
            <button
              onClick={() => router.push('/workspace/capture')}
              className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all"
            >
              üì∏ Capturer un cours
            </button>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {courses.map((course) => (
              <button
                key={course.id}
                onClick={() => router.push(`/workspace/courses/${course.id}/generate-quiz`)}
                className="group bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl hover:border-blue-500 transition-all transform hover:scale-105 text-left"
              >
                {/* Preview du texte */}
                <div className="p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-b border-gray-200 h-32 overflow-hidden">
                  <p className="text-sm text-gray-700 line-clamp-4 font-mono">
                    {course.extracted_text.substring(0, 200)}...
                  </p>
                </div>

                {/* Content */}
                <div className="p-6">
                  <h3 className="text-lg font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors">
                    {course.title}
                  </h3>

                  <div className="flex items-center text-sm text-gray-500 mb-4">
                    <Calendar size={16} className="mr-1" />
                    {new Date(course.created_at).toLocaleDateString('fr-FR', {
                      day: 'numeric',
                      month: 'long',
                      year: 'numeric'
                    })}
                  </div>

                  <div className="text-xs text-gray-500 mb-4">
                    {course.extracted_text.length} caract√®res
                  </div>

                  {/* Action */}
                  <div className="flex items-center justify-between pt-4 border-t border-gray-200">
                    <span className="text-blue-600 font-semibold text-sm">
                      G√©n√©rer un quiz
                    </span>
                    <ChevronRight className="text-blue-600 group-hover:translate-x-1 transition-transform" size={20} />
                  </div>
                </div>
              </button>
            ))}
          </div>
        )}

        {/* Quick Action */}
        {courses.length > 0 && (
          <div className="mt-12 text-center">
            <p className="text-gray-600 mb-4">Vous n'avez pas le bon cours ?</p>
            <button
              onClick={() => router.push('/workspace/capture')}
              className="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-semibold hover:from-purple-700 hover:to-pink-700 transition-all shadow-lg"
            >
              üì∏ Capturer un nouveau cours
            </button>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/courses/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { getUserCourses, deleteCourse, Course } from '@/lib/courseService';
import { ArrowLeft, BookOpen, Trash2, Eye, Loader2, Calendar } from 'lucide-react';

export default function CoursesPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [courses, setCourses] = useState<Course[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    if (isLoaded && user) {
      loadCourses();
    }
  }, [isLoaded, user]);

  const loadCourses = async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await getUserCourses(user.id);
      setCourses(data);
    } catch (err: any) {
      console.error('Erreur chargement cours:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleDelete = async (courseId: number) => {
    if (!confirm('√ätes-vous s√ªr de vouloir supprimer ce cours ?')) return;
    if (!user) return;

    try {
      await deleteCourse(courseId, user.id);
      loadCourses();
    } catch (err: any) {
      alert(`Erreur: ${err.message}`);
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <div className="text-center">
          <Loader2 className="animate-spin h-12 w-12 text-blue-600 mx-auto mb-4" />
          <p className="text-gray-600">Chargement des cours...</p>
        </div>
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="mb-8">
          <button
            onClick={() => router.push('/workspace')}
            className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
          >
            <ArrowLeft size={20} className="mr-2" />
            Retour au Workspace
          </button>

          <h1 className="text-4xl font-bold text-gray-900 mb-2">
            üìö Mes Cours Sauvegard√©s
          </h1>
          <p className="text-gray-600 text-lg">
            Consultez le texte extrait de vos cours
          </p>
        </div>

        {/* Stats */}
        <div className="bg-white rounded-2xl shadow-lg p-6 mb-8 border-l-4 border-blue-600">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-gray-600 text-sm font-medium">Total de Cours</p>
              <p className="text-3xl font-bold text-gray-900 mt-1">{courses.length}</p>
            </div>
            <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
              <BookOpen size={24} className="text-blue-600" />
            </div>
          </div>
        </div>

        {/* Error */}
        {error && (
          <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <p className="text-red-600">‚ùå {error}</p>
          </div>
        )}

        {/* Courses List */}
        {courses.length === 0 ? (
          <div className="bg-white rounded-2xl shadow-lg p-12 text-center">
            <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <BookOpen size={48} className="text-gray-400" />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-2">
              Aucun cours sauvegard√©
            </h3>
            <p className="text-gray-600 mb-6">
              G√©n√©rez un quiz pour extraire et sauvegarder automatiquement le texte du cours
            </p>
            <button
              onClick={() => router.push('/workspace/quiz/generate')}
              className="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all"
            >
              G√©n√©rer un Quiz
            </button>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {courses.map((course) => (
              <div
                key={course.id}
                className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl transition-all transform hover:scale-105"
              >
                {/* Preview du texte */}
                <div className="p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-b border-gray-200 h-32 overflow-hidden">
                  <p className="text-sm text-gray-700 line-clamp-4 font-mono">
                    {course.extracted_text.substring(0, 200)}...
                  </p>
                </div>

                {/* Content */}
                <div className="p-6">
                  <h3 className="text-lg font-bold text-gray-900 mb-2 line-clamp-2">
                    {course.title}
                  </h3>

                  <div className="flex items-center text-sm text-gray-500 mb-4">
                    <Calendar size={16} className="mr-1" />
                    {new Date(course.created_at).toLocaleDateString('fr-FR', {
                      day: 'numeric',
                      month: 'long',
                      year: 'numeric'
                    })}
                  </div>

                  <div className="text-xs text-gray-500 mb-4 flex items-center justify-between">
                    <span>{course.extracted_text.length} caract√®res</span>
                    <span>{course.extracted_text.split(/\s+/).length} mots</span>
                  </div>

                  {/* Actions */}
                  <div className="flex gap-3">
                    <button
                      onClick={() => router.push(`/workspace/courses/${course.id}`)}
                      className="flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all"
                    >
                      <Eye size={18} />
                      <span>Lire</span>
                    </button>
                    <button
                      onClick={() => handleDelete(course.id)}
                      className="p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                    >
                      <Trash2 size={20} />
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/courses/[id]/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import { getCourseById, Course } from '@/lib/courseService';
import { ArrowLeft, Brain, Zap, FileText, Loader2, ChevronRight } from 'lucide-react';
import Link from 'next/link';

export default function CourseDetailPage() {
  const { id } = useParams();
  const router = useRouter();
  const { user } = useUser();
  const [course, setCourse] = useState<Course | null>(null);

  useEffect(() => {
    if (user && id) getCourseById(Number(id), user.id).then(setCourse);
  }, [user, id]);

  if (!course) return <div className="flex h-screen items-center justify-center"><Loader2 className="animate-spin" /></div>;

  const ActionCard = ({ icon: Icon, title, desc, color, href, dark = false }: any) => (
     <Link href={href} className={`relative overflow-hidden p-8 rounded-3xl transition-all duration-300 hover:-translate-y-1 hover:shadow-xl cursor-pointer group flex flex-col justify-between h-64 ${dark ? 'bg-slate-900 text-white shadow-lg shadow-slate-900/20' : 'bg-white border-2 border-slate-100 hover:border-slate-300'}`}>
         {dark && <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-8 -mt-8 blur-2xl"></div>}

         <div>
             <div className={`w-14 h-14 rounded-2xl flex items-center justify-center mb-6 ${dark ? 'bg-white/20 text-white' : `bg-${color}-50 text-${color}-600`}`}>
                 <Icon size={28} strokeWidth={2.5} />
             </div>
             <h3 className={`text-2xl font-bold mb-2 ${dark ? 'text-white' : 'text-slate-900'}`}>{title}</h3>
             <p className={`font-medium leading-relaxed ${dark ? 'text-slate-400' : 'text-slate-500'}`}>{desc}</p>
         </div>

         <div className={`flex items-center gap-2 font-bold mt-6 ${dark ? 'text-white' : `text-${color}-600`}`}>
             <span>Commencer</span> <ChevronRight size={16} className="group-hover:translate-x-1 transition-transform" />
         </div>
     </Link>
  );

  return (
    <div className="max-w-5xl mx-auto py-6">
        <button onClick={() => router.push('/workspace')} className="group flex items-center text-slate-500 hover:text-slate-900 mb-8 font-bold text-sm transition-colors">
            <div className="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center mr-3 group-hover:bg-slate-200 transition-colors">
                <ArrowLeft size={16} />
            </div>
            Retour au tableau de bord
        </button>

        <div className="mb-12">
            <div className="inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider mb-4">
                <Brain size={12}/> Cours IA
            </div>
            <h1 className="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 leading-tight">{course.title}</h1>
            <p className="text-slate-500 font-medium text-lg">Tout est pr√™t. Choisissez comment vous voulez apprendre.</p>
        </div>

        <div className="grid md:grid-cols-3 gap-6 mb-12">
            <ActionCard
                title="R√©sum√©"
                desc="Lisez le contenu structur√©."
                icon={FileText}
                color="blue"
                href="#"
            />
            <ActionCard
                title="Flashcards"
                desc="M√©morisation active."
                icon={Zap}
                color="amber"
                href={`/workspace/courses/${id}/generate-flashcards`}
            />
            <ActionCard
                title="Quiz Express"
                desc="Testez vos connaissances."
                icon={Brain}
                color="purple"
                href="#"
                dark={true}
            />
        </div>

        <div className="bg-slate-50 border border-slate-200 rounded-3xl p-10">
            <h3 className="font-bold text-slate-900 mb-6 text-xl">Contenu extrait</h3>
            <div className="prose prose-slate prose-lg max-w-none text-slate-600">
                <p className="line-clamp-5">{course.extracted_text}</p>
            </div>
        </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/courses/[id]/mastery/page.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import {
    ArrowRight, BrainCircuit, CheckCircle, XCircle, Loader2,
    BookOpen, HelpCircle, RotateCcw, Sparkles, ArrowLeft, Save, Layers
} from 'lucide-react';
import { getCourseById } from '@/lib/courseService';
import { addXp } from '@/lib/gamificationService';
import { saveFlashcardDeck } from '@/lib/flashcardService';
import ReactMarkdown from 'react-markdown'; // ‚ö†Ô∏è N√©cessite npm install react-markdown

export default function ImmersiveMasteryPage() {
  const params = useParams();
  const router = useRouter();
  const { user } = useUser();

  const [courseText, setCourseText] = useState('');
  const [courseTitle, setCourseTitle] = useState('');
  const [courseId, setCourseId] = useState<number>(0);
  const [session, setSession] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // Phases: 'learning' -> 'quiz' -> 'result_quiz' -> 'practice' -> 'feedback_practice'
  const [phase, setPhase] = useState<string>('learning');

  // State Flashcards
  const [savedFlashcards, setSavedFlashcards] = useState(false);
  const [isSavingCards, setIsSavingCards] = useState(false);

  // State Quiz
  const [quizAnswers, setQuizAnswers] = useState<number[]>([]);
  const [quizScore, setQuizScore] = useState(0);

  // State Practice
  const [practiceAnswer, setPracticeAnswer] = useState('');
  const [practiceFeedback, setPracticeFeedback] = useState<any>(null);
  const [evaluating, setEvaluating] = useState(false);

  const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';

  useEffect(() => {
    if (user && params.id) initSession();
  }, [user, params.id]);

  const initSession = async () => {
    try {
      const course = await getCourseById(Number(params.id), user!.id);
      setCourseText(course.extracted_text);
      setCourseTitle(course.title);
      setCourseId(course.id);

      const res = await fetch(`${API_URL}/api/path/generate`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ course_text: course.extracted_text }),
      });

      if(!res.ok) throw new Error("Erreur API");

      const data = await res.json();
      setQuizAnswers(new Array(data.quiz.length).fill(-1));
      setSession(data);
    } catch (err) {
      console.error(err);
      setError("Impossible de g√©n√©rer le parcours. Le cours est peut-√™tre trop court.");
    } finally {
      setLoading(false);
    }
  };

  // --- ACTION : SAUVEGARDER LES FLASHCARDS ---
  const handleSaveFlashcards = async () => {
      if(!user || !session.flashcards) return;
      setIsSavingCards(true);
      try {
          // On formate pour ton service existant
          const formattedCards = session.flashcards.map((c: any) => ({
              front: c.front,
              back: c.back,
              category: 'Parcours'
          }));

          await saveFlashcardDeck(
              user.id,
              formattedCards,
              `Flashcards - ${courseTitle}`,
              'medium',
              courseId
          );
          setSavedFlashcards(true);
          await addXp(user.id, 20, 'Flashcards sauvegard√©es');
      } catch (e) {
          console.error(e);
          alert("Erreur lors de la sauvegarde");
      } finally {
          setIsSavingCards(false);
      }
  };

  const submitQuiz = () => {
      let score = 0;
      session.quiz.forEach((q: any, idx: number) => {
          if (quizAnswers[idx] === q.correct_index) score++;
      });
      const percentage = Math.round((score / session.quiz.length) * 100);
      setQuizScore(percentage);
      setPhase('result_quiz');
      if (percentage >= 80 && user) addXp(user.id, 50, 'Quiz Valid√©');
  };

  const submitPractice = async () => {
    if(!practiceAnswer.trim()) return;
    setEvaluating(true);
    try {
        const res = await fetch(`${API_URL}/api/path/evaluate`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                instruction: session.practice_task.instruction,
                student_answer: practiceAnswer,
                course_context: courseText
            }),
        });
        const result = await res.json();
        setPracticeFeedback(result);
        setPhase('feedback_practice');
        if (result.is_correct && user) await addXp(user.id, 100, 'Parcours termin√©');
    } catch (err) {
        console.error(err);
    } finally {
        setEvaluating(false);
    }
  };

  if (loading) return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-white p-4 text-center">
        <BrainCircuit className="text-indigo-600 w-16 h-16 animate-pulse mb-4"/>
        <h2 className="text-2xl font-bold text-gray-900">Pr√©paration de votre s√©ance...</h2>
        <p className="text-gray-500">L'IA structure vos connaissances.</p>
    </div>
  );

  if (error) return <div className="p-10 text-center text-red-500">{error}</div>;

  return (
    <div className="min-h-screen bg-gray-50 flex flex-col">
      {/* Navbar simplifi√©e */}
      <div className="bg-white border-b border-gray-100 p-4 flex items-center justify-between sticky top-0 z-20 shadow-sm">
         <button onClick={() => router.back()} className="p-2 hover:bg-gray-100 rounded-full text-gray-600"><ArrowLeft/></button>
         <div className="font-bold text-gray-800 uppercase tracking-wider text-sm">
            {phase === 'learning' && "Phase 1 : Apprentissage"}
            {phase.includes('quiz') && "Phase 2 : V√©rification"}
            {phase.includes('practice') && "Phase 3 : Application"}
         </div>
         <div className="w-8"></div>
      </div>

      <div className="flex-1 p-4 md:p-8 max-w-4xl mx-auto w-full">

        {/* === PHASE 1: APPRENTISSAGE (Texte Beau + Flashcards) === */}
        {phase === 'learning' && (
            <div className="animate-in fade-in slide-in-from-bottom-4 space-y-8">

                {/* CONTENU DU COURS (Markdown) */}
                <div className="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 prose prose-indigo lg:prose-lg max-w-none">
                    {/* Le plugin typography de Tailwind rendra √ßa magnifique */}
                    <ReactMarkdown>{session.learning_content}</ReactMarkdown>
                </div>

                {/* FLASHCARDS G√âN√âR√âES */}
                <div className="bg-indigo-50 p-6 rounded-3xl border border-indigo-100">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-bold text-indigo-900 flex items-center gap-2">
                            <Layers className="text-indigo-600"/>
                            Flashcards Cl√©s ({session.flashcards.length})
                        </h3>
                        <button
                            onClick={handleSaveFlashcards}
                            disabled={savedFlashcards || isSavingCards}
                            className={`px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 transition-all ${
                                savedFlashcards 
                                ? 'bg-green-100 text-green-700 cursor-default' 
                                : 'bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg shadow-indigo-200'
                            }`}
                        >
                            {isSavingCards ? <Loader2 className="animate-spin" size={16}/> : savedFlashcards ? <CheckCircle size={16}/> : <Save size={16}/>}
                            {savedFlashcards ? "Sauvegard√©" : "Sauvegarder le deck"}
                        </button>
                    </div>

                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        {session.flashcards.map((card: any, idx: number) => (
                            <div key={idx} className="bg-white p-4 rounded-xl shadow-sm border border-indigo-100">
                                <p className="font-bold text-gray-800 mb-2 text-sm">{card.front}</p>
                                <div className="h-px bg-gray-100 w-full mb-2"></div>
                                <p className="text-gray-600 text-sm">{card.back}</p>
                            </div>
                        ))}
                    </div>
                </div>

                <button
                    onClick={() => setPhase('quiz')}
                    className="w-full bg-gray-900 text-white font-bold py-4 rounded-2xl hover:bg-gray-800 transition-all flex items-center justify-center gap-2 shadow-xl"
                >
                    J'ai tout retenu, je passe au Quiz <ArrowRight />
                </button>
            </div>
        )}

        {/* === PHASE 2: QUIZ === */}
        {phase === 'quiz' && (
            <div className="animate-in zoom-in-95 space-y-6">
                <div className="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 text-center">
                    <h2 className="text-xl font-bold text-gray-900">Test de Connaissances</h2>
                    <p className="text-gray-500">Il faut 80% de r√©ussite pour passer √† la suite.</p>
                </div>

                {session.quiz.map((q: any, qIdx: number) => (
                    <div key={qIdx} className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                        <p className="font-bold text-lg mb-4 text-gray-800">{qIdx + 1}. {q.question}</p>
                        <div className="space-y-2">
                            {q.options.map((opt: string, oIdx: number) => (
                                <button
                                    key={oIdx}
                                    onClick={() => {
                                        const newAns = [...quizAnswers];
                                        newAns[qIdx] = oIdx;
                                        setQuizAnswers(newAns);
                                    }}
                                    className={`w-full text-left p-4 rounded-xl border-2 transition-all font-medium ${
                                        quizAnswers[qIdx] === oIdx 
                                        ? 'border-indigo-500 bg-indigo-50 text-indigo-900' 
                                        : 'border-gray-100 hover:border-gray-300 text-gray-600'
                                    }`}
                                >
                                    {opt}
                                </button>
                            ))}
                        </div>
                    </div>
                ))}

                <button
                    onClick={submitQuiz}
                    disabled={quizAnswers.includes(-1)}
                    className="w-full bg-indigo-600 text-white font-bold py-4 rounded-2xl disabled:opacity-50 disabled:cursor-not-allowed hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-200"
                >
                    Valider mes r√©ponses
                </button>
            </div>
        )}

        {/* === PHASE 2 BIS: R√âSULTAT QUIZ === */}
        {phase === 'result_quiz' && (
            <div className="text-center animate-in zoom-in-95 flex flex-col items-center justify-center h-[70vh]">
                <div className={`w-40 h-40 rounded-full flex items-center justify-center mb-8 shadow-2xl ${
                    quizScore >= 80 ? 'bg-green-500 text-white' : 'bg-orange-500 text-white'
                }`}>
                    <span className="text-5xl font-black">{quizScore}%</span>
                </div>

                <h2 className="text-3xl font-black text-gray-900 mb-4">
                    {quizScore >= 80 ? "C'est valid√© !" : "Encore un effort..."}
                </h2>
                <p className="text-gray-500 mb-10 text-lg max-w-md">
                    {quizScore >= 80
                        ? "Vous ma√Ætrisez les bases. Passons √† l'application pratique."
                        : "Vous devez relire le cours pour bien ancrer les connaissances avant de pratiquer."}
                </p>

                {quizScore >= 80 ? (
                    <button onClick={() => setPhase('practice')} className="bg-gray-900 text-white px-10 py-4 rounded-2xl font-bold text-lg hover:scale-105 transition-transform flex items-center gap-2 shadow-xl">
                        Exercice Pratique <ArrowRight />
                    </button>
                ) : (
                    <button onClick={() => setPhase('learning')} className="bg-white text-gray-900 border-2 border-gray-200 px-10 py-4 rounded-2xl font-bold text-lg hover:bg-gray-50 transition-transform flex items-center gap-2">
                        <RotateCcw /> Relire le cours
                    </button>
                )}
            </div>
        )}

        {/* === PHASE 3: PRATIQUE === */}
        {phase === 'practice' && (
            <div className="animate-in fade-in slide-in-from-bottom-4">
                <div className="bg-white p-8 rounded-3xl shadow-xl border border-gray-100 relative overflow-hidden">
                    <div className="absolute top-0 right-0 bg-indigo-600 text-white text-xs font-bold px-4 py-1.5 rounded-bl-xl uppercase tracking-widest">
                        Mise en situation
                    </div>
                    <h2 className="text-2xl font-bold mb-4 flex items-center gap-3 text-gray-900">
                        <BrainCircuit className="text-indigo-600"/> Cas Pratique
                    </h2>
                    <p className="text-lg text-gray-700 mb-8 leading-relaxed">{session.practice_task.instruction}</p>

                    <textarea
                        className="w-full p-5 bg-gray-50 rounded-2xl border-2 border-transparent focus:bg-white focus:border-indigo-500 outline-none transition-all resize-none h-64 text-lg text-gray-800 placeholder:text-gray-400"
                        placeholder="√âcrivez votre r√©ponse d√©taill√©e ici..."
                        value={practiceAnswer}
                        onChange={(e) => setPracticeAnswer(e.target.value)}
                    />

                    <button
                        onClick={submitPractice}
                        disabled={!practiceAnswer.trim() || evaluating}
                        className="w-full mt-6 bg-gray-900 text-white font-bold py-4 rounded-2xl hover:bg-gray-800 transition-all flex items-center justify-center gap-2 disabled:opacity-50 shadow-xl"
                    >
                        {evaluating ? <Loader2 className="animate-spin"/> : <Sparkles size={20}/>}
                        {evaluating ? "Le professeur corrige..." : "Soumettre ma r√©ponse"}
                    </button>
                </div>
            </div>
        )}

        {/* === FEEDBACK FINAL === */}
        {phase === 'feedback_practice' && practiceFeedback && (
            <div className="animate-in zoom-in-95">
                <div className={`p-8 rounded-3xl mb-8 shadow-xl border-2 ${practiceFeedback.is_correct ? 'bg-green-50 border-green-200' : 'bg-orange-50 border-orange-200'}`}>
                    <h2 className={`text-2xl font-bold mb-4 flex items-center gap-2 ${practiceFeedback.is_correct ? 'text-green-800' : 'text-orange-800'}`}>
                        {practiceFeedback.is_correct ? <CheckCircle size={28}/> : <HelpCircle size={28}/>}
                        {practiceFeedback.is_correct ? "Excellent travail !" : "Des points √† revoir"}
                    </h2>
                    <div className="bg-white/60 p-6 rounded-2xl mb-6 text-gray-800 leading-relaxed text-lg">
                        {practiceFeedback.feedback}
                    </div>
                    <div className="font-bold text-sm text-right text-gray-500 uppercase tracking-wide">
                        Note attribu√©e : {practiceFeedback.score}/100
                    </div>
                </div>

                <button
                    onClick={() => router.push('/workspace')}
                    className="w-full bg-indigo-600 text-white font-bold py-4 rounded-2xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-200"
                >
                    Terminer la session
                </button>
            </div>
        )}

      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/courses/[id]/generate-quiz/page.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import { getCourseById, Course } from '@/lib/courseService';
import { generateQuizFromText, Quiz } from '@/lib/api';
import { ArrowLeft, Loader2 } from 'lucide-react';
import QuizDisplay from '@/components/workspace/QuizDisplay';
import QuizResults from '@/components/workspace/QuizResults';

type Step = 'config' | 'generating' | 'taking' | 'results';

export default function GenerateQuizPage() {
  const params = useParams();
  const router = useRouter();
  const { user, isLoaded } = useUser();
  const [course, setCourse] = useState<Course | null>(null);
  const [loading, setLoading] = useState(true);
  const [step, setStep] = useState<Step>('config');
  const [quiz, setQuiz] = useState<Quiz | null>(null);
  const [userAnswers, setUserAnswers] = useState<number[]>([]);
  const [error, setError] = useState<string | null>(null);

  const [numQuestions, setNumQuestions] = useState(5);
  const [difficulty, setDifficulty] = useState<'easy' | 'medium' | 'hard'>('medium');

  useEffect(() => {
    if (isLoaded && user && params.id) {
      loadCourse();
    }
  }, [isLoaded, user, params.id]);

  const loadCourse = async () => {
    if (!user) return;

    try {
      const data = await getCourseById(Number(params.id), user.id);
      if (!data) {
        router.push('/workspace/courses');
        return;
      }
      setCourse(data);
    } catch (err) {
      console.error('Erreur:', err);
      router.push('/workspace/courses');
    } finally {
      setLoading(false);
    }
  };

  const handleGenerate = async () => {
    if (!course) return;

    try {
      setStep('generating');
      setError(null);

      console.log('üéØ G√©n√©ration quiz depuis texte du cours...');

      const generatedQuiz = await generateQuizFromText(
        course.extracted_text,
        numQuestions,
        difficulty
      );

      console.log('‚úÖ Quiz g√©n√©r√©:', generatedQuiz);
      setQuiz(generatedQuiz);
      setStep('taking');

    } catch (err: any) {
      console.error('‚ùå Erreur:', err);
      setError(err.message);
      setStep('config');
    }
  };

  const handleQuizCompleted = (answers: number[]) => {
    setUserAnswers(answers);
    setStep('results');
  };

  const handleRetake = () => {
    setUserAnswers([]);
    setStep('taking');
  };

  const handleNewQuiz = () => {
    setQuiz(null);
    setUserAnswers([]);
    setStep('config');
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <Loader2 className="animate-spin h-12 w-12 text-blue-600" />
      </div>
    );
  }

  if (!course) return null;

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-4xl mx-auto">
        {/* Back Button */}
        {step !== 'taking' && step !== 'results' && (
          <button
            onClick={() => router.push(`/workspace/courses/${params.id}`)}
            className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
          >
            <ArrowLeft size={20} className="mr-2" />
            Retour au cours
          </button>
        )}

        {/* Header */}
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-2">
            üìù G√©n√©rer un Quiz
          </h1>
          <p className="text-lg text-gray-600">
            Depuis : {course.title}
          </p>
        </div>

        {/* Content selon l'√©tape */}
        {step === 'config' && (
          <div className="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
            <h3 className="text-xl font-bold text-gray-900 mb-6">‚öôÔ∏è Configuration</h3>

            {/* Number of Questions */}
            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-3">
                Nombre de questions : <span className="text-blue-600 font-bold">{numQuestions}</span>
              </label>
              <input
                type="range"
                min="3"
                max="15"
                value={numQuestions}
                onChange={(e) => setNumQuestions(Number(e.target.value))}
                className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
              />
              <div className="flex justify-between text-xs text-gray-500 mt-1">
                <span>3</span>
                <span>15</span>
              </div>
            </div>

            {/* Difficulty */}
            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-3">
                Difficult√©
              </label>
              <div className="flex gap-3">
                {(['easy', 'medium', 'hard'] as const).map((level) => (
                  <button
                    key={level}
                    onClick={() => setDifficulty(level)}
                    className={`flex-1 px-4 py-3 rounded-lg font-medium transition-all transform hover:scale-105 ${
                      difficulty === level
                        ? 'bg-blue-600 text-white shadow-lg'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    {level === 'easy' && 'üòä Facile'}
                    {level === 'medium' && 'üéØ Moyen'}
                    {level === 'hard' && 'üî• Difficile'}
                  </button>
                ))}
              </div>
            </div>

            {/* Generate Button */}
            <button
              onClick={handleGenerate}
              className="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105"
            >
              ‚ú® G√©n√©rer le Quiz
            </button>

            {/* Error */}
            {error && (
              <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
                <p className="text-sm text-red-600">‚ùå {error}</p>
              </div>
            )}

            {/* Info */}
            <div className="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
              <p className="text-sm text-blue-800">
                <strong>üìö Texte du cours :</strong> {course.extracted_text.length} caract√®res
              </p>
              <p className="text-xs text-blue-700 mt-2">
                Le quiz sera g√©n√©r√© √† partir du texte extrait de votre cours.
              </p>
            </div>
          </div>
        )}

        {step === 'generating' && (
          <div className="bg-white rounded-2xl shadow-xl p-12 text-center">
            <Loader2 className="animate-spin h-16 w-16 text-blue-600 mx-auto mb-6" />
            <h3 className="text-2xl font-bold text-gray-900 mb-2">
              G√©n√©ration en cours...
            </h3>
            <p className="text-gray-600">
              Cr√©ation de {numQuestions} questions depuis votre cours
            </p>
            <div className="mt-6 flex justify-center space-x-2">
              <div className="w-3 h-3 bg-blue-600 rounded-full animate-bounce"></div>
              <div className="w-3 h-3 bg-blue-600 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }}></div>
              <div className="w-3 h-3 bg-blue-600 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
            </div>
          </div>
        )}

        {step === 'taking' && quiz && (
          <QuizDisplay quiz={quiz} onComplete={handleQuizCompleted} />
        )}

        {step === 'results' && quiz && (
          <QuizResults
            quiz={quiz}
            userAnswers={userAnswers}
            onRetake={handleRetake}
            onNewQuiz={handleNewQuiz}
          />
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/courses/[id]/generate-flashcards/page.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import { useUser } from '@clerk/nextjs';
import { getCourseById, Course } from '@/lib/courseService';
import { generateFlashcards } from '@/lib/api';
import { saveFlashcardDeck } from '@/lib/flashcardService';
import { ArrowLeft, Loader2, Check, Brain, Flame, Zap } from 'lucide-react';
import FlashcardViewer from '@/components/workspace/FlashcardViewer';
import { Flashcard } from '@/lib/flashcardService';

type Step = 'config' | 'generating' | 'reviewing' | 'saved';

export default function GenerateFlashcardsPage() {
  const params = useParams();
  const router = useRouter();
  const { user, isLoaded } = useUser();
  const [course, setCourse] = useState<Course | null>(null);
  const [loading, setLoading] = useState(true);
  const [step, setStep] = useState<Step>('config');
  const [flashcards, setFlashcards] = useState<Flashcard[]>([]);
  const [error, setError] = useState<string | null>(null);
  const [deckId, setDeckId] = useState<number | null>(null);
  const [numCards, setNumCards] = useState(10);
  const [difficulty, setDifficulty] = useState<'easy' | 'medium' | 'hard'>('medium');

  useEffect(() => {
    if (isLoaded && user && params.id) loadCourse();
  }, [isLoaded, user, params.id]);

  const loadCourse = async () => {
    if (!user) return;
    try {
      const data = await getCourseById(Number(params.id), user.id);
      if (!data) router.push('/workspace/courses');
      else setCourse(data);
    } catch (err) {
      router.push('/workspace/courses');
    } finally {
      setLoading(false);
    }
  };

  const handleGenerate = async () => {
    if (!course || !user) return;
    try {
      setStep('generating');
      setError(null);
      const result = await generateFlashcards(course.extracted_text, numCards, difficulty);
      setFlashcards(result.flashcards);
      const deck = await saveFlashcardDeck(user.id, result.flashcards, `Flashcards - ${course.title}`, difficulty, course.id);
      setDeckId(deck.id);
      setStep('reviewing');
    } catch (err: any) {
      setError(err.message);
      setStep('config');
    }
  };

  const handleSaveAndExit = () => {
    setStep('saved');
    setTimeout(() => {
      router.push(`/workspace/courses/${params.id}`);
    }, 2000);
  };

  if (!isLoaded || loading) {
    return <div className="min-h-screen flex items-center justify-center bg-white"><Loader2 className="animate-spin h-8 w-8 text-slate-900" /></div>;
  }
  if (!course) return null;

  return (
    <div className="min-h-screen bg-white text-slate-900 py-12 px-6">
      <div className="max-w-3xl mx-auto">

        {/* Back Button */}
        {step !== 'saved' && (
          <button
            onClick={() => router.push(`/workspace/courses/${params.id}`)}
            className="flex items-center text-slate-500 hover:text-slate-900 mb-8 transition-colors font-medium text-sm"
          >
            <ArrowLeft size={16} className="mr-2" />
            Retour au cours
          </button>
        )}

        {/* Header */}
        <div className="mb-10">
            <span className="text-xs font-bold tracking-wider text-blue-600 uppercase mb-2 block">G√©n√©rateur IA</span>
            <h1 className="text-3xl font-bold text-slate-900">Flashcards sur mesure</h1>
        </div>

        {step === 'config' && (
          <div className="space-y-8 animate-in fade-in slide-in-from-bottom-4">

            {/* CARD: QUANTITY */}
            <div className="bg-white border border-slate-200 p-8 rounded-3xl shadow-sm">
              <div className="flex justify-between items-center mb-6">
                <label className="text-lg font-bold text-slate-900 flex items-center gap-2">
                    <Zap size={20} className="text-yellow-500" />
                    Quantit√©
                </label>
                <span className="text-2xl font-bold text-slate-900">{numCards} <span className="text-sm text-slate-400 font-medium">cartes</span></span>
              </div>
              <input
                type="range"
                min="5"
                max="20"
                value={numCards}
                onChange={(e) => setNumCards(Number(e.target.value))}
                className="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-slate-900 hover:accent-blue-600 transition-colors"
              />
              <div className="flex justify-between text-xs font-bold text-slate-400 mt-3 uppercase tracking-wider">
                <span>Rapide (5)</span>
                <span>Complet (20)</span>
              </div>
            </div>

            {/* CARD: DIFFICULTY */}
            <div className="bg-white border border-slate-200 p-8 rounded-3xl shadow-sm">
              <label className="text-lg font-bold text-slate-900 flex items-center gap-2 mb-6">
                <Brain size={20} className="text-blue-500" />
                Niveau de complexit√©
              </label>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                {[
                    { id: 'easy', label: 'Basique', icon: 'üå±', desc: 'Concepts simples' },
                    { id: 'medium', label: 'Standard', icon: 'üéØ', desc: '√âquilibre parfait' },
                    { id: 'hard', label: 'Expert', icon: 'üî•', desc: 'D√©tails pointus' }
                ].map((item) => (
                  <button
                    key={item.id}
                    onClick={() => setDifficulty(item.id as any)}
                    className={`p-4 rounded-2xl border-2 text-left transition-all duration-200 ${
                      difficulty === item.id
                        ? 'border-slate-900 bg-slate-50 shadow-none'
                        : 'border-slate-100 hover:border-slate-300 bg-white'
                    }`}
                  >
                    <div className="text-2xl mb-2">{item.icon}</div>
                    <div className={`font-bold ${difficulty === item.id ? 'text-slate-900' : 'text-slate-600'}`}>{item.label}</div>
                    <div className="text-xs text-slate-400 mt-1">{item.desc}</div>
                  </button>
                ))}
              </div>
            </div>

            <button
              onClick={handleGenerate}
              className="w-full bg-slate-900 text-white text-lg font-bold py-4 px-6 rounded-2xl hover:bg-slate-800 active:scale-95 transition-all shadow-xl shadow-slate-200"
            >
              Lancer la g√©n√©ration
            </button>

            {error && <div className="p-4 bg-red-50 text-red-600 rounded-xl text-sm font-medium text-center">{error}</div>}
          </div>
        )}

        {step === 'generating' && (
          <div className="bg-white border border-slate-200 rounded-3xl p-16 text-center shadow-sm">
            <div className="relative w-20 h-20 mx-auto mb-8">
                <div className="absolute inset-0 border-4 border-slate-100 rounded-full"></div>
                <div className="absolute inset-0 border-4 border-slate-900 rounded-full border-t-transparent animate-spin"></div>
                <Brain className="absolute inset-0 m-auto text-slate-900" size={24}/>
            </div>
            <h3 className="text-2xl font-bold text-slate-900 mb-2">Construction du deck...</h3>
            <p className="text-slate-500">L'IA analyse {course.extracted_text.length} caract√®res de votre cours.</p>
          </div>
        )}

        {step === 'reviewing' && flashcards.length > 0 && (
          <div className="space-y-8 animate-in fade-in">
            <div className="bg-slate-900 text-white rounded-3xl p-8 flex items-center justify-between">
                <div>
                    <h3 className="text-xl font-bold mb-1">Deck Pr√™t !</h3>
                    <p className="text-slate-400 text-sm">{flashcards.length} cartes g√©n√©r√©es.</p>
                </div>
                <button onClick={handleSaveAndExit} className="bg-white text-slate-900 px-6 py-2 rounded-full font-bold hover:bg-slate-100 transition-colors">
                    Terminer
                </button>
            </div>

            <div className="bg-white rounded-3xl shadow-lg border border-slate-100 overflow-hidden">
              <FlashcardViewer flashcards={flashcards} />
            </div>
          </div>
        )}

        {step === 'saved' && (
          <div className="flex flex-col items-center justify-center py-20 animate-in zoom-in duration-500">
            <div className="w-24 h-24 bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-6">
              <Check size={48} strokeWidth={3} />
            </div>
            <h3 className="text-3xl font-bold text-slate-900 mb-2">C'est dans la poche !</h3>
            <p className="text-slate-500">Redirection vers votre espace...</p>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/workspace/stats/page.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import {
  Award,
  BookOpen,
  Layers,
  BarChart3,
  TrendingUp,
  Calendar,
  Flame,
  Target,
  ArrowLeft,
  Loader2,
} from 'lucide-react';
import { supabase } from '@/lib/supabase';
import {
  LineChart,
  Line,
  BarChart,
  Bar,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
  ResponsiveContainer,
} from 'recharts';

interface Stats {
  totalQuizzes: number;
  totalFlashcards: number;
  totalCourses: number;
  averageScore: number;
  studyStreak: number;
  totalStudyTime: number;
  bestScore: number;
  recentActivity: any[];
}

export default function StatsPage() {
  const { user, isLoaded } = useUser();
  const router = useRouter();
  const [stats, setStats] = useState<Stats>({
    totalQuizzes: 0,
    totalFlashcards: 0,
    totalCourses: 0,
    averageScore: 0,
    studyStreak: 0,
    totalStudyTime: 0,
    bestScore: 0,
    recentActivity: [],
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (isLoaded && user) {
      loadStats();
    }
  }, [isLoaded, user]);

  const loadStats = async () => {
    if (!user) return;

    try {
      const { data: quizzes } = await supabase
        .from('quiz_history')
        .select('*')
        .eq('user_id', user.id);

      const { data: decks } = await supabase
        .from('flashcard_decks')
        .select('*')
        .eq('user_id', user.id);

      const { data: courses } = await supabase
        .from('courses')
        .select('*')
        .eq('user_id', user.id);

      const totalQuizzes = quizzes?.length || 0;
      const totalFlashcards = decks?.reduce((acc, d) => acc + d.flashcards.length, 0) || 0;
      const totalCourses = courses?.length || 0;

      const scores = quizzes?.map(q => (q.score / q.total_questions) * 100) || [];
      const averageScore = scores.length > 0
        ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)
        : 0;

      const bestScore = scores.length > 0 ? Math.round(Math.max(...scores)) : 0;

      const recentActivity = [
        ...(quizzes?.map(q => ({
          type: 'quiz',
          date: q.created_at,
          score: (q.score / q.total_questions) * 100,
        })) || []),
      ]
        .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
        .slice(0, 10);

      setStats({
        totalQuizzes,
        totalFlashcards,
        totalCourses,
        averageScore,
        studyStreak: 0,
        totalStudyTime: 0,
        bestScore,
        recentActivity,
      });
    } catch (error) {
      console.error('Erreur:', error);
    } finally {
      setLoading(false);
    }
  };

  if (!isLoaded || loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
        <Loader2 className="animate-spin h-12 w-12 text-blue-600" />
      </div>
    );
  }

  if (!user) {
    router.push('/');
    return null;
  }

  const statsCards = [
    {
      label: 'Quiz Compl√©t√©s',
      value: stats.totalQuizzes,
      icon: BookOpen,
      color: 'text-blue-600',
      bg: 'bg-blue-100',
      change: '+12%',
    },
    {
      label: 'Score Moyen',
      value: `${stats.averageScore}%`,
      icon: Target,
      color: 'text-green-600',
      bg: 'bg-green-100',
      change: '+5%',
    },
    {
      label: 'Meilleur Score',
      value: `${stats.bestScore}%`,
      icon: Award,
      color: 'text-yellow-600',
      bg: 'bg-yellow-100',
      change: 'Record',
    },
    {
      label: 'Cours',
      value: stats.totalCourses,
      icon: Layers,
      color: 'text-purple-600',
      bg: 'bg-purple-100',
      change: '+3',
    },
  ];

  const chartData = stats.recentActivity.map((activity, index) => ({
    name: `Quiz ${stats.recentActivity.length - index}`,
    score: Math.round(activity.score),
  }));

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12 px-4">
      <div className="max-w-7xl mx-auto">
        <button
          onClick={() => router.push('/workspace')}
          className="flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors"
        >
          <ArrowLeft size={20} className="mr-2" />
          Retour au Workspace
        </button>

        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            üìä Mes Statistiques
          </h1>
          <p className="text-lg text-gray-600">
            Suivez vos performances et votre progression
          </p>
        </div>

        {/* Stats Grid */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          {statsCards.map((stat, index) => (
            <div
              key={index}
              className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100 transform hover:scale-105 transition-all"
            >
              <div className="flex items-center justify-between mb-4">
                <div className={`w-12 h-12 ${stat.bg} rounded-xl flex items-center justify-center`}>
                  <stat.icon className={stat.color} size={24} />
                </div>
                <span className="text-xs font-semibold text-green-600">{stat.change}</span>
              </div>
              <p className="text-3xl font-bold text-gray-900 mb-1">{stat.value}</p>
              <p className="text-sm text-gray-600">{stat.label}</p>
            </div>
          ))}
        </div>

        {/* Chart */}
        {chartData.length > 0 && (
          <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100 mb-8">
            <h2 className="text-2xl font-bold text-gray-900 mb-6 flex items-center">
              <Award className="text-gray-900 mr-3" size={28} />
              Progression des Scores
            </h2>
            <ResponsiveContainer width="100%" height={300}>
              <LineChart data={chartData}>
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis dataKey="name" />
                <YAxis domain={[0, 100]} />
                <Tooltip />
                <Legend />
                <Line
                  type="monotone"
                  dataKey="score"
                  stroke="#3b82f6"
                  strokeWidth={3}
                  name="Score (%)"
                />
              </LineChart>
            </ResponsiveContainer>
          </div>
        )}

        {/* Recent Activity */}
        <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
          <h2 className="text-2xl font-bold text-gray-900 mb-6 flex items-center">
            <Calendar className="text-gray-900 mr-3" size={28} />
            Activit√© R√©cente
          </h2>

          {stats.recentActivity.length === 0 ? (
            <p className="text-center text-gray-600 py-8">Aucune activit√© r√©cente</p>
          ) : (
            <div className="space-y-4">
              {stats.recentActivity.map((activity, index) => (
                <div
                  key={index}
                  className="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-all"
                >
                  <div className="flex items-center space-x-4">
                    <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                      <BookOpen size={20} className="text-blue-600" />
                    </div>
                    <div>
                      <p className="font-semibold text-gray-900">Quiz {index + 1}</p>
                      <p className="text-sm text-gray-600">
                        {new Date(activity.date).toLocaleDateString('fr-FR')}
                      </p>
                    </div>
                  </div>
                  <div className="text-right">
                    <p className="text-2xl font-bold text-gray-900">
                      {Math.round(activity.score)}%
                    </p>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/app/api/waitlist/route.ts
==================================================

import { NextResponse } from 'next/server';

export async function POST(request: Request) {
  try {
    const { email, language } = await request.json();

    // Validate email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      return NextResponse.json(
        { error: 'Invalid email address' },
        { status: 400 }
      );
    }

    // Send to Web3Forms
    const formData = {
      access_key: '0a691a94-8de8-445c-82b1-a5accf0d48f7', // ‚ö†Ô∏è REMPLACE PAR TA VRAIE CL√â
      subject: `üéâ New Studia Waitlist Signup!`,
      from_name: 'Studia Waitlist',
      email: email,
      message: `New signup!\n\nEmail: ${email}\nLanguage: ${language}\nTime: ${new Date().toLocaleString()}\n\nTotal signups so far: Check your inbox!`,
    };

    const response = await fetch('https://api.web3forms.com/submit', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(formData),
    });

    if (!response.ok) {
      throw new Error('Failed to send email');
    }

    console.log(`‚úÖ Signup: ${email} (${language})`);

    return NextResponse.json(
      { message: 'Successfully added to waitlist!' },
      { status: 201 }
    );
  } catch (error) {
    console.error('‚ùå Error:', error);
    return NextResponse.json(
      { error: 'Failed to add to waitlist' },
      { status: 500 }
    );
  }
}


==================================================
FICHIER : frontend/app/sign-in/[[...sign-in]]/page.tsx
==================================================

import { SignIn } from '@clerk/nextjs';
import { Brain } from 'lucide-react';
import Link from 'next/link';

export default function SignInPage() {
  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-slate-50 relative overflow-hidden">
      {/* Background Pattern */}
      <div className="absolute inset-0 z-0 opacity-[0.03]"
           style={{ backgroundImage: 'radial-gradient(#1e293b 1px, transparent 1px)', backgroundSize: '24px 24px' }}>
      </div>

      <div className="z-10 w-full max-w-md px-4">
        <div className="text-center mb-8 animate-in fade-in slide-in-from-bottom-4">
          <Link href="/" className="inline-flex items-center justify-center w-12 h-12 bg-slate-900 text-white rounded-xl mb-4 shadow-lg shadow-slate-200 hover:scale-105 transition-transform">
            <Brain size={24} />
          </Link>
          <h1 className="text-2xl font-bold text-slate-900 tracking-tight">Bon retour parmi nous.</h1>
          <p className="text-slate-500 mt-2">Pr√™t √† apprendre quelque chose de nouveau ?</p>
        </div>

        <div className="bg-white p-2 rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100">
            {/* Clerk component wrapped perfectly */}
            <SignIn
                appearance={{
                    elements: {
                        rootBox: "w-full",
                        card: "shadow-none border-0 w-full p-6",
                        headerTitle: "hidden",
                        headerSubtitle: "hidden",
                        formButtonPrimary: "bg-slate-900 hover:bg-slate-800 text-white rounded-xl py-3 text-sm font-bold shadow-md transition-all active:scale-95",
                        formFieldInput: "rounded-xl border-slate-200 focus:border-slate-900 focus:ring-slate-900/20 bg-slate-50",
                        footerActionLink: "text-blue-600 hover:text-blue-700 font-bold",
                        identityPreviewText: "text-slate-600 font-bold",
                        formFieldLabel: "text-slate-600 font-bold text-xs uppercase tracking-wide"
                    }
                }}
            />
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/Hero.tsx
==================================================

'use client';

import Link from 'next/link';
import { Sparkles, Rocket, ArrowRight } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function Hero() {
  const { t } = useLanguage();

  return (
    <section
      id="home"
      className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-blue-100 pt-20"
    >
      <div className="max-w-7xl mx-auto px-6 md:px-12 lg:px-24 py-20 text-center">
        {/* Badge */}
        <div className="inline-flex items-center space-x-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full mb-8">
          <Sparkles size={16} />
          <span className="text-sm font-medium">{t.hero.badge}</span>
        </div>

        {/* Main Heading */}
        <h1 className="text-4xl md:text-6xl lg:text-7xl font-bold text-gray-900 mb-6">
          {t.hero.title}{' '}
          <span className="bg-gradient-to-r from-blue-600 to-blue-700 bg-clip-text text-transparent">
            {t.hero.titleHighlight}
          </span>
        </h1>

        {/* Subheading */}
        <p className="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-10">
          {t.hero.subtitle}
        </p>

        {/* CTA Buttons */}
        <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Link
            href="/workspace"
            className="group bg-blue-600 text-white px-8 py-4 rounded-lg hover:bg-blue-700 transition-all duration-200 font-medium shadow-xl hover:shadow-2xl flex items-center space-x-2"
          >
            <Rocket size={20} />
            <span>{t.hero.cta1}</span>
            <ArrowRight
              size={20}
              className="group-hover:translate-x-1 transition-transform"
            />
          </Link>

          <Link
            href="#about"
            className="bg-white text-blue-600 px-8 py-4 rounded-lg hover:bg-gray-50 transition-all duration-200 font-medium border-2 border-blue-600"
          >
            {t.hero.cta2}
          </Link>
        </div>

        {/* Stats */}
        <div className="mt-20 grid grid-cols-2 md:grid-cols-3 gap-8 max-w-3xl mx-auto">
          <div>
            <div className="text-3xl md:text-4xl font-bold text-blue-600">
              {t.hero.stat1Title}
            </div>
            <div className="text-gray-600 mt-1">{t.hero.stat1Desc}</div>
          </div>
          <div>
            <div className="text-3xl md:text-4xl font-bold text-blue-600">
              {t.hero.stat2Title}
            </div>
            <div className="text-gray-600 mt-1">{t.hero.stat2Desc}</div>
          </div>
          <div className="col-span-2 md:col-span-1">
            <div className="text-3xl md:text-4xl font-bold text-blue-600">
              {t.hero.stat3Title}
            </div>
            <div className="text-gray-600 mt-1">{t.hero.stat3Desc}</div>
          </div>
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/Navbar.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import Link from 'next/link';
import { Menu, X, LogIn } from 'lucide-react'; // J'ai retir√© Sun et Moon des imports
import LanguageToggle from './LanguageToggle';
import { useLanguage } from '@/contexts/LanguageContext';
import { UserButton, useUser } from '@clerk/nextjs';

export default function Navbar() {
  const [isScrolled, setIsScrolled] = useState(false);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const { t } = useLanguage();
  const { isSignedIn, isLoaded } = useUser();

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 20);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const navLinks = [
    { name: t.nav.home, href: '#home' },
    { name: t.nav.about, href: '#about' },
    { name: t.nav.features, href: '#features' },
    { name: t.nav.why, href: '#why' },
    { name: t.nav.creator, href: '#creator' },
  ];

  return (
    <nav
      className={`fixed top-0 w-full z-50 transition-all duration-300 ${
        isScrolled
          ? 'bg-white/80 backdrop-blur-md shadow-md'
          : 'bg-transparent'
      }`}
    >
      <div className="max-w-7xl mx-auto px-6 md:px-12 lg:px-24">
        <div className="flex items-center justify-between h-16 md:h-20">
          {/* Logo */}
          <Link href="/" className="flex items-center space-x-2">
            <div className="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-br from-blue-600 to-blue-400 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold text-lg md:text-xl">S</span>
            </div>
            <span className="text-xl md:text-2xl font-bold text-gray-900">
              Studia
            </span>
          </Link>

          {/* Desktop Navigation */}
          <div className="hidden md:flex items-center space-x-6">
            {navLinks.map((link) => (
              <Link
                key={link.name}
                href={link.href}
                className="text-gray-700 hover:text-blue-600 transition-colors duration-200 font-medium"
              >
                {link.name}
              </Link>
            ))}

            {/* S√©lecteur de langue uniquement (Plus de toggle Dark Mode ici) */}
            <LanguageToggle />

            {isLoaded && (
              <>
                {isSignedIn ? (
                  <>
                    <Link
                      href="/workspace"
                      className="text-blue-600 hover:text-blue-700 font-medium transition-colors"
                    >
                      Workspace
                    </Link>
                    <UserButton afterSignOutUrl="/" />
                  </>
                ) : (
                  <>
                    <Link
                      href="/sign-in"
                      className="flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors font-medium"
                    >
                      <LogIn size={18} />
                      <span>Connexion</span>
                    </Link>
                    <Link
                      href="/sign-up"
                      className="bg-blue-600 text-white px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-all font-medium shadow-lg hover:shadow-xl"
                    >
                      Commencer
                    </Link>
                  </>
                )}
              </>
            )}
          </div>

          {/* Mobile Menu Button */}
          <button
            className="md:hidden text-gray-700"
            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
          >
            {isMobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
          </button>
        </div>
      </div>

      {/* Mobile Menu */}
      {isMobileMenuOpen && (
        <div className="md:hidden bg-white border-t border-gray-100 shadow-lg">
          <div className="px-6 py-4 space-y-3">
            {navLinks.map((link) => (
              <Link
                key={link.name}
                href={link.href}
                className="block text-gray-700 hover:text-blue-600 transition-colors font-medium py-2"
                onClick={() => setIsMobileMenuOpen(false)}
              >
                {link.name}
              </Link>
            ))}

            <div className="pt-3">
              <LanguageToggle />
            </div>

            {isLoaded && (
              <>
                {isSignedIn ? (
                  <>
                    <Link
                      href="/workspace"
                      className="block text-center bg-blue-100 text-blue-700 px-6 py-2.5 rounded-lg font-medium mt-4"
                      onClick={() => setIsMobileMenuOpen(false)}
                    >
                      Workspace
                    </Link>
                    <div className="flex justify-center mt-4">
                      <UserButton afterSignOutUrl="/" />
                    </div>
                  </>
                ) : (
                  <>
                    <Link
                      href="/sign-in"
                      className="block text-center border-2 border-blue-600 text-blue-600 px-6 py-2.5 rounded-lg font-medium mt-4"
                      onClick={() => setIsMobileMenuOpen(false)}
                    >
                      Connexion
                    </Link>
                    <Link
                      href="/sign-up"
                      className="block text-center bg-blue-600 text-white px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-all font-medium"
                      onClick={() => setIsMobileMenuOpen(false)}
                    >
                      Commencer
                    </Link>
                  </>
                )}
              </>
            )}
          </div>
        </div>
      )}
    </nav>
  );
}

==================================================
FICHIER : frontend/components/LanguageToggle.tsx
==================================================

'use client';

import { useLanguage } from '@/contexts/LanguageContext';
import { Languages } from 'lucide-react';

export default function LanguageToggle() {
  const { language, setLanguage } = useLanguage();

  return (
    <div className="flex items-center space-x-2 bg-gray-100 rounded-lg p-1">
      <Languages size={18} className="text-gray-600 ml-2" />
      <button
        onClick={() => setLanguage('en')}
        className={`px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${
          language === 'en'
            ? 'bg-white text-primary-600 shadow-sm'
            : 'text-gray-600 hover:text-gray-900'
        }`}
      >
        EN
      </button>
      <button
        onClick={() => setLanguage('fr')}
        className={`px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${
          language === 'fr'
            ? 'bg-white text-primary-600 shadow-sm'
            : 'text-gray-600 hover:text-gray-900'
        }`}
      >
        FR
      </button>
    </div>
  );
}

==================================================
FICHIER : frontend/components/InstallPWA.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { Download, X } from 'lucide-react';

export default function InstallPWA() {
  const [deferredPrompt, setDeferredPrompt] = useState<any>(null);
  const [showInstallPrompt, setShowInstallPrompt] = useState(false);

  useEffect(() => {
    // √âcouter l'√©v√©nement beforeinstallprompt
    const handleBeforeInstallPrompt = (e: any) => {
      e.preventDefault();
      setDeferredPrompt(e);

      // V√©rifier si d√©j√† install√© ou si l'utilisateur a refus√©
      const hasDeclined = localStorage.getItem('pwa-install-declined');
      const isInstalled = window.matchMedia('(display-mode: standalone)').matches;

      if (!hasDeclined && !isInstalled) {
        // Attendre 10 secondes avant d'afficher
        setTimeout(() => {
          setShowInstallPrompt(true);
        }, 10000);
      }
    };

    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

    // D√©tecter si d√©j√† install√©
    if (window.matchMedia('(display-mode: standalone)').matches) {
      console.log('‚úÖ App d√©j√† install√©e');
    }

    return () => {
      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
    };
  }, []);

  const handleInstallClick = async () => {
    if (!deferredPrompt) return;

    // Afficher le prompt d'installation
    deferredPrompt.prompt();

    // Attendre le choix de l'utilisateur
    const { outcome } = await deferredPrompt.userChoice;
    console.log(`User choice: ${outcome}`);

    if (outcome === 'accepted') {
      console.log('‚úÖ App install√©e');
    } else {
      console.log('‚ùå Installation refus√©e');
      localStorage.setItem('pwa-install-declined', 'true');
    }

    setDeferredPrompt(null);
    setShowInstallPrompt(false);
  };

  const handleDismiss = () => {
    setShowInstallPrompt(false);
    localStorage.setItem('pwa-install-declined', 'true');
  };

  if (!showInstallPrompt) return null;

  return (
    <div className="fixed bottom-0 left-0 right-0 z-50 p-4 animate-slide-up">
      <div className="max-w-md mx-auto bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl overflow-hidden">
        <div className="p-6 text-gray-900 relative">
          <button
            onClick={handleDismiss}
            className="absolute top-4 right-4 text-gray-900/80 hover:text-white"
          >
            <X size={20} />
          </button>

          <div className="flex items-start space-x-4 pr-8">
            <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0">
              <Download size={24} />
            </div>

            <div className="flex-1">
              <h3 className="text-lg font-bold mb-1">
                üì± Installer Studia
              </h3>
              <p className="text-sm text-blue-100 mb-4">
                Installez l'app pour un acc√®s rapide et une exp√©rience optimale
              </p>

              <div className="flex gap-3">
                <button
                  onClick={handleInstallClick}
                  className="px-6 py-2.5 bg-white text-blue-600 rounded-lg font-bold hover:bg-blue-50 transition-all active:scale-95"
                >
                  Installer
                </button>
                <button
                  onClick={handleDismiss}
                  className="px-6 py-2.5 bg-white/20 text-gray-900 rounded-lg font-semibold hover:bg-white/30 transition-all active:scale-95"
                >
                  Plus tard
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/Features.tsx
==================================================

'use client';

import { Brain, FileText, Lightbulb, Repeat, Sparkles, TrendingUp } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function Features() {
  const { t } = useLanguage();

  const features = [
    {
      icon: <Brain size={28} />,
      title: t.features.feature1,
      description: t.features.feature1Desc,
    },
    {
      icon: <FileText size={28} />,
      title: t.features.feature2,
      description: t.features.feature2Desc,
    },
    {
      icon: <Repeat size={28} />,
      title: t.features.feature3,
      description: t.features.feature3Desc,
    },
    {
      icon: <TrendingUp size={28} />,
      title: t.features.feature4,
      description: t.features.feature4Desc,
    },
    {
      icon: <Lightbulb size={28} />,
      title: t.features.feature5,
      description: t.features.feature5Desc,
    },
    {
      icon: <Sparkles size={28} />,
      title: t.features.feature6,
      description: t.features.feature6Desc,
    },
  ];

  return (
    <section id="features" className="section-padding bg-gradient-to-b from-white to-primary-50">
      <div className="max-w-7xl mx-auto">
        {/* Section Header */}
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-4">
            {t.features.title} <span className="text-gradient">{t.features.titleHighlight}</span>
          </h2>
          <p className="text-lg text-gray-600 max-w-2xl mx-auto">
            {t.features.subtitle}
          </p>
        </div>

        {/* Features Grid */}
        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {features.map((feature, index) => (
            <div
              key={index}
              className="group bg-white p-8 rounded-2xl hover:shadow-2xl transition-all duration-300 border border-gray-100 hover:border-primary-200"
            >
              <div className="w-14 h-14 bg-gradient-to-br from-primary-600 to-primary-400 rounded-xl flex items-center justify-center mb-6 text-white group-hover:scale-110 transition-transform">
                {feature.icon}
              </div>
              <h3 className="text-xl font-bold text-gray-900 mb-3">
                {feature.title}
              </h3>
              <p className="text-gray-600 leading-relaxed">
                {feature.description}
              </p>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/Footer.tsx
==================================================

'use client';

import Link from 'next/link';
import { Github, Mail, Heart } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function Footer() {
  const { t } = useLanguage();

  return (
    <footer className="bg-gray-900 text-gray-300">
      <div className="max-w-7xl mx-auto px-6 md:px-12 lg:px-24 py-12">
        <div className="grid md:grid-cols-4 gap-8">
          {/* Brand */}
          <div className="md:col-span-2">
            <div className="flex items-center space-x-2 mb-4">
              <div className="w-10 h-10 bg-gradient-to-br from-primary-600 to-primary-400 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-xl">S</span>
              </div>
              <span className="text-2xl font-bold text-white">Studia</span>
            </div>
            <p className="text-gray-400 mb-4 max-w-sm">
              {t.footer.description}
            </p>
            <div className="flex items-center space-x-4">
              <Link
                href="https://github.com/cyberhacker1210"
                target="_blank"
                rel="noopener noreferrer"
                className="w-10 h-10 bg-gray-800 text-gray-300 rounded-lg flex items-center justify-center hover:bg-gray-700 transition-colors"
              >
                <Github size={20} />
              </Link>
              <Link
                href="mailto:contact@studia.com"
                className="w-10 h-10 bg-gray-800 text-gray-300 rounded-lg flex items-center justify-center hover:bg-gray-700 transition-colors"
              >
                <Mail size={20} />
              </Link>
            </div>
          </div>

          {/* Quick Links */}
          <div>
            <h4 className="text-white font-semibold mb-4">{t.footer.quickLinks}</h4>
            <ul className="space-y-2">
              <li>
                <Link href="#home" className="hover:text-primary-400 transition-colors">
                  {t.nav.home}
                </Link>
              </li>
              <li>
                <Link href="#about" className="hover:text-primary-400 transition-colors">
                  {t.nav.about}
                </Link>
              </li>
              <li>
                <Link href="#features" className="hover:text-primary-400 transition-colors">
                  {t.nav.features}
                </Link>
              </li>
              <li>
                <Link href="#why" className="hover:text-primary-400 transition-colors">
                  {t.nav.why}
                </Link>
              </li>
            </ul>
          </div>

          {/* Legal */}
          <div>
            <h4 className="text-white font-semibold mb-4">{t.footer.legal}</h4>
            <ul className="space-y-2">
              <li>
                <Link href="#" className="hover:text-primary-400 transition-colors">
                  {t.footer.privacy}
                </Link>
              </li>
              <li>
                <Link href="#" className="hover:text-primary-400 transition-colors">
                  {t.footer.terms}
                </Link>
              </li>
              <li>
                <Link href="#" className="hover:text-primary-400 transition-colors">
                  {t.footer.cookies}
                </Link>
              </li>
            </ul>
          </div>
        </div>

        {/* Bottom Bar */}
        <div className="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between">
          <p className="text-gray-400 text-sm">
            ¬© 2024 Studia. {t.footer.rights}
          </p>
          <p className="text-gray-400 text-sm flex items-center space-x-1 mt-4 md:mt-0">
            <span>{t.footer.madeWith}</span>
            <Heart size={16} className="text-red-500 fill-current" />
            <span>{t.footer.by}</span>
          </p>
        </div>
      </div>
    </footer>
  );
}

==================================================
FICHIER : frontend/components/CTA.tsx
==================================================

'use client';

import { useState } from 'react';
import { ArrowRight, CheckCircle, AlertCircle } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function CTA() {
  const { t, language } = useLanguage();
  const [email, setEmail] = useState('');
  const [status, setStatus] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');
  const [errorMessage, setErrorMessage] = useState('');

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setStatus('loading');
    setErrorMessage('');

    try {
      const response = await fetch('/api/waitlist', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, language }),
      });

      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.error || 'Something went wrong');
      }

      setStatus('success');
      setEmail('');

      setTimeout(() => {
        setStatus('idle');
      }, 5000);
    } catch (error) {
      setStatus('error');
      setErrorMessage(error instanceof Error ? error.message : 'Failed to join waitlist');

      setTimeout(() => {
        setStatus('idle');
        setErrorMessage('');
      }, 5000);
    }
  };

  return (
    <section id="waitlist" className="section-padding bg-gradient-to-br from-primary-600 to-primary-700">
      <div className="max-w-4xl mx-auto text-center">
        <h2 className="text-3xl md:text-5xl font-bold text-white mb-6">
          {t.cta.title}
        </h2>
        <p className="text-lg md:text-xl text-primary-100 mb-10">
          {t.cta.subtitle}
        </p>

        {/* Waitlist Form */}
        {status !== 'success' ? (
          <form
            onSubmit={handleSubmit}
            className="flex flex-col sm:flex-row gap-4 max-w-xl mx-auto"
          >
            <input
              type="email"
              placeholder={t.cta.placeholder}
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              required
              disabled={status === 'loading'}
              className="flex-1 px-6 py-4 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-primary-300 disabled:opacity-50 disabled:cursor-not-allowed"
            />
            <button
              type="submit"
              disabled={status === 'loading'}
              className="group bg-white text-primary-600 px-8 py-4 rounded-lg hover:bg-gray-100 transition-all duration-200 font-semibold flex items-center justify-center space-x-2 shadow-xl hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <span>{status === 'loading' ? (language === 'fr' ? 'Envoi...' : 'Sending...') : t.cta.button}</span>
              <ArrowRight
                size={20}
                className="group-hover:translate-x-1 transition-transform"
              />
            </button>
          </form>
        ) : (
          <div className="flex items-center justify-center space-x-3 bg-white/10 backdrop-blur-sm text-white px-6 py-4 rounded-lg max-w-xl mx-auto">
            <CheckCircle size={24} />
            <span className="font-medium">
              {t.cta.success}
            </span>
          </div>
        )}

        {/* Error Message */}
        {status === 'error' && (
          <div className="flex items-center justify-center space-x-3 bg-red-500/20 backdrop-blur-sm text-white px-6 py-4 rounded-lg max-w-xl mx-auto mt-4">
            <AlertCircle size={24} />
            <span className="font-medium">{errorMessage}</span>
          </div>
        )}

        {/* Trust Indicators */}
        <div className="mt-12 flex flex-wrap items-center justify-center gap-8 text-primary-100">
          <div className="flex items-center space-x-2">
            <CheckCircle size={20} />
            <span>{t.cta.trust1}</span>
          </div>
          <div className="flex items-center space-x-2">
            <CheckCircle size={20} />
            <span>{t.cta.trust2}</span>
          </div>
          <div className="flex items-center space-x-2">
            <CheckCircle size={20} />
            <span>{t.cta.trust3}</span>
          </div>
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/Creator.tsx
==================================================

'use client';

import { Github, Mail } from 'lucide-react';
import Link from 'next/link';
import { useLanguage } from '@/contexts/LanguageContext';

export default function Creator() {
  const { t } = useLanguage();

  return (
    <section id="creator" className="section-padding bg-gradient-to-b from-primary-50 to-white">
      <div className="max-w-4xl mx-auto">
        <div className="text-center mb-12">
          <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-4">
            {t.creator.title} <span className="text-gradient">{t.creator.titleHighlight}</span>
          </h2>
          <p className="text-lg text-gray-600">
            {t.creator.subtitle}
          </p>
        </div>

        <div className="bg-white rounded-2xl shadow-xl p-8 md:p-12 border border-primary-100">
          <div className="flex flex-col md:flex-row items-center md:items-start gap-8">
            {/* Avatar */}
            <div className="w-32 h-32 bg-gradient-to-br from-primary-600 to-primary-400 rounded-full flex items-center justify-center text-white text-5xl font-bold flex-shrink-0">
              DL
            </div>

            {/* Content */}
            <div className="flex-1 text-center md:text-left">
              <h3 className="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
                Daniel Leo
              </h3>
              <p className="text-primary-600 font-medium mb-4">
                {t.creator.role}
              </p>
              <p className="text-gray-600 leading-relaxed mb-6">
                {t.creator.bio}
              </p>

              {/* Social Links */}
              <div className="flex items-center justify-center md:justify-start space-x-4">
                <Link
                  href="https://github.com/cyberhacker1210"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="w-10 h-10 bg-white text-gray-900 rounded-lg flex items-center justify-center hover:bg-gray-800 transition-colors"
                >
                  <Github size={20} />
                </Link>
                <Link
                  href="mailto:contact@studia.com"
                  className="w-10 h-10 bg-primary-600 text-gray-900 rounded-lg flex items-center justify-center hover:bg-primary-700 transition-colors"
                >
                  <Mail size={20} />
                </Link>
              </div>
            </div>
          </div>

          {/* Quote */}
          <div className="mt-8 pt-8 border-t border-gray-200">
            <blockquote className="text-center italic text-gray-700 text-lg">
              {t.creator.quote}
            </blockquote>
          </div>
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/WhyStudia.tsx
==================================================

'use client';

import { Check } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function WhyStudia() {
  const { t } = useLanguage();

  const benefits = [
    {
      title: t.why.benefit1,
      description: t.why.benefit1Desc,
    },
    {
      title: t.why.benefit2,
      description: t.why.benefit2Desc,
    },
    {
      title: t.why.benefit3,
      description: t.why.benefit3Desc,
    },
    {
      title: t.why.benefit4,
      description: t.why.benefit4Desc,
    },
    {
      title: t.why.benefit5,
      description: t.why.benefit5Desc,
    },
    {
      title: t.why.benefit6,
      description: t.why.benefit6Desc,
    },
  ];

  return (
    <section id="why" className="section-padding bg-white">
      <div className="max-w-7xl mx-auto">
        <div className="grid lg:grid-cols-2 gap-12 items-center">
          {/* Left Content */}
          <div>
            <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-6">
              {t.why.title} <span className="text-gradient">{t.why.titleHighlight}</span>
            </h2>
            <p className="text-lg text-gray-600 mb-8 leading-relaxed">
              {t.why.subtitle}
            </p>
            <div className="space-y-4">
              {benefits.slice(0, 3).map((benefit, index) => (
                <div key={index} className="flex items-start space-x-3">
                  <div className="w-6 h-6 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                    <Check size={16} className="text-gray-900" />
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-900">
                      {benefit.title}
                    </h4>
                    <p className="text-gray-600 text-sm">
                      {benefit.description}
                    </p>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Right Content */}
          <div className="space-y-4">
            {benefits.slice(3).map((benefit, index) => (
              <div
                key={index}
                className="bg-gradient-to-br from-primary-50 to-white p-6 rounded-xl border border-primary-100 hover:shadow-lg transition-all duration-300"
              >
                <div className="flex items-start space-x-3">
                  <div className="w-6 h-6 bg-primary-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                    <Check size={16} className="text-gray-900" />
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-1">
                      {benefit.title}
                    </h4>
                    <p className="text-gray-600 text-sm">
                      {benefit.description}
                    </p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/About.tsx
==================================================

'use client';

import { BookOpen, Target, Zap } from 'lucide-react';
import { useLanguage } from '@/contexts/LanguageContext';

export default function About() {
  const { t } = useLanguage();

  return (
    <section id="about" className="section-padding bg-white">
      <div className="max-w-7xl mx-auto">
        {/* Section Header */}
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-5xl font-bold text-gray-900 mb-4">
            {t.about.title} <span className="text-gradient">{t.about.titleHighlight}</span>
          </h2>
          <p className="text-lg text-gray-600 max-w-2xl mx-auto">
            {t.about.subtitle}
          </p>
        </div>

        {/* Content Grid */}
        <div className="grid md:grid-cols-3 gap-8">
          {/* Card 1 */}
          <div className="group bg-gradient-to-br from-primary-50 to-white p-8 rounded-2xl hover:shadow-xl transition-all duration-300 border border-primary-100">
            <div className="w-14 h-14 bg-primary-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <BookOpen className="text-gray-900" size={28} />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-3">
              {t.about.mission}
            </h3>
            <p className="text-gray-600 leading-relaxed">
              {t.about.missionDesc}
            </p>
          </div>

          {/* Card 2 */}
          <div className="group bg-gradient-to-br from-primary-50 to-white p-8 rounded-2xl hover:shadow-xl transition-all duration-300 border border-primary-100">
            <div className="w-14 h-14 bg-primary-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <Target className="text-gray-900" size={28} />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-3">
              {t.about.vision}
            </h3>
            <p className="text-gray-600 leading-relaxed">
              {t.about.visionDesc}
            </p>
          </div>

          {/* Card 3 */}
          <div className="group bg-gradient-to-br from-primary-50 to-white p-8 rounded-2xl hover:shadow-xl transition-all duration-300 border border-primary-100">
            <div className="w-14 h-14 bg-primary-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <Zap className="text-gray-900" size={28} />
            </div>
            <h3 className="text-2xl font-bold text-gray-900 mb-3">
              {t.about.approach}
            </h3>
            <p className="text-gray-600 leading-relaxed">
              {t.about.approachDesc}
            </p>
          </div>
        </div>
      </div>
    </section>
  );
}

==================================================
FICHIER : frontend/components/ui/LoadingSpinner.tsx
==================================================

'use client';

import React from 'react';

interface LoadingSpinnerProps {
  size?: 'sm' | 'md' | 'lg' | 'xl';
  color?: 'primary' | 'white' | 'gray';
  text?: string;
  fullScreen?: boolean;
}

export default function LoadingSpinner({
  size = 'md',
  color = 'primary',
  text,
  fullScreen = false
}: LoadingSpinnerProps) {
  const sizeClasses = {
    sm: 'w-4 h-4 border-2',
    md: 'w-8 h-8 border-3',
    lg: 'w-12 h-12 border-4',
    xl: 'w-16 h-16 border-4'
  };

  const colorClasses = {
    primary: 'border-blue-600 border-t-transparent',
    white: 'border-white border-t-transparent',
    gray: 'border-gray-400 border-t-transparent'
  };

  const spinner = (
    <div className={`${sizeClasses[size]} ${colorClasses[color]} rounded-full animate-spin`} />
  );

  if (fullScreen) {
    return (
      <div className="fixed inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-50">
        <div className="text-center">
          <div className="inline-block mb-4">{spinner}</div>
          {text && (
            <p className="text-gray-600 font-medium animate-pulse">{text}</p>
          )}
        </div>
      </div>
    );
  }

  return (
    <div className="flex items-center justify-center space-x-3">
      {spinner}
      {text && (
        <span className="text-gray-600 font-medium animate-pulse">{text}</span>
      )}
    </div>
  );
}

==================================================
FICHIER : frontend/components/ui/Toast.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { CheckCircle, XCircle, AlertCircle, Info, X } from 'lucide-react';

type ToastType = 'success' | 'error' | 'warning' | 'info';

interface ToastProps {
  type: ToastType;
  message: string;
  duration?: number;
  onClose: () => void;
}

export default function Toast({ type, message, duration = 5000, onClose }: ToastProps) {
  const [isVisible, setIsVisible] = useState(true);
  const [isExiting, setIsExiting] = useState(false);

  useEffect(() => {
    const timer = setTimeout(() => {
      handleClose();
    }, duration);

    return () => clearTimeout(timer);
  }, [duration]);

  const handleClose = () => {
    setIsExiting(true);
    setTimeout(() => {
      setIsVisible(false);
      onClose();
    }, 300);
  };

  if (!isVisible) return null;

  const configs = {
    success: {
      icon: CheckCircle,
      bgColor: 'bg-green-50',
      borderColor: 'border-green-500',
      textColor: 'text-green-900',
      iconColor: 'text-green-500'
    },
    error: {
      icon: XCircle,
      bgColor: 'bg-red-50',
      borderColor: 'border-red-500',
      textColor: 'text-red-900',
      iconColor: 'text-red-500'
    },
    warning: {
      icon: AlertCircle,
      bgColor: 'bg-orange-50',
      borderColor: 'border-orange-500',
      textColor: 'text-orange-900',
      iconColor: 'text-orange-500'
    },
    info: {
      icon: Info,
      bgColor: 'bg-blue-50',
      borderColor: 'border-blue-500',
      textColor: 'text-blue-900',
      iconColor: 'text-blue-500'
    }
  };

  const config = configs[type];
  const Icon = config.icon;

  return (
    <div
      className={`
        fixed top-4 right-4 z-50 max-w-md w-full mx-4 sm:mx-0
        ${config.bgColor} ${config.borderColor} border-l-4 rounded-xl shadow-2xl p-4
        ${isExiting ? 'animate-slide-out-right' : 'animate-slide-in-right'}
        transition-all duration-300
      `}
    >
      <div className="flex items-start space-x-3">
        <Icon className={`${config.iconColor} flex-shrink-0 mt-0.5`} size={20} />
        <p className={`${config.textColor} flex-1 text-sm font-medium leading-relaxed`}>
          {message}
        </p>
        <button
          onClick={handleClose}
          className="text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0"
        >
          <X size={18} />
        </button>
      </div>
    </div>
  );
}

// Hook pour utiliser les toasts
export function useToast() {
  const [toasts, setToasts] = useState<Array<{ id: string; type: ToastType; message: string }>>([]);

  const showToast = (type: ToastType, message: string) => {
    const id = Math.random().toString(36).substr(2, 9);
    setToasts(prev => [...prev, { id, type, message }]);
  };

  const removeToast = (id: string) => {
    setToasts(prev => prev.filter(toast => toast.id !== id));
  };

  return {
    toasts,
    showToast,
    removeToast,
    success: (message: string) => showToast('success', message),
    error: (message: string) => showToast('error', message),
    warning: (message: string) => showToast('warning', message),
    info: (message: string) => showToast('info', message)
  };
}

==================================================
FICHIER : frontend/components/layout/Sidebar.tsx
==================================================

'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import {
  Home, BookOpen, Layers, Crown, GraduationCap, Settings
} from 'lucide-react';
import { UserButton } from '@clerk/nextjs';

export default function Sidebar() {
  const pathname = usePathname();

  const navItems = [
    { icon: Home, label: 'Accueil', href: '/workspace' },
    { icon: BookOpen, label: 'Biblioth√®que', href: '/workspace/courses' },
    { icon: Layers, label: 'R√©visions', href: '/workspace/flashcards' },
  ];

  return (
    <aside className="hidden md:flex flex-col w-64 h-screen bg-white border-r border-gray-200 fixed left-0 top-0 z-50">

      {/* LOGO */}
      <div className="h-16 flex items-center px-6 border-b border-gray-100">
        <div className="flex items-center gap-2 text-xl font-bold text-gray-900 tracking-tight">
          <div className="w-8 h-8 bg-black text-white rounded-lg flex items-center justify-center">
            <GraduationCap size={18} />
          </div>
          Studia.
        </div>
      </div>

      {/* NAV */}
      <nav className="flex-1 p-4 space-y-1">
        {navItems.map((item) => {
          const isActive = pathname === item.href;
          return (
            <Link
              key={item.href}
              href={item.href}
              className={`flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-bold transition-colors ${
                isActive 
                  ? 'bg-gray-100 text-gray-900' 
                  : 'text-gray-500 hover:bg-gray-50 hover:text-gray-900'
              }`}
            >
              <item.icon size={18} strokeWidth={2.5} className={isActive ? "text-gray-900" : "text-gray-400"} />
              {item.label}
            </Link>
          );
        })}
      </nav>

      {/* PREMIUM & USER */}
      <div className="p-4 border-t border-gray-100 space-y-4">
        <div className="bg-gray-50 border border-gray-200 rounded-xl p-4">
            <div className="flex items-center gap-2 mb-2 text-xs font-black uppercase tracking-wider text-gray-900">
                <Crown size={14} className="text-yellow-500 fill-yellow-500"/> Premium
            </div>
            <p className="text-xs text-gray-500 mb-3 leading-tight">D√©bloque l'acc√®s illimit√© √† l'IA.</p>
            <button className="w-full bg-black text-white py-2 rounded-lg text-xs font-bold hover:bg-gray-800">
                Voir les offres
            </button>
        </div>

        <div className="flex items-center justify-between px-1">
            <div className="flex items-center gap-2">
                <UserButton afterSignOutUrl="/"/>
                <span className="text-xs font-bold text-gray-700">Mon Compte</span>
            </div>
            <Settings size={16} className="text-gray-400 cursor-pointer hover:text-gray-600"/>
        </div>
      </div>
    </aside>
  );
}

==================================================
FICHIER : frontend/components/workspace/QuizDisplay.tsx
==================================================

'use client';

import { useState } from 'react';
import { Quiz } from '@/lib/api';
import { ChevronRight, ChevronLeft } from 'lucide-react';

interface QuizDisplayProps {
  quiz: Quiz;
  onComplete: (answers: number[]) => void;
}

export default function QuizDisplay({ quiz, onComplete }: QuizDisplayProps) {
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [selectedAnswers, setSelectedAnswers] = useState<number[]>(
    new Array(quiz.questions.length).fill(-1)
  );

  const question = quiz.questions[currentQuestion];
  const isLastQuestion = currentQuestion === quiz.questions.length - 1;
  const canGoNext = selectedAnswers[currentQuestion] !== -1;

  const handleSelectAnswer = (optionIndex: number) => {
    const newAnswers = [...selectedAnswers];
    newAnswers[currentQuestion] = optionIndex;
    setSelectedAnswers(newAnswers);
  };

  const handleNext = () => {
    if (isLastQuestion) {
      onComplete(selectedAnswers);
    } else {
      setCurrentQuestion(currentQuestion + 1);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  const handlePrevious = () => {
    setCurrentQuestion(currentQuestion - 1);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  return (
    <div className="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
      {/* Progress Bar */}
      <div className="p-4 sm:p-6 bg-gradient-to-r from-blue-50 to-purple-50 border-b border-gray-200">
        <div className="flex items-center justify-between mb-3">
          <span className="text-sm sm:text-base font-semibold text-gray-700">
            Question {currentQuestion + 1}/{quiz.questions.length}
          </span>
          <span className="text-sm sm:text-base font-bold text-blue-600">
            {Math.round(((currentQuestion + 1) / quiz.questions.length) * 100)}%
          </span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden shadow-inner">
          <div
            className="bg-gradient-to-r from-blue-600 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out"
            style={{
              width: `${((currentQuestion + 1) / quiz.questions.length) * 100}%`,
            }}
          ></div>
        </div>
      </div>

      {/* Question */}
      <div className="p-4 sm:p-6 md:p-8">
        <h2 className="text-xl sm:text-2xl md:text-3xl font-bold text-gray-900 mb-6 sm:mb-8 leading-snug">
          {question.question}
        </h2>

        {/* Options */}
        <div className="space-y-3 sm:space-y-4 mb-6 sm:mb-8">
          {question.options.map((option, index) => (
            <button
              key={index}
              onClick={() => handleSelectAnswer(index)}
              className={`w-full text-left px-4 sm:px-6 py-4 sm:py-5 rounded-xl sm:rounded-2xl border-2 transition-all duration-200 touch-manipulation active:scale-[0.98] ${
                selectedAnswers[currentQuestion] === index
                  ? 'border-blue-600 bg-blue-50 shadow-lg ring-2 ring-blue-200'
                  : 'border-gray-200 hover:border-gray-300 active:border-blue-400'
              }`}
            >
              <div className="flex items-center space-x-3 sm:space-x-4">
                <div
                  className={`w-6 h-6 sm:w-7 sm:h-7 rounded-full border-2 flex items-center justify-center flex-shrink-0 transition-all ${
                    selectedAnswers[currentQuestion] === index
                      ? 'border-blue-600 bg-blue-600 shadow-md'
                      : 'border-gray-300'
                  }`}
                >
                  {selectedAnswers[currentQuestion] === index && (
                    <div className="w-3 h-3 sm:w-4 sm:h-4 bg-white rounded-full"></div>
                  )}
                </div>
                <span className={`font-medium text-sm sm:text-base md:text-lg leading-relaxed ${
                  selectedAnswers[currentQuestion] === index
                    ? 'text-blue-900'
                    : 'text-gray-700'
                }`}>
                  {option}
                </span>
              </div>
            </button>
          ))}
        </div>

        {/* Navigation */}
        <div className="flex items-center justify-between gap-3">
          <button
            onClick={handlePrevious}
            disabled={currentQuestion === 0}
            className="flex items-center space-x-2 px-4 sm:px-6 py-3 sm:py-3.5 text-gray-600 hover:text-gray-900 active:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all rounded-xl touch-manipulation font-medium text-sm sm:text-base"
          >
            <ChevronLeft size={20} />
            <span className="hidden sm:inline">Pr√©c√©dent</span>
            <span className="sm:hidden">Pr√©c.</span>
          </button>

          <button
            onClick={handleNext}
            disabled={!canGoNext}
            className="flex-1 sm:flex-initial flex items-center justify-center space-x-2 px-6 sm:px-8 py-3.5 sm:py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98] transition-all font-bold shadow-lg disabled:shadow-none text-sm sm:text-base touch-manipulation"
          >
            <span>{isLastQuestion ? 'Terminer' : 'Suivant'}</span>
            <ChevronRight size={20} />
          </button>
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/InstallPWA.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { Download, X } from 'lucide-react';

export default function InstallPWA() {
  const [installPrompt, setInstallPrompt] = useState<any>(null);
  const [showBanner, setShowBanner] = useState(false);

  useEffect(() => {
    const handler = (e: Event) => {
      e.preventDefault();
      setInstallPrompt(e);

      // Show banner if not dismissed
      const dismissed = localStorage.getItem('pwa-banner-dismissed');
      if (!dismissed) {
        setShowBanner(true);
      }
    };

    window.addEventListener('beforeinstallprompt', handler);

    return () => window.removeEventListener('beforeinstallprompt', handler);
  }, []);

  const handleInstall = async () => {
    if (!installPrompt) return;

    installPrompt.prompt();
    const { outcome } = await installPrompt.userChoice;

    if (outcome === 'accepted') {
      console.log('‚úÖ PWA install√©e');
    }

    setInstallPrompt(null);
    setShowBanner(false);
  };

  const handleDismiss = () => {
    setShowBanner(false);
    localStorage.setItem('pwa-banner-dismissed', 'true');
  };

  if (!showBanner || !installPrompt) return null;

  return (
    <div className="fixed bottom-6 left-6 right-6 md:left-auto md:right-6 md:w-96 z-50 animate-slide-up">
      <div className="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl p-6 text-white">
        <div className="flex items-start justify-between mb-4">
          <div className="flex items-center space-x-3">
            <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
              <Download size={24} />
            </div>
            <div>
              <h3 className="font-bold text-lg">Installer Studia</h3>
              <p className="text-sm text-blue-100">Acc√®s rapide + Mode Offline</p>
            </div>
          </div>
          <button
            onClick={handleDismiss}
            className="text-gray-900/80 hover:text-white transition-colors"
          >
            <X size={20} />
          </button>
        </div>

        <button
          onClick={handleInstall}
          className="w-full bg-white text-blue-600 font-semibold py-3 px-6 rounded-xl hover:bg-blue-50 transition-all transform hover:scale-105"
        >
          üì≤ Installer l'app
        </button>

        <p className="mt-3 text-xs text-blue-100 text-center">
          Utilisez Studia comme une app native
        </p>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/CourseChat.tsx
==================================================

'use client';

import { useState, useRef, useEffect } from 'react';
import { Send, User, Bot, Loader2, Sparkles, GraduationCap, AlertTriangle } from 'lucide-react';

interface Message {
  role: 'user' | 'assistant' | 'system';
  content: string;
}

interface CourseChatProps {
  courseText: string;
  courseTitle: string;
}

export default function CourseChat({ courseText, courseTitle }: CourseChatProps) {
  const [messages, setMessages] = useState<Message[]>([
    {
      role: 'assistant',
      content: `Bonjour ! Je suis ton professeur particulier pour le cours **"${courseTitle}"**. \n\nJe suis l√† pour t'aider √† comprendre, pas juste te donner les r√©ponses. Sur quel point veux-tu qu'on travaille ?`
    }
  ]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  // Variable d'environnement pour l'API
  const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';

  // Auto-scroll vers le bas
  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const handleSend = async (e?: React.FormEvent) => {
    e?.preventDefault();
    if (!input.trim() || isLoading) return;

    const userMessage = input.trim();
    setInput('');

    // 1. Ajouter le message utilisateur √† l'interface
    const newHistory = [...messages, { role: 'user', content: userMessage } as Message];
    setMessages(newHistory);
    setIsLoading(true);

    try {
      // 2. Nettoyer l'historique pour l'API (garder uniquement user/assistant)
      const cleanHistory = newHistory
        .filter(m => m.role === 'user' || m.role === 'assistant')
        .map(m => ({ role: m.role, content: m.content }));

      // 3. Appel √† l'API "Professeur Socratique"
      const response = await fetch(`${API_URL}/api/chat/tutor`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          message: userMessage,
          history: cleanHistory,
          course_context: courseText
        }),
      });

      if (!response.ok) {
        throw new Error(`Erreur serveur: ${response.status}`);
      }

      const data = await response.json();

      // 4. Ajouter la r√©ponse du prof
      setMessages(prev => [...prev, { role: 'assistant', content: data.reply }]);
    } catch (error) {
      console.error('Erreur chat:', error);
      setMessages(prev => [...prev, {
        role: 'system',
        content: "‚ùå D√©sol√©, j'ai eu un petit probl√®me de connexion avec le professeur. R√©essaie dans un instant !"
      }]);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="flex flex-col h-[600px] bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden">

      {/* Header du Chat */}
      <div className="bg-gradient-to-r from-blue-600 to-indigo-700 p-4 text-white flex items-center justify-between shadow-md z-10">
        <div className="flex items-center gap-3">
          <div className="bg-white/20 p-2 rounded-full">
            <GraduationCap size={24} className="text-white" />
          </div>
          <div>
            <h3 className="font-bold text-lg">Professeur Studia</h3>
            <p className="text-blue-100 text-xs flex items-center gap-1">
              <Sparkles size={10} /> Mode Socratique Actif
            </p>
          </div>
        </div>
      </div>

      {/* Zone de messages */}
      <div className="flex-1 overflow-y-auto p-6 space-y-6 bg-gray-50">
        {messages.map((msg, idx) => {
          const isUser = msg.role === 'user';
          const isSystem = msg.role === 'system';

          return (
            <div
              key={idx}
              className={`flex w-full ${isUser ? 'justify-end' : 'justify-start'}`}
            >
              <div className={`flex max-w-[85%] md:max-w-[75%] ${isUser ? 'flex-row-reverse' : 'flex-row'} gap-3`}>

                {/* Avatar */}
                {!isSystem && (
                  <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1 ${
                    isUser ? 'bg-blue-100 text-blue-600' : 'bg-indigo-100 text-indigo-600'
                  }`}>
                    {isUser ? <User size={16} /> : <Bot size={16} />}
                  </div>
                )}

                {/* Bulle de message */}
                <div
                  className={`p-4 rounded-2xl shadow-sm text-sm leading-relaxed ${
                    isSystem 
                      ? 'bg-red-50 text-red-600 w-full text-center border border-red-100 flex items-center justify-center gap-2'
                      : isUser
                        ? 'bg-blue-600 text-white rounded-tr-none'
                        : 'bg-white text-gray-800 border border-gray-100 rounded-tl-none'
                  }`}
                >
                  {isSystem && <AlertTriangle size={16} />}

                  {/* Rendu basique du Markdown pour le gras et les retours √† la ligne */}
                  <div className="whitespace-pre-wrap">
                    {msg.content.split('**').map((part, i) =>
                      i % 2 === 1 ? <strong key={i}>{part}</strong> : part
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        })}

        {/* Indicateur de frappe */}
        {isLoading && (
          <div className="flex justify-start w-full animate-in fade-in duration-300">
            <div className="flex items-center gap-3">
              <div className="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center">
                <Bot size={16} />
              </div>
              <div className="bg-white border border-gray-100 p-4 rounded-2xl rounded-tl-none shadow-sm">
                <Loader2 className="w-5 h-5 animate-spin text-indigo-500" />
              </div>
            </div>
          </div>
        )}

        <div ref={messagesEndRef} />
      </div>

      {/* Zone de saisie */}
      <div className="p-4 bg-white border-t border-gray-100">
        <form
          onSubmit={handleSend}
          className="flex items-center gap-2 bg-gray-50 p-2 rounded-xl border border-gray-200 focus-within:border-blue-400 focus-within:ring-2 focus-within:ring-blue-100 transition-all"
        >
          <input
            type="text"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder="Posez votre question au professeur..."
            className="flex-1 bg-transparent border-none focus:ring-0 px-4 py-2 text-gray-700 placeholder-gray-400 outline-none"
            disabled={isLoading}
          />
          <button
            type="submit"
            disabled={!input.trim() || isLoading}
            className="p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm flex items-center justify-center"
          >
            {isLoading ? <Loader2 size={18} className="animate-spin" /> : <Send size={18} />}
          </button>
        </form>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/MotivatorWidget.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { ArrowRight, Loader2, Check, Trophy, Sparkles, RefreshCw } from 'lucide-react';
import { addXp } from '@/lib/gamificationService';
import { useUser } from '@clerk/nextjs';

export default function MotivatorWidget() {
  const { user } = useUser();
  const [goal, setGoal] = useState('');
  const [deadline, setDeadline] = useState('');
  const [plan, setPlan] = useState<any>(null);
  const [loading, setLoading] = useState(false);
  const [completedIds, setCompletedIds] = useState<number[]>([]);
  const [isLoaded, setIsLoaded] = useState(false);

  const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';

  useEffect(() => {
    const savedPlan = localStorage.getItem('studia_daily_plan');
    const savedCompleted = localStorage.getItem('studia_completed_tasks');
    const savedGoal = localStorage.getItem('studia_goal');

    if (savedPlan) setPlan(JSON.parse(savedPlan));
    if (savedCompleted) setCompletedIds(JSON.parse(savedCompleted));
    if (savedGoal) setGoal(savedGoal);
    setIsLoaded(true);
  }, []);

  useEffect(() => {
    if (!isLoaded) return;
    if (plan) localStorage.setItem('studia_daily_plan', JSON.stringify(plan));
    else localStorage.removeItem('studia_daily_plan');
    localStorage.setItem('studia_completed_tasks', JSON.stringify(completedIds));
    localStorage.setItem('studia_goal', goal);
  }, [plan, completedIds, goal, isLoaded]);

  const generatePlan = async () => {
    if (!goal || !deadline) return;
    setLoading(true);
    try {
        const res = await fetch(`${API_URL}/api/motivation/generate`, {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ goal, deadline, current_xp: 1200 }),
        });
        const data = await res.json();
        setPlan(data); setCompletedIds([]);
    } catch (err) { console.error(err); }
    finally { setLoading(false); }
  };

  const handleComplete = async (id: number, xp: number) => {
      if (completedIds.includes(id)) return;
      setCompletedIds([...completedIds, id]);
      if (user) await addXp(user.id, xp, 'Micro-t√¢che');
  };

  const resetPlan = () => {
      if (confirm("Abandonner ?")) {
          setPlan(null); setCompletedIds([]); setGoal(''); setDeadline('');
      }
  };

  const progress = plan ? Math.round((completedIds.length / plan.micro_tasks.length) * 100) : 0;
  if (!isLoaded) return null;

  // Design "Carte Brilliant" (Blanc, Bordure grise, Compact)
  return (
    <div className="bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm">

      {plan && (
        <div className="h-1.5 w-full bg-gray-100">
            <div className="h-full bg-gradient-to-r from-orange-500 to-red-500 transition-all duration-1000" style={{ width: `${progress}%` }} />
        </div>
      )}

      <div className="p-5">
        {!plan ? (
          <div className="space-y-3">
            <input
                type="text" placeholder="Objectif (ex: Chapitre 1)"
                className="w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-medium outline-none focus:border-black transition-colors"
                value={goal} onChange={(e) => setGoal(e.target.value)}
            />
            <input
                type="text" placeholder="Deadline (ex: Demain)"
                className="w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-medium outline-none focus:border-black transition-colors"
                value={deadline} onChange={(e) => setDeadline(e.target.value)}
            />
            <button
              onClick={generatePlan} disabled={loading || !goal}
              className="w-full bg-black text-white font-bold py-2.5 rounded-lg text-sm hover:bg-gray-800 flex items-center justify-center gap-2"
            >
              {loading ? <Loader2 className="animate-spin" size={14}/> : <Sparkles size={14}/>} G√©n√©rer
            </button>
          </div>
        ) : (
          <div className="space-y-4 animate-in fade-in">
            <div className="bg-orange-50 p-3 rounded-lg border border-orange-100">
                <p className="text-xs font-bold text-gray-800">"{plan.daily_message}"</p>
            </div>
            <div className="space-y-2">
              {plan.micro_tasks.map((task: any) => {
                const isDone = completedIds.includes(task.id);
                return (
                  <button
                      key={task.id} onClick={() => handleComplete(task.id, task.xp_reward)} disabled={isDone}
                      className={`w-full flex items-center justify-between p-2.5 rounded-lg border text-left transition-all ${isDone ? 'bg-green-50 border-green-100' : 'bg-white border-gray-100 hover:border-gray-300'}`}
                  >
                      <div className="flex items-center gap-3">
                          <div className={`w-4 h-4 rounded-full border flex items-center justify-center ${isDone ? 'bg-green-500 border-green-500 text-white' : 'border-gray-300'}`}>
                              {isDone && <Check size={10} strokeWidth={4} />}
                          </div>
                          <span className={`text-xs font-bold ${isDone ? 'text-gray-400 line-through' : 'text-gray-700'}`}>{task.task}</span>
                      </div>
                  </button>
                )
              })}
            </div>
            <button onClick={resetPlan} className="text-xs font-bold text-gray-400 hover:text-red-500 flex items-center gap-1 mx-auto"><RefreshCw size={10}/> Reset</button>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/ImageUpload.tsx
==================================================

'use client';

import { useRef } from 'react';
import { Camera, X, Check } from 'lucide-react';

interface ImageUploadProps {
  onImageSelected: (imageData: string) => void;
  selectedImage: string | null;
  onClear: () => void;
}

export default function ImageUpload({ onImageSelected, selectedImage, onClear }: ImageUploadProps) {
  const fileInputRef = useRef<HTMLInputElement>(null);

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      handleFile(file);
    }
  };

  const handleFile = (file: File) => {
    // Check file size (max 10MB)
    if (file.size > 10 * 1024 * 1024) {
      alert('Image trop grande. Taille maximale : 10MB.');
      return;
    }

    // Read file as base64
    const reader = new FileReader();
    reader.onload = (e) => {
      const result = e.target?.result as string;
      onImageSelected(result);
    };
    reader.readAsDataURL(file);
  };

  const handleCameraClick = () => {
    fileInputRef.current?.click();
  };

  // After selection - Display image
  if (selectedImage) {
    return (
      <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
        <div className="flex items-center justify-between mb-4">
          <div className="flex items-center space-x-2 text-green-600">
            <Check size={20} />
            <span className="font-medium">Photo prise avec succ√®s</span>
          </div>
          <button
            onClick={onClear}
            className="text-gray-400 hover:text-red-600 transition-colors"
          >
            <X size={20} />
          </button>
        </div>

        <div className="relative rounded-lg overflow-hidden border-2 border-gray-200">
          <img
            src={selectedImage}
            alt="Course preview"
            className="w-full max-h-96 object-contain bg-gray-50"
          />
        </div>

        <p className="text-sm text-gray-500 mt-4 text-center">
          Pr√™t √† g√©n√©rer le quiz depuis cette photo
        </p>
      </div>
    );
  }

  // Before selection - Camera button
  return (
    <div className="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
      <input
        ref={fileInputRef}
        type="file"
        accept="image/*"
        capture="environment"
        onChange={handleFileSelect}
        className="hidden"
      />

      <div className="text-center">
        <button
          onClick={handleCameraClick}
          className="group relative w-full max-w-md mx-auto"
        >
          <div className="bg-gradient-to-br from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-2xl p-12 transition-all duration-300 shadow-2xl hover:shadow-blue-500/50 transform hover:scale-105">
            <div className="w-24 h-24 mx-auto mb-6 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
              <Camera size={48} className="text-gray-900" />
            </div>

            <h3 className="text-2xl md:text-3xl font-bold mb-2">
              Prendre une Photo
            </h3>
            <p className="text-blue-100 text-lg">
              Photographiez votre cours
            </p>
          </div>
        </button>

        <div className="mt-6 space-y-2 text-gray-600">
          <p className="text-sm">
            üì∏ <strong>Sur mobile :</strong> La cam√©ra s'ouvrira directement
          </p>
          <p className="text-sm">
            üíª <strong>Sur ordinateur :</strong> S√©lectionnez une image
          </p>
        </div>

        <div className="mt-8 p-4 bg-blue-50 rounded-lg border border-blue-200">
          <h4 className="font-semibold text-blue-900 mb-2">üí° Conseils :</h4>
          <ul className="text-sm text-blue-800 space-y-1 text-left">
            <li>‚úì Texte lisible</li>
            <li>‚úì Bon √©clairage</li>
            <li>‚úì Photo bien cadr√©e</li>
            <li>‚úì √âvitez le flou</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/MultiImageCapture.tsx
==================================================

'use client';

import { useState, useRef } from 'react';
import { Camera, Image as ImageIcon, X, Upload } from 'lucide-react';

interface MultiImageCaptureProps {
  onImagesSelected: (images: string[]) => void;
  maxImages?: number;
}

export default function MultiImageCapture({
  onImagesSelected,
  maxImages = 10
}: MultiImageCaptureProps) {
  const [selectedImages, setSelectedImages] = useState<string[]>([]);
  const cameraInputRef = useRef<HTMLInputElement>(null);
  const galleryInputRef = useRef<HTMLInputElement>(null);

  const handleImageSelection = async (files: FileList | null) => {
    if (!files || files.length === 0) return;

    const newImages: string[] = [];

    // Limite au nombre d'images restantes
    const remainingSlots = maxImages - selectedImages.length;
    const filesToProcess = Math.min(files.length, remainingSlots);

    for (let i = 0; i < filesToProcess; i++) {
      const file = files[i];

      // V√©rifier que c'est bien une image
      if (!file.type.startsWith('image/')) {
        continue;
      }

      // Convertir en base64
      const base64 = await fileToBase64(file);
      newImages.push(base64);
    }

    const updatedImages = [...selectedImages, ...newImages];
    setSelectedImages(updatedImages);
    onImagesSelected(updatedImages);

    // Avertir si limite atteinte
    if (updatedImages.length >= maxImages) {
      alert(`Maximum de ${maxImages} photos atteint !`);
    }
  };

  const fileToBase64 = (file: File): Promise<string> => {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result as string);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  };

  const removeImage = (index: number) => {
    const updatedImages = selectedImages.filter((_, i) => i !== index);
    setSelectedImages(updatedImages);
    onImagesSelected(updatedImages);
  };

  const handleCameraClick = () => {
    cameraInputRef.current?.click();
  };

  const handleGalleryClick = () => {
    galleryInputRef.current?.click();
  };

  const canAddMore = selectedImages.length < maxImages;

  return (
    <div className="space-y-6">
      {/* Action Buttons */}
      {canAddMore && (
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
          {/* Bouton Cam√©ra (Mobile) */}
          <button
            type="button"
            onClick={handleCameraClick}
            className="flex flex-col items-center justify-center p-8 bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-2xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105 active:scale-95"
          >
            <Camera size={48} className="mb-3" />
            <span className="text-lg font-bold">Prendre une photo</span>
            <span className="text-sm opacity-90 mt-1">Utiliser la cam√©ra</span>
          </button>

          {/* Bouton Galerie */}
          <button
            type="button"
            onClick={handleGalleryClick}
            className="flex flex-col items-center justify-center p-8 bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white rounded-2xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105 active:scale-95"
          >
            <ImageIcon size={48} className="mb-3" />
            <span className="text-lg font-bold">Choisir des photos</span>
            <span className="text-sm opacity-90 mt-1">Depuis la galerie</span>
          </button>

          {/* Hidden inputs */}
          <input
            ref={cameraInputRef}
            type="file"
            accept="image/*"
            capture="environment"
            multiple
            onChange={(e) => handleImageSelection(e.target.files)}
            className="hidden"
          />

          <input
            ref={galleryInputRef}
            type="file"
            accept="image/*"
            multiple
            onChange={(e) => handleImageSelection(e.target.files)}
            className="hidden"
          />
        </div>
      )}

      {/* Counter */}
      <div className="text-center">
        <div className={`inline-flex items-center px-6 py-3 rounded-full font-bold text-lg ${
          selectedImages.length >= maxImages 
            ? 'bg-red-100 text-red-700' 
            : 'bg-blue-100 text-blue-700'
        }`}>
          <Upload size={20} className="mr-2" />
          {selectedImages.length} / {maxImages} photos
        </div>
      </div>

      {/* Image Preview Grid */}
      {selectedImages.length > 0 && (
        <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
          <h3 className="text-lg font-bold text-gray-900 mb-4">
            üì∏ Photos s√©lectionn√©es ({selectedImages.length})
          </h3>

          <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
            {selectedImages.map((image, index) => (
              <div key={index} className="relative group">
                <img
                  src={image}
                  alt={`Photo ${index + 1}`}
                  className="w-full h-32 object-cover rounded-lg shadow-md border-2 border-gray-200"
                />

                {/* Num√©ro de page */}
                <div className="absolute top-2 left-2 bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg">
                  {index + 1}
                </div>

                {/* Bouton supprimer */}
                <button
                  onClick={() => removeImage(index)}
                  className="absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 transform hover:scale-110"
                  title="Supprimer"
                >
                  <X size={16} />
                </button>

                {/* Overlay au hover */}
                <div className="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all rounded-lg pointer-events-none"></div>
              </div>
            ))}
          </div>

          {/* Bouton Ajouter Plus */}
          {canAddMore && (
            <div className="mt-6 flex gap-3">
              <button
                type="button"
                onClick={handleCameraClick}
                className="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 font-semibold rounded-lg transition-all border-2 border-blue-200"
              >
                <Camera size={20} />
                Ajouter (cam√©ra)
              </button>

              <button
                type="button"
                onClick={handleGalleryClick}
                className="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-purple-50 hover:bg-purple-100 text-purple-700 font-semibold rounded-lg transition-all border-2 border-purple-200"
              >
                <ImageIcon size={20} />
                Ajouter (galerie)
              </button>
            </div>
          )}
        </div>
      )}

      {/* Info message */}
      {selectedImages.length === 0 && (
        <div className="bg-blue-50 border border-blue-200 rounded-xl p-6 text-center">
          <p className="text-blue-800 font-medium mb-2">
            üì± Choisissez votre m√©thode pr√©f√©r√©e
          </p>
          <p className="text-sm text-blue-600">
            ‚Ä¢ Cam√©ra : Prenez des photos en direct<br />
            ‚Ä¢ Galerie : S√©lectionnez des photos existantes<br />
            ‚Ä¢ Maximum {maxImages} photos
          </p>
        </div>
      )}

      {/* Warning si limite atteinte */}
      {!canAddMore && (
        <div className="bg-orange-50 border border-orange-200 rounded-xl p-4 text-center">
          <p className="text-orange-800 font-medium">
            ‚ö†Ô∏è Limite de {maxImages} photos atteinte
          </p>
          <p className="text-sm text-orange-600 mt-1">
            Supprimez des photos pour en ajouter d'autres
          </p>
        </div>
      )}
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/QuizGenerator.tsx
==================================================

'use client';

import { useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { Loader2 } from 'lucide-react';
import ImageUpload from './ImageUpload';
import { generateQuizFromImage, Quiz } from '@/lib/api';
import { saveCourse } from '@/lib/courseService';

interface QuizGeneratorProps {
  onQuizGenerated: (quiz: Quiz) => void;
}

export default function QuizGenerator({ onQuizGenerated }: QuizGeneratorProps) {
  const { user } = useUser();
  const [selectedImage, setSelectedImage] = useState<string | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [numQuestions, setNumQuestions] = useState(5);
  const [difficulty, setDifficulty] = useState<'easy' | 'medium' | 'hard'>('medium');

  const handleImageSelected = (imageData: string) => {
    setSelectedImage(imageData);
    setError(null);
  };

  const handleClear = () => {
    setSelectedImage(null);
    setError(null);
  };

  const handleGenerateQuiz = async () => {
    if (!selectedImage || !user) return;

    try {
      setLoading(true);
      setError(null);

      // 1. G√©n√©rer le quiz (qui inclut le texte extrait)
      console.log('‚ú® G√©n√©ration du quiz...');
      const quiz = await generateQuizFromImage(selectedImage, numQuestions, difficulty);
      console.log('‚úÖ Quiz g√©n√©r√©');

      // 2. Sauvegarder le texte extrait
      if (quiz.extractedText) {
          console.log('üíæ Sauvegarde du cours...');

          // üëá CORRECTION ICI : On ajoute un titre g√©n√©r√© automatiquement comme 3√®me argument
          const autoTitle = `Quiz g√©n√©r√© - ${new Date().toLocaleDateString('fr-FR')}`;

          await saveCourse(user.id, quiz.extractedText, autoTitle);

          console.log('‚úÖ Cours sauvegard√©');
        }

      onQuizGenerated(quiz);
    } catch (err) {
      console.error('Erreur:', err);
      setError(err instanceof Error ? err.message : 'Erreur lors de la g√©n√©ration du quiz');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="space-y-6">
      {/* Image Upload */}
      <ImageUpload
        onImageSelected={handleImageSelected}
        selectedImage={selectedImage}
        onClear={handleClear}
      />

      {/* Settings */}
      {selectedImage && (
        <div className="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
          <h3 className="text-xl font-bold text-gray-900 mb-6">‚öôÔ∏è Param√®tres du Quiz</h3>

          {/* Number of Questions */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-3">
              Nombre de questions : <span className="text-blue-600 font-bold">{numQuestions}</span>
            </label>
            <input
              type="range"
              min="3"
              max="15"
              value={numQuestions}
              onChange={(e) => setNumQuestions(Number(e.target.value))}
              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
              disabled={loading}
            />
            <div className="flex justify-between text-xs text-gray-500 mt-1">
              <span>3</span>
              <span>15</span>
            </div>
          </div>

          {/* Difficulty */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-3">
              Difficult√©
            </label>
            <div className="flex gap-3">
              {(['easy', 'medium', 'hard'] as const).map((level) => (
                <button
                  key={level}
                  onClick={() => setDifficulty(level)}
                  disabled={loading}
                  className={`flex-1 px-4 py-3 rounded-lg font-medium transition-all transform hover:scale-105 ${
                    difficulty === level
                      ? 'bg-blue-600 text-white shadow-lg'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {level === 'easy' && 'üòä Facile'}
                  {level === 'medium' && 'üéØ Moyen'}
                  {level === 'hard' && 'üî• Difficile'}
                </button>
              ))}
            </div>
          </div>

          {/* Generate Button */}
          <button
            onClick={handleGenerateQuiz}
            disabled={loading || !user}
            className="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center space-x-2"
          >
            {loading ? (
              <>
                <Loader2 className="animate-spin" size={20} />
                <span>G√©n√©ration en cours...</span>
              </>
            ) : (
              <>
                <span>‚ú® G√©n√©rer le Quiz</span>
              </>
            )}
          </button>

          {/* Info message */}
          <p className="mt-3 text-sm text-gray-500 text-center">
            üíæ Le texte du cours sera automatiquement extrait et sauvegard√©
          </p>

          {/* Error Message */}
          {error && (
            <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
              <p className="text-sm text-red-600">‚ùå {error}</p>
            </div>
          )}
        </div>
      )}
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/CourseActions.tsx
==================================================

'use client';

import { useRouter } from 'next/navigation';
import { FileQuestion, Layers, Plus } from 'lucide-react';

interface CourseActionsProps {
  courseId: number;
  quizCount: number;
  flashcardCount: number;
}

export default function CourseActions({ courseId, quizCount, flashcardCount }: CourseActionsProps) {
  const router = useRouter();

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-semibold text-gray-900">
        üéØ G√©n√©rer depuis ce cours :
      </h3>

      <div className="grid md:grid-cols-2 gap-4">
        {/* Quiz */}
        <button
          onClick={() => router.push(`/workspace/courses/${courseId}/generate-quiz`)}
          className="group bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 border-2 border-blue-200 hover:border-blue-400 rounded-xl p-6 transition-all transform hover:scale-105"
        >
          <div className="flex items-start space-x-4">
            <div className="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0">
              <FileQuestion size={24} className="text-white" />
            </div>
            <div className="flex-1 text-left">
              <h4 className="text-lg font-bold text-gray-900 mb-1 flex items-center space-x-2">
                <span>Quiz</span>
                {quizCount > 0 && (
                  <span className="text-xs bg-blue-600 text-white px-2 py-0.5 rounded-full">
                    {quizCount}
                  </span>
                )}
              </h4>
              <p className="text-sm text-gray-600 mb-2">
                Questions √† choix multiples
              </p>
              <div className="flex items-center text-blue-600 text-sm font-semibold">
                <Plus size={16} className="mr-1" />
                <span>Cr√©er un quiz</span>
              </div>
            </div>
          </div>
        </button>

        {/* Flashcards */}
        <button
          onClick={() => router.push(`/workspace/courses/${courseId}/generate-flashcards`)}
          className="group bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 border-2 border-purple-200 hover:border-purple-400 rounded-xl p-6 transition-all transform hover:scale-105"
        >
          <div className="flex items-start space-x-4">
            <div className="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center flex-shrink-0">
              <Layers size={24} className="text-white" />
            </div>
            <div className="flex-1 text-left">
              <h4 className="text-lg font-bold text-gray-900 mb-1 flex items-center space-x-2">
                <span>Flashcards</span>
                {flashcardCount > 0 && (
                  <span className="text-xs bg-purple-600 text-white px-2 py-0.5 rounded-full">
                    {flashcardCount}
                  </span>
                )}
              </h4>
              <p className="text-sm text-gray-600 mb-2">
                Cartes de r√©vision
              </p>
              <div className="flex items-center text-purple-600 text-sm font-semibold">
                <Plus size={16} className="mr-1" />
                <span>Cr√©er des flashcards</span>
              </div>
            </div>
          </div>
        </button>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/QuizHistoryCard.tsx
==================================================

'use client';

import { useState } from 'react';
import { Calendar, Award, BookOpen, Trash2, ChevronDown, ChevronUp, RefreshCw } from 'lucide-react';

interface QuizHistoryCardProps {
  quiz: {
    id: number;
    quiz_id: string;
    score: number;
    total_questions: number;
    difficulty: string;
    source: string;
    created_at: string;
    answers: number[];
  };
  onDelete: (id: number) => void;
}

export default function QuizHistoryCard({ quiz, onDelete }: QuizHistoryCardProps) {
  const [expanded, setExpanded] = useState(false);

  const percentage = Math.round((quiz.score / quiz.total_questions) * 100);

  const getDifficultyColor = (difficulty: string) => {
    switch (difficulty) {
      case 'easy':
        return 'bg-green-100 text-green-700';
      case 'medium':
        return 'bg-yellow-100 text-yellow-700';
      case 'hard':
        return 'bg-red-100 text-red-700';
      default:
        return 'bg-gray-100 text-gray-700';
    }
  };

  const getScoreColor = (percentage: number) => {
    if (percentage >= 80) return 'text-green-600';
    if (percentage >= 60) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all">
      <div className="p-6">
        <div className="flex items-start justify-between mb-4">
          <div className="flex-1">
            <div className="flex items-center space-x-3 mb-2">
              <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                <BookOpen size={20} className="text-blue-600" />
              </div>
              <div>
                <h3 className="font-bold text-gray-900">
                  Quiz {quiz.source === 'image' ? 'üì∏' : 'üìù'}
                </h3>
                <p className="text-sm text-gray-600 flex items-center">
                  <Calendar size={14} className="mr-1" />
                  {new Date(quiz.created_at).toLocaleDateString('fr-FR', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                  })}
                </p>
              </div>
            </div>

            <div className="flex items-center space-x-2">
              <span className={`px-3 py-1 rounded-full text-xs font-semibold ${getDifficultyColor(quiz.difficulty)}`}>
                {quiz.difficulty === 'easy' && 'üòä Facile'}
                {quiz.difficulty === 'medium' && 'üéØ Moyen'}
                {quiz.difficulty === 'hard' && 'üî• Difficile'}
              </span>
              <span className="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-semibold">
                {quiz.total_questions} questions
              </span>
            </div>
          </div>

          <div className="text-right">
            <div className="flex items-center space-x-2 mb-2">
              <Award size={16} className="mr-1 text-yellow-600" />
              <span className={`text-3xl font-bold ${getScoreColor(percentage)}`}>
                {percentage}%
              </span>
            </div>
            <p className="text-sm text-gray-600">
              {quiz.score}/{quiz.total_questions}
            </p>
          </div>
        </div>

        {/* Progress Bar */}
        <div className="mb-4">
          <div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
            <div
              className={`h-3 rounded-full transition-all ${
                percentage >= 80
                  ? 'bg-green-500'
                  : percentage >= 60
                  ? 'bg-yellow-500'
                  : 'bg-red-500'
              }`}
              style={{ width: `${percentage}%` }}
            ></div>
          </div>
        </div>

        {/* Actions */}
        <div className="flex items-center justify-between">
          <button
            onClick={() => setExpanded(!expanded)}
            className="flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors"
          >
            {expanded ? (
              <>
                <ChevronUp size={18} />
                <span className="text-sm font-medium">Masquer d√©tails</span>
              </>
            ) : (
              <>
                <ChevronDown size={18} />
                <span className="text-sm font-medium">Voir d√©tails</span>
              </>
            )}
          </button>

          <div className="flex items-center space-x-2">
            <button
              onClick={() => onDelete(quiz.id)}
              className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all"
              title="Supprimer"
            >
              <Trash2 size={18} />
            </button>
          </div>
        </div>

        {/* Expanded Details */}
        {expanded && (
          <div className="mt-4 pt-4 border-t border-gray-200">
            <div className="space-y-2">
              <p className="text-sm text-gray-600">
                <strong>ID Quiz :</strong> {quiz.quiz_id.slice(0, 8)}...
              </p>
              <p className="text-sm text-gray-600">
                <strong>Source :</strong> {quiz.source === 'image' ? 'Image (OCR)' : 'Texte'}
              </p>
              <p className="text-sm text-gray-600">
                <strong>R√©ponses :</strong> {quiz.answers.length} enregistr√©es
              </p>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/LoadingFeedback.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { Star, Loader2, Check, Send, ArrowRight, Lightbulb } from 'lucide-react';
import { supabase } from '@/lib/supabase';
import { useUser } from '@clerk/nextjs';

interface Props {
  status: string; // 'uploading', 'extracting', 'saving', 'ready'
  onClose: () => void;
}

const TIPS = [
  "La r√©p√©tition espac√©e est la cl√© de la m√©morisation √† long terme.",
  "Faire un quiz juste apr√®s avoir lu un cours augmente la r√©tention de 50%.",
  "Studia utilise l'IA pour identifier les concepts cl√©s de vos images.",
  "Essayez de r√©viser vos flashcards le matin pour un cerveau plus frais.",
  "Gagnez de l'XP pour monter de niveau et d√©bloquer des fonctionnalit√©s !"
];

export default function LoadingFeedback({ status, onClose }: Props) {
  const { user } = useUser();
  const [rating, setRating] = useState(0);
  const [comment, setComment] = useState('');
  const [sent, setSent] = useState(false);
  const [hasAlreadyVoted, setHasAlreadyVoted] = useState(false);
  const [randomTip, setRandomTip] = useState("");

  const isReady = status === 'ready';

  useEffect(() => {
    // 1. Choisir une astuce al√©atoire
    setRandomTip(TIPS[Math.floor(Math.random() * TIPS.length)]);

    // 2. V√©rifier si l'utilisateur a d√©j√† vot√© (dans le navigateur)
    const voteStatus = localStorage.getItem('studia_has_voted');
    if (voteStatus === 'true') {
      setHasAlreadyVoted(true);
    }
  }, []);

  const handleSend = async () => {
    if (!user || rating === 0) return;
    try {
      await supabase.from('feedbacks').insert({
        user_id: user.id,
        rating,
        comment
      });

      setSent(true);
      // On enregistre que l'utilisateur a vot√© pour ne plus l'emb√™ter
      localStorage.setItem('studia_has_voted', 'true');

      if (isReady) {
        setTimeout(onClose, 1500);
      }
    } catch (error) {
      console.error('Erreur:', error);
    }
  };

  return (
    <div className="fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[9999] top-0 left-0 w-full h-full px-4">
      <div className="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl animate-in fade-in zoom-in duration-300 relative">

        {/* En-t√™te : √âtat du chargement */}
        <div className="flex flex-col items-center mb-6">
          {isReady ? (
            <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4 animate-bounce">
              <Check className="w-8 h-8 text-green-600" />
            </div>
          ) : (
            <Loader2 className="w-12 h-12 text-blue-600 animate-spin mb-4" />
          )}

          <h3 className="text-xl font-bold text-gray-900">
            {isReady ? "Cours g√©n√©r√© avec succ√®s !" : "IA au travail..."}
          </h3>

          {!isReady && (
            <p className="text-blue-600 font-medium animate-pulse mt-2 text-sm">
              {status === 'uploading' && "Envoi des images..."}
              {status === 'extracting' && "Analyse du texte..."}
              {status === 'saving' && "Sauvegarde..."}
            </p>
          )}
        </div>

        <hr className="border-gray-100 my-6" />

        {/* CONTENU VARIABLE : AVIS OU ASTUCE */}
        {hasAlreadyVoted && !sent ? (
          // CAS 1 : D√©j√† vot√© -> On affiche une astuce
          <div className="bg-blue-50 p-4 rounded-xl border border-blue-100">
            <div className="flex items-center gap-2 mb-2 text-blue-700 font-bold">
              <Lightbulb size={20} />
              <span>Le saviez-vous ?</span>
            </div>
            <p className="text-blue-800 text-sm leading-relaxed">
              {randomTip}
            </p>
          </div>
        ) : (
          // CAS 2 : Pas encore vot√© -> On affiche le formulaire
          !sent ? (
            <div className="text-center">
              <p className="text-gray-600 mb-4 font-medium">
                En attendant, notez votre exp√©rience :
              </p>
              <div className="flex justify-center gap-2 mb-4">
                {[1, 2, 3, 4, 5].map((star) => (
                  <button
                    key={star}
                    onClick={() => setRating(star)}
                    className="hover:scale-110 transition-transform focus:outline-none"
                  >
                    <Star
                      size={32}
                      className={`${rating >= star ? 'fill-yellow-400 text-yellow-400' : 'text-gray-200'} transition-colors`}
                    />
                  </button>
                ))}
              </div>
              <div className="flex gap-2 relative">
                <input
                  type="text"
                  placeholder="Un commentaire ?"
                  className="flex-1 bg-gray-50 border rounded-lg px-4 py-3 text-sm text-gray-900 outline-none focus:ring-2 focus:ring-blue-500"
                  value={comment}
                  onChange={(e) => setComment(e.target.value)}
                />
                <button
                  onClick={handleSend}
                  disabled={rating === 0}
                  className="bg-blue-600 text-white p-3 rounded-lg disabled:opacity-50 hover:bg-blue-700 transition-colors"
                >
                  <Send size={18} />
                </button>
              </div>
            </div>
          ) : (
            <div className="bg-green-50 text-green-700 p-4 rounded-lg flex items-center justify-center gap-2 text-center">
              <Check size={20} /> <span>Merci pour votre retour !</span>
            </div>
          )
        )}

        {/* Bouton d'acc√®s au cours (quand pr√™t) */}
        {isReady && (
          <div className="mt-8 pt-6 border-t border-gray-100 animate-in fade-in slide-in-from-bottom-4">
            <button
              onClick={onClose}
              className="w-full bg-green-600 text-white font-bold py-4 px-6 rounded-xl hover:bg-green-700 transition-all shadow-lg flex items-center justify-center gap-2"
            >
              <span>Acc√©der √† mon cours</span>
              <ArrowRight size={20} />
            </button>
          </div>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/QuizResults.tsx
==================================================

'use client';

import { useEffect, useRef } from 'react';
import { CheckCircle, XCircle, RotateCcw, Plus } from 'lucide-react';
import { Quiz } from '@/lib/api';
import { useUser } from '@clerk/nextjs';
// üëá Import de la gamification
import { addXp } from '@/lib/gamificationService';

interface QuizResultsProps {
  quiz: Quiz;
  userAnswers: number[];
  onRetake: () => void;
  onNewQuiz: () => void;
}

export default function QuizResults({
  quiz,
  userAnswers,
  onRetake,
  onNewQuiz,
}: QuizResultsProps) {
  const { user } = useUser();
  const hasAddedXp = useRef(false); // Pour √©viter de donner l'XP en double

  // Calcul du score
  const score = userAnswers.reduce((acc, answer, index) => {
    return acc + (answer === quiz.questions[index].correctAnswer ? 1 : 0);
  }, 0);

  const percentage = Math.round((score / quiz.questions.length) * 100);

  // üéâ EFFET : Donner l'XP au chargement du r√©sultat
  useEffect(() => {
    const giveRewards = async () => {
      if (user && !hasAddedXp.current) {
        hasAddedXp.current = true;

        // Formule : 10 XP de base + le pourcentage de r√©ussite
        // Ex: 100% = 110 XP | 50% = 60 XP
        const xpAmount = 10 + percentage;

        await addXp(user.id, xpAmount, `Quiz termin√© (${percentage}%)`);
      }
    };
    giveRewards();
  }, [user, percentage]);

  return (
    <div className="bg-white rounded-2xl shadow-xl p-8 border border-gray-100 animate-in fade-in slide-in-from-bottom-4">
      <div className="text-center mb-8">
        <div className="inline-flex items-center justify-center w-24 h-24 rounded-full bg-blue-50 mb-4 relative">
          <span className="text-4xl font-bold text-blue-600">{percentage}%</span>
          {/* Badge XP */}
          <div className="absolute -right-2 -top-2 bg-yellow-400 text-white text-xs font-bold px-2 py-1 rounded-full shadow-sm animate-bounce">
            +{10 + percentage} XP
          </div>
        </div>
        <h2 className="text-3xl font-bold text-gray-900 mb-2">
          {percentage >= 80 ? 'Excellent ! üéâ' : percentage >= 50 ? 'Bien jou√© ! üëç' : 'Courage ! üí™'}
        </h2>
        <p className="text-gray-600">
          Vous avez eu {score} bonnes r√©ponses sur {quiz.questions.length}
        </p>
      </div>

      <div className="space-y-6 mb-8">
        {quiz.questions.map((q, index) => {
          const isCorrect = userAnswers[index] === q.correctAnswer;
          return (
            <div
              key={index}
              className={`p-4 rounded-xl border-l-4 ${
                isCorrect
                  ? 'bg-green-50 border-green-500'
                  : 'bg-red-50 border-red-500'
              }`}
            >
              <div className="flex items-start gap-3">
                <div className="mt-1">
                  {isCorrect ? (
                    <CheckCircle className="text-green-600" size={20} />
                  ) : (
                    <XCircle className="text-red-600" size={20} />
                  )}
                </div>
                <div>
                  <p className="font-medium text-gray-900 mb-2">{q.question}</p>
                  <p className="text-sm text-gray-600">
                    Votre r√©ponse : <span className={isCorrect ? 'text-green-700 font-semibold' : 'text-red-700 font-semibold'}>
                      {q.options[userAnswers[index]]}
                    </span>
                  </p>
                  {!isCorrect && (
                    <p className="text-sm text-green-700 mt-1">
                      Bonne r√©ponse : <span className="font-semibold">{q.options[q.correctAnswer]}</span>
                    </p>
                  )}
                  <p className="text-xs text-gray-500 mt-2 italic border-t border-gray-200/50 pt-2">
                    ‚ÑπÔ∏è {q.explanation}
                  </p>
                </div>
              </div>
            </div>
          );
        })}
      </div>

      <div className="flex flex-col sm:flex-row gap-4 justify-center">
        <button
          onClick={onRetake}
          className="flex items-center justify-center space-x-2 px-6 py-3 bg-gray-100 text-gray-700 rounded-xl font-semibold hover:bg-gray-200 transition-all"
        >
          <RotateCcw size={20} />
          <span>R√©essayer</span>
        </button>
        <button
          onClick={onNewQuiz}
          className="flex items-center justify-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl"
        >
          <Plus size={20} />
          <span>Nouveau Quiz</span>
        </button>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/WorkspaceNavbar.tsx
==================================================

'use client';

import { useState } from 'react';
import { useUser, UserButton } from '@clerk/nextjs';
import Link from 'next/link';
import { BookOpen, Home, BarChart3, Menu, X, LogOut } from 'lucide-react';
import XpBar from './XpBar'; // Assurez-vous que l'import est correct

export default function WorkspaceNavbar() {
  const { user } = useUser();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

  const handleSignOut = () => {
    window.location.href = '/';
  };

  return (
    <nav className="sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-200 shadow-sm">
      <div className="px-4 py-3 flex items-center justify-between max-w-7xl mx-auto">
        {/* Logo */}
        <Link href="/workspace" className="flex items-center space-x-3 hover:opacity-80 transition-opacity">
          <div className="w-9 h-9 sm:w-10 sm:h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
            <BookOpen className="text-white" size={20} />
          </div>
          <div>
            <h1 className="text-lg sm:text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
              Studia
            </h1>
            <p className="text-[10px] sm:text-xs text-gray-500 leading-none">
              AI Learning
            </p>
          </div>
        </Link>

        {/* Desktop Navigation + XP + Profile */}
        <div className="hidden md:flex items-center space-x-4"> {/* space-x-4 espacer les √©l√©ments */}

          <Link
            href="/"
            className="flex items-center space-x-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-all text-sm font-medium"
          >
            <Home size={18} />
            <span>Accueil</span>
          </Link>

          <Link
            href="/workspace/stats"
            className="flex items-center space-x-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-all text-sm font-medium"
          >
            <BarChart3 size={18} />
            <span>Stats</span>
          </Link>

          {/* Zone Droite : XP + UserButton */}
          <div className="flex items-center gap-3 pl-4 border-l border-gray-200 ml-2">
            {/* Barre d'XP */}
            <XpBar />

            {/* User Button */}
            <UserButton afterSignOutUrl="/" />
          </div>

        </div>

        {/* Mobile Menu Button */}
        <button
          onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
          className="md:hidden p-2 -mr-2 text-gray-700 active:bg-gray-100 rounded-lg transition-all"
          aria-label="Menu"
        >
          {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
        </button>
      </div>

      {/* Mobile Menu */}
      {mobileMenuOpen && (
        <div className="md:hidden border-t border-gray-200 bg-white">
          <div className="p-4 space-y-2">
            {/* XP Bar visible en mobile en haut du menu */}
            <div className="flex justify-center mb-4">
               <XpBar />
            </div>

            <Link
              href="/"
              onClick={() => setMobileMenuOpen(false)}
              className="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg transition-all"
            >
              <Home size={20} />
              <span className="font-medium">Accueil</span>
            </Link>

            <Link
              href="/workspace/stats"
              onClick={() => setMobileMenuOpen(false)}
              className="flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg transition-all"
            >
              <BarChart3 size={20} />
              <span className="font-medium">Statistiques</span>
            </Link>

            <button
              onClick={() => {
                setMobileMenuOpen(false);
                handleSignOut();
              }}
              className="w-full flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-all"
            >
              <LogOut size={20} />
              <span className="font-medium">D√©connexion</span>
            </button>

            <div className="pt-4 flex items-center justify-center space-x-3 px-4 border-t border-gray-100 mt-2">
              <UserButton afterSignOutUrl="/" />
              <span className="text-sm text-gray-600 font-medium">
                {user?.firstName || user?.emailAddresses[0]?.emailAddress}
              </span>
            </div>
          </div>
        </div>
      )}
    </nav>
  );
}

==================================================
FICHIER : frontend/components/workspace/FlashcardViewer.tsx
==================================================

'use client';

import { useState, useEffect, useRef } from 'react';
import { ChevronLeft, ChevronRight, RotateCcw, CheckCircle, XCircle } from 'lucide-react';
import { Flashcard } from '@/lib/flashcardService';
import { useUser } from '@clerk/nextjs';
// üëá Import XP
import { addXp } from '@/lib/gamificationService';

interface FlashcardViewerProps {
  flashcards: Flashcard[];
  onProgress?: (cardIndex: number, remembered: boolean) => void;
}

export default function FlashcardViewer({ flashcards, onProgress }: FlashcardViewerProps) {
  const { user } = useUser();
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isFlipped, setIsFlipped] = useState(false);
  const [reviewedCards, setReviewedCards] = useState<Set<number>>(new Set());
  const [knownCards, setKnownCards] = useState<Set<number>>(new Set());
  const [toReviewCards, setToReviewCards] = useState<Set<number>>(new Set());
  const [finished, setFinished] = useState(false);
  const [reviewMode, setReviewMode] = useState(false);
  const [reviewOnlyIndices, setReviewOnlyIndices] = useState<number[]>([]);

  const hasAddedXp = useRef(false); // Anti-doublon XP

  // D√©terminer les cartes actives selon le mode
  const activeIndices = reviewMode ? reviewOnlyIndices : flashcards.map((_, i) => i);
  const currentCard = flashcards[activeIndices[currentIndex]];
  const totalCards = activeIndices.length;
  const reviewedCount = reviewedCards.size;
  const progress = Math.round((reviewedCount / totalCards) * 100);

  // Support swipe sur mobile
  useEffect(() => {
    let touchStartX = 0;
    let touchEndX = 0;

    const handleTouchStart = (e: TouchEvent) => {
      touchStartX = e.changedTouches[0].screenX;
    };

    const handleTouchEnd = (e: TouchEvent) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    };

    const handleSwipe = () => {
      if (touchEndX < touchStartX - 50 && currentIndex < activeIndices.length - 1) {
        handleNext();
      }
      if (touchEndX > touchStartX + 50 && currentIndex > 0) {
        handlePrevious();
      }
    };

    document.addEventListener('touchstart', handleTouchStart);
    document.addEventListener('touchend', handleTouchEnd);

    return () => {
      document.removeEventListener('touchstart', handleTouchStart);
      document.removeEventListener('touchend', handleTouchEnd);
    };
  }, [currentIndex, activeIndices]);

  // üéâ EFFET : Donner XP √† la fin
  useEffect(() => {
    const giveRewards = async () => {
      if (finished && user && !hasAddedXp.current) {
        hasAddedXp.current = true;
        const knownCount = knownCards.size;

        // Formule : 5 XP par carte connue + 10 XP bonus de fin
        const xpAmount = 10 + (knownCount * 5);

        await addXp(user.id, xpAmount, 'Session Flashcards termin√©e');
      }
    };
    giveRewards();
  }, [finished, user, knownCards]);

  const handleNext = () => {
    setIsFlipped(false);
    if (currentIndex < activeIndices.length - 1) {
      setCurrentIndex(currentIndex + 1);
    } else {
      setFinished(true);
    }
  };

  const handlePrevious = () => {
    setIsFlipped(false);
    if (currentIndex > 0) {
      setCurrentIndex(currentIndex - 1);
    }
  };

  const handleRemembered = (remembered: boolean) => {
    const actualCardIndex = activeIndices[currentIndex];

    if (onProgress) {
      onProgress(actualCardIndex, remembered);
    }

    const newReviewed = new Set(reviewedCards);
    newReviewed.add(actualCardIndex);
    setReviewedCards(newReviewed);

    if (remembered) {
      const newKnown = new Set(knownCards);
      newKnown.add(actualCardIndex);
      setKnownCards(newKnown);
      const newToReview = new Set(toReviewCards);
      newToReview.delete(actualCardIndex);
      setToReviewCards(newToReview);
    } else {
      const newToReview = new Set(toReviewCards);
      newToReview.add(actualCardIndex);
      setToReviewCards(newToReview);
      const newKnown = new Set(knownCards);
      newKnown.delete(actualCardIndex);
      setKnownCards(newKnown);
    }

    handleNext();
  };

  const handleReset = () => {
    hasAddedXp.current = false; // Reset XP flag pour nouvelle session
    setCurrentIndex(0);
    setIsFlipped(false);
    setReviewedCards(new Set());
    setKnownCards(new Set());
    setToReviewCards(new Set());
    setFinished(false);
    setReviewMode(false);
    setReviewOnlyIndices([]);
  };

  const handleReviewAgain = () => {
    if (toReviewCards.size === 0) {
      handleReset();
      return;
    }
    hasAddedXp.current = false; // Reset XP flag
    const toReviewIndices = Array.from(toReviewCards).sort((a, b) => a - b);
    setReviewMode(true);
    setReviewOnlyIndices(toReviewIndices);
    setCurrentIndex(0);
    setReviewedCards(new Set());
    setKnownCards(new Set());
    setToReviewCards(new Set());
    setFinished(false);
    setIsFlipped(false);
  };

  // √âcran de fin
  if (finished) {
    const knownCount = knownCards.size;
    const toReviewCount = toReviewCards.size;
    const successRate = totalCards > 0 ? Math.round((knownCount / totalCards) * 100) : 0;
    const xpEarned = 10 + (knownCount * 5); // Juste pour l'affichage

    return (
      <div className="max-w-2xl mx-auto px-4 sm:px-0">
        <div className="bg-white rounded-2xl shadow-2xl p-8 sm:p-12 text-center border-4 border-green-200 relative overflow-hidden">

          {/* Badge XP Gagn√© */}
          <div className="absolute top-4 right-4 bg-yellow-400 text-white font-bold px-3 py-1 rounded-full shadow-lg animate-pulse">
            +{xpEarned} XP
          </div>

          <div className="w-20 h-20 sm:w-24 sm:h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <CheckCircle className="text-green-600 w-12 h-12 sm:w-16 sm:h-16" />
          </div>

          <h2 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-4">
            üéâ Session Termin√©e !
          </h2>

          <div className="grid grid-cols-2 gap-4 sm:gap-6 mb-8">
            <div className="bg-green-50 rounded-xl p-5 sm:p-6 border-2 border-green-200">
              <div className="text-3xl sm:text-4xl font-bold text-green-600 mb-2">
                {knownCount}
              </div>
              <div className="text-xs sm:text-sm text-green-800 font-semibold">
                ‚úÖ Cartes Connues
              </div>
            </div>

            <div className="bg-orange-50 rounded-xl p-5 sm:p-6 border-2 border-orange-200">
              <div className="text-3xl sm:text-4xl font-bold text-orange-600 mb-2">
                {toReviewCount}
              </div>
              <div className="text-xs sm:text-sm text-orange-800 font-semibold">
                üîÑ √Ä Revoir
              </div>
            </div>
          </div>

          <div className="mb-8">
            <div className="text-4xl sm:text-5xl font-bold text-gray-900 mb-2">
              {successRate}%
            </div>
            <div className="text-gray-600">Taux de r√©ussite</div>
          </div>

          <div className="space-y-3">
            {toReviewCount > 0 && (
              <button
                onClick={handleReviewAgain}
                className="w-full px-6 sm:px-8 py-3.5 sm:py-4 bg-orange-600 text-white rounded-xl font-bold hover:bg-orange-700 active:scale-95 transition-all shadow-lg touch-manipulation"
              >
                üîÑ R√©viser les {toReviewCount} cartes √† revoir
              </button>
            )}

            <button
              onClick={handleReset}
              className="w-full px-6 sm:px-8 py-3.5 sm:py-4 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 active:scale-95 transition-all shadow-lg touch-manipulation"
            >
              ‚Üª Recommencer tout le deck
            </button>
          </div>
        </div>
      </div>
    );
  }

  if (!currentCard) {
    return (
      <div className="text-center p-12">
        <p className="text-gray-600">Aucune flashcard disponible</p>
      </div>
    );
  }

  return (
    <div className="max-w-2xl mx-auto px-4 sm:px-0">
      {/* Mode Indicator */}
      {reviewMode && (
        <div className="mb-4 text-center">
          <span className="inline-block px-4 py-2 bg-orange-100 text-orange-700 rounded-lg font-semibold text-sm border border-orange-200">
            üîÑ Mode R√©vision ‚Ä¢ {totalCards} cartes √† revoir
          </span>
        </div>
      )}

      {/* Progress */}
      <div className="mb-6">
        <div className="flex items-center justify-between mb-2">
          <span className="text-xs sm:text-sm font-medium text-gray-600">
            Carte {currentIndex + 1} sur {totalCards}
          </span>
          <span className="text-xs sm:text-sm font-medium text-blue-600">
            {reviewedCount}/{totalCards} ({progress}%)
          </span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-2">
          <div
            className="bg-blue-600 h-2 rounded-full transition-all duration-300"
            style={{ width: `${progress}%` }}
          />
        </div>
      </div>

      {/* Category Badge */}
      <div className="mb-4 text-center">
        <span className="inline-block px-3 py-1 bg-purple-100 text-purple-700 text-xs sm:text-sm font-semibold rounded-full border border-purple-200">
          {currentCard.category}
        </span>
      </div>

      {/* Card */}
      <div className="perspective-1000">
        <div
          className={`relative w-full h-[400px] sm:h-96 transition-transform duration-500 transform-style-3d cursor-pointer ${
            isFlipped ? 'rotate-y-180' : ''
          }`}
          onClick={() => setIsFlipped(!isFlipped)}
        >
          {/* Front */}
          <div className="absolute w-full h-full backface-hidden">
            <div className="bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl sm:rounded-3xl shadow-2xl p-6 sm:p-8 h-full flex flex-col items-center justify-center text-white">
              <p className="text-xs sm:text-sm uppercase tracking-wide mb-4 opacity-80">
                Question
              </p>
              <h2 className="text-xl sm:text-2xl md:text-3xl font-bold text-center mb-6 sm:mb-8 px-2 leading-relaxed">
                {currentCard.front}
              </h2>
              <p className="text-xs sm:text-sm opacity-80 mt-auto">
                üëÜ Appuyez pour voir la r√©ponse
              </p>
            </div>
          </div>

          {/* Back */}
          <div className="absolute w-full h-full backface-hidden rotate-y-180">
            <div className="bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl sm:rounded-3xl shadow-2xl p-6 sm:p-8 h-full flex flex-col items-center justify-center text-white">
              <p className="text-xs sm:text-sm uppercase tracking-wide mb-4 opacity-80">
                R√©ponse
              </p>
              <div className="text-base sm:text-lg md:text-xl text-center mb-6 sm:mb-8 px-2 leading-relaxed">
                {currentCard.back}
              </div>

              {!reviewedCards.has(activeIndices[currentIndex]) && (
                <div className="flex gap-3 sm:gap-4 mt-auto w-full px-2">
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      handleRemembered(false);
                    }}
                    className="flex-1 flex items-center justify-center space-x-2 px-4 sm:px-6 py-3.5 sm:py-4 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white rounded-xl sm:rounded-2xl font-bold transition-all active:scale-95 shadow-lg text-sm sm:text-base touch-manipulation"
                  >
                    <XCircle size={20} />
                    <span>√Ä revoir</span>
                  </button>
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      handleRemembered(true);
                    }}
                    className="flex-1 flex items-center justify-center space-x-2 px-4 sm:px-6 py-3.5 sm:py-4 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white rounded-xl sm:rounded-2xl font-bold transition-all active:scale-95 shadow-lg text-sm sm:text-base touch-manipulation"
                  >
                    <CheckCircle size={20} />
                    <span>Je sais</span>
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>

      {/* Navigation */}
      <div className="flex items-center justify-between mt-6">
        <button
          onClick={handlePrevious}
          disabled={currentIndex === 0}
          className="flex items-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-3 text-gray-600 hover:text-gray-900 active:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed transition-all rounded-xl font-medium touch-manipulation"
        >
          <ChevronLeft size={24} />
          <span className="hidden sm:inline">Pr√©c√©dent</span>
        </button>

        <button
          onClick={handleReset}
          className="flex items-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-3 text-gray-600 hover:text-gray-900 active:bg-gray-100 transition-all rounded-xl font-medium touch-manipulation"
        >
          <RotateCcw size={20} />
          <span className="hidden sm:inline">Reset</span>
        </button>

        <button
          onClick={handleNext}
          disabled={currentIndex === activeIndices.length - 1}
          className="flex items-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-3 text-gray-600 hover:text-gray-900 active:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed transition-all rounded-xl font-medium touch-manipulation"
        >
          <span className="hidden sm:inline">Suivant</span>
          <ChevronRight size={24} />
        </button>
      </div>

      <style jsx>{`
        .perspective-1000 {
          perspective: 1000px;
        }
        .transform-style-3d {
          transform-style: preserve-3d;
        }
        .backface-hidden {
          backface-visibility: hidden;
        }
        .rotate-y-180 {
          transform: rotateY(180deg);
        }
      `}</style>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/OfflineIndicator.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { WifiOff, Wifi } from 'lucide-react';

export default function OfflineIndicator() {
  const [isOnline, setIsOnline] = useState(true);
  const [showNotification, setShowNotification] = useState(false);

  useEffect(() => {
    setIsOnline(navigator.onLine);

    const handleOnline = () => {
      setIsOnline(true);
      setShowNotification(true);
      setTimeout(() => setShowNotification(false), 3000);
    };

    const handleOffline = () => {
      setIsOnline(false);
      setShowNotification(true);
    };

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  if (!showNotification) return null;

  return (
    <div className="fixed top-20 left-1/2 -translate-x-1/2 z-50 animate-slide-down">
      <div className={`px-6 py-3 rounded-full shadow-2xl flex items-center space-x-3 ${
        isOnline
          ? 'bg-green-600 text-white'
          : 'bg-red-600 text-white'
      }`}>
        {isOnline ? (
          <>
            <Wifi size={20} />
            <span className="font-semibold">Connexion r√©tablie</span>
          </>
        ) : (
          <>
            <WifiOff size={20} />
            <span className="font-semibold">Mode Hors ligne</span>
          </>
        )}
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/components/workspace/GlobalSearch.tsx
==================================================

'use client';

import { useState, useEffect } from 'react';
import { useUser } from '@clerk/nextjs';
import { useRouter } from 'next/navigation';
import { supabase } from '@/lib/supabase';
import { Search, X, BookOpen, Layers, FileQuestion } from 'lucide-react';

interface SearchResult {
  type: 'course' | 'deck' | 'quiz';
  id: number;
  title: string;
  preview: string;
  date: string;
}

export default function GlobalSearch() {
  const { user } = useUser();
  const router = useRouter();
  const [isOpen, setIsOpen] = useState(false);
  const [query, setQuery] = useState('');
  const [results, setResults] = useState<SearchResult[]>([]);
  const [loading, setLoading] = useState(false);

  // Raccourci clavier Cmd+K / Ctrl+K
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault();
        setIsOpen(true);
      }
      if (e.key === 'Escape') {
        setIsOpen(false);
      }
    };

    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, []);

  useEffect(() => {
    if (query.length < 2) {
      setResults([]);
      return;
    }

    const searchTimeout = setTimeout(() => {
      performSearch();
    }, 300);

    return () => clearTimeout(searchTimeout);
  }, [query, user]);

  const performSearch = async () => {
    if (!user) return;

    setLoading(true);

    try {
      const searchQuery = `%${query}%`;

      // Recherche dans les cours
      const { data: courses } = await supabase
        .from('courses')
        .select('id, title, extracted_text, created_at')
        .eq('user_id', user.id)
        .or(`title.ilike.${searchQuery},extracted_text.ilike.${searchQuery}`)
        .limit(5);

      // Recherche dans les flashcards
      const { data: decks } = await supabase
        .from('flashcard_decks')
        .select('id, title, flashcards, created_at')
        .eq('user_id', user.id)
        .ilike('title', searchQuery)
        .limit(5);

      const allResults: SearchResult[] = [
        ...(courses || []).map(c => ({
          type: 'course' as const,
          id: c.id,
          title: c.title,
          preview: c.extracted_text.substring(0, 100),
          date: c.created_at
        })),
        ...(decks || []).map(d => ({
          type: 'deck' as const,
          id: d.id,
          title: d.title,
          preview: `${d.flashcards.length} cartes`,
          date: d.created_at
        }))
      ];

      setResults(allResults);

    } catch (error) {
      console.error('Erreur recherche:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleResultClick = (result: SearchResult) => {
    if (result.type === 'course') {
      router.push(`/workspace/courses/${result.id}`);
    } else if (result.type === 'deck') {
      router.push(`/workspace/flashcards/${result.id}`);
    }
    setIsOpen(false);
    setQuery('');
  };

  if (!isOpen) {
    return (
      <button
        onClick={() => setIsOpen(true)}
        className="fixed bottom-6 right-6 z-50 w-14 h-14 bg-blue-600 text-white rounded-full shadow-2xl hover:bg-blue-700 transition-all transform hover:scale-110 flex items-center justify-center"
      >
        <Search size={24} />
      </button>
    );
  }

  return (
    <>
      {/* Overlay */}
      <div
        className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50"
        onClick={() => setIsOpen(false)}
      />

      {/* Search Modal */}
      <div className="fixed top-20 left-1/2 -translate-x-1/2 z-50 w-full max-w-2xl px-4">
        <div className="bg-white rounded-2xl shadow-2xl overflow-hidden">
          {/* Search Input */}
          <div className="flex items-center px-6 py-4 border-b border-gray-200">
            <Search size={20} className="text-gray-400 mr-3" />
            <input
              type="text"
              value={query}
              onChange={(e) => setQuery(e.target.value)}
              placeholder="Rechercher dans vos cours, flashcards..."
              className="flex-1 text-lg outline-none"
              autoFocus
            />
            <button
              onClick={() => setIsOpen(false)}
              className="ml-3 p-2 hover:bg-gray-100 rounded-lg transition-colors"
            >
              <X size={20} className="text-gray-400" />
            </button>
          </div>

          {/* Results */}
          <div className="max-h-96 overflow-y-auto">
            {loading ? (
              <div className="p-8 text-center text-gray-500">
                <div className="animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent mx-auto"></div>
              </div>
            ) : results.length === 0 && query.length >= 2 ? (
              <div className="p-8 text-center text-gray-500">
                Aucun r√©sultat pour "{query}"
              </div>
            ) : (
              <div className="p-2">
                {results.map((result, idx) => (
                  <button
                    key={idx}
                    onClick={() => handleResultClick(result)}
                    className="w-full flex items-start space-x-4 p-4 hover:bg-gray-50 rounded-xl transition-colors text-left"
                  >
                    <div className={`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${
                      result.type === 'course' ? 'bg-blue-100' :
                      result.type === 'deck' ? 'bg-purple-100' : 'bg-green-100'
                    }`}>
                      {result.type === 'course' && <BookOpen size={20} className="text-blue-600" />}
                      {result.type === 'deck' && <Layers size={20} className="text-purple-600" />}
                      {result.type === 'quiz' && <FileQuestion size={20} className="text-green-600" />}
                    </div>
                    <div className="flex-1 min-w-0">
                      <p className="font-semibold text-gray-900 truncate">{result.title}</p>
                      <p className="text-sm text-gray-500 truncate">{result.preview}</p>
                    </div>
                    <span className="text-xs text-gray-400">
                      {new Date(result.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' })}
                    </span>
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Footer */}
          <div className="px-6 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between text-xs text-gray-500">
            <span>Tapez pour rechercher</span>
            <span className="flex items-center space-x-2">
              <kbd className="px-2 py-1 bg-white border border-gray-300 rounded">‚åòK</kbd>
              <span>pour ouvrir</span>
            </span>
          </div>
        </div>
      </div>
    </>
  );
}

==================================================
FICHIER : frontend/components/workspace/XpBar.tsx
==================================================

'use client';

import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';
import { getUserProgress, UserProgress } from '@/lib/gamificationService';
import { Zap } from 'lucide-react';

export default function XpBar() {
  const { user } = useUser();
  const [progress, setProgress] = useState<UserProgress | null>(null);

  // Fonction de chargement
  const loadProgress = async () => {
    if (!user) return;
    const data = await getUserProgress(user.id);
    setProgress(data);
  };

  useEffect(() => {
    if (user) {
      // 1. Chargement initial
      loadProgress();

      // 2. √âcouter l'√©v√©nement de mise √† jour
      const handleUpdate = () => {
        console.log("üîÑ Mise √† jour XP d√©tect√©e !");
        loadProgress();
      };

      window.addEventListener('xp-updated', handleUpdate);

      // 3. Nettoyage
      return () => {
        window.removeEventListener('xp-updated', handleUpdate);
      };
    }
  }, [user]);

  if (!progress) return null;

  return (
    <div className="hidden md:flex items-center gap-3 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-200 mr-4 shadow-sm hover:shadow-md transition-shadow">
      <div className="flex flex-col items-end">
        <span className="text-xs font-bold text-gray-900 leading-none">
          Niv. {progress.level}
        </span>
        <span className="text-[10px] text-gray-500 leading-none font-medium text-blue-600">
          {progress.xp} XP
        </span>
      </div>

      {/* Cercle de progression */}
      <div className="relative w-9 h-9 flex items-center justify-center group cursor-help">
        <svg className="w-full h-full transform -rotate-90">
          {/* Fond du cercle */}
          <circle
            cx="18"
            cy="18"
            r="15"
            stroke="currentColor"
            strokeWidth="3"
            fill="transparent"
            className="text-gray-200"
          />
          {/* Barre de progression */}
          <circle
            cx="18"
            cy="18"
            r="15"
            stroke="currentColor"
            strokeWidth="3"
            fill="transparent"
            strokeDasharray={94} // 2 * PI * 15
            strokeDashoffset={94 - (94 * progress.progress_percent) / 100}
            strokeLinecap="round"
            className="text-yellow-500 transition-all duration-1000 ease-out"
          />
        </svg>
        <Zap size={14} className="absolute text-yellow-600 fill-yellow-600 group-hover:scale-110 transition-transform" />

        {/* Tooltip simple au survol */}
        <div className="absolute top-10 right-0 bg-gray-900 text-white text-xs p-2 rounded w-32 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50 text-center">
          Prochain niveau dans {progress.next_level_xp - progress.xp} XP
        </div>
      </div>
    </div>
  );
}

==================================================
FICHIER : frontend/public/offline.html
==================================================

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Studia - Hors ligne</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: white;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 500px;
    }
    .icon {
      font-size: 80px;
      margin-bottom: 20px;
    }
    h1 {
      font-size: 32px;
      margin-bottom: 16px;
    }
    p {
      font-size: 18px;
      opacity: 0.9;
      margin-bottom: 30px;
    }
    button {
      background: white;
      color: #667eea;
      border: none;
      padding: 16px 32px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.05);
    }
    button:active {
      transform: scale(0.95);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="icon">üì°</div>
    <h1>Vous √™tes hors ligne</h1>
    <p>Pas de connexion internet. V√©rifiez votre r√©seau et r√©essayez.</p>
    <button onclick="window.location.reload()">
      üîÑ R√©essayer
    </button>
  </div>
</body>
</html>

==================================================
FICHIER : frontend/public/manifest.json
==================================================

{
  "name": "Studia - AI Learning Platform",
  "short_name": "Studia",
  "description": "AI-powered learning with flashcards, quiz, and smart notes",
  "start_url": "/workspace",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#3b82f6",
  "orientation": "portrait",
  "icons": [
    {
      "src": "/icons/icon-72x72.png",
      "sizes": "72x72",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-96x96.png",
      "sizes": "96x96",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-128x128.png",
      "sizes": "128x128",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-144x144.png",
      "sizes": "144x144",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-152x152.png",
      "sizes": "152x152",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-384x384.png",
      "sizes": "384x384",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ],
  "categories": ["education", "productivity"],
  "shortcuts": [
    {
      "name": "Quiz",
      "url": "/workspace/quiz",
      "description": "Generate a new quiz"
    },
    {
      "name": "Flashcards",
      "url": "/workspace/flashcards",
      "description": "Review flashcards"
    },
    {
      "name": "Capture",
      "url": "/workspace/capture",
      "description": "Capture a new course"
    }
  ]
}

==================================================
FICHIER : frontend/public/sw.js
==================================================

const CACHE_NAME = 'studia-v1';
const OFFLINE_URL = '/offline.html';

const STATIC_ASSETS = [
  '/',
  '/workspace',
  '/offline.html',
  '/manifest.json',
  '/icons/icon-192x192.png',
  '/icons/icon-512x512.png'
];

// Install event
self.addEventListener('install', (event) => {
  console.log('[SW] Installing service worker...');

  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      console.log('[SW] Caching static assets');
      return cache.addAll(STATIC_ASSETS);
    })
  );

  self.skipWaiting();
});

// Activate event
self.addEventListener('activate', (event) => {
  console.log('[SW] Activating service worker...');

  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames.map((cacheName) => {
          if (cacheName !== CACHE_NAME) {
            console.log('[SW] Deleting old cache:', cacheName);
            return caches.delete(cacheName);
          }
        })
      );
    })
  );

  self.clients.claim();
});

// Fetch event - Network first, then cache
self.addEventListener('fetch', (event) => {
  const { request } = event;
  const url = new URL(request.url);

  // Skip cross-origin requests
  if (url.origin !== location.origin) return;

  // API requests - Network only
  if (url.pathname.startsWith('/api/')) {
    event.respondWith(
      fetch(request).catch(() => {
        return new Response(
          JSON.stringify({ error: 'Offline', offline: true }),
          {
            status: 503,
            headers: { 'Content-Type': 'application/json' }
          }
        );
      })
    );
    return;
  }

  // HTML requests - Network first, fallback to cache
  if (request.headers.get('accept')?.includes('text/html')) {
    event.respondWith(
      fetch(request)
        .then((response) => {
          const clonedResponse = response.clone();
          caches.open(CACHE_NAME).then((cache) => {
            cache.put(request, clonedResponse);
          });
          return response;
        })
        .catch(() => {
          return caches.match(request).then((response) => {
            return response || caches.match(OFFLINE_URL);
          });
        })
    );
    return;
  }

  // Other requests - Cache first, fallback to network
  event.respondWith(
    caches.match(request).then((response) => {
      return (
        response ||
        fetch(request).then((response) => {
          const clonedResponse = response.clone();
          caches.open(CACHE_NAME).then((cache) => {
            cache.put(request, clonedResponse);
          });
          return response;
        })
      );
    })
  );
});

// Background Sync
self.addEventListener('sync', (event) => {
  console.log('[SW] Background sync:', event.tag);

  if (event.tag === 'sync-data') {
    event.waitUntil(syncData());
  }
});

async function syncData() {
  try {
    // Get pending actions from IndexedDB
    const db = await openDB();
    const tx = db.transaction('pendingActions', 'readonly');
    const store = tx.objectStore('pendingActions');
    const actions = await store.getAll();

    for (const action of actions) {
      try {
        await fetch(action.url, {
          method: action.method,
          headers: action.headers,
          body: JSON.stringify(action.data)
        });

        // Remove from pending
        const deleteTx = db.transaction('pendingActions', 'readwrite');
        await deleteTx.objectStore('pendingActions').delete(action.id);
      } catch (error) {
        console.error('[SW] Sync failed for action:', action, error);
      }
    }
  } catch (error) {
    console.error('[SW] Background sync error:', error);
  }
}

function openDB() {
  return new Promise((resolve, reject) => {
    const request = indexedDB.open('StudiaDB', 1);

    request.onerror = () => reject(request.error);
    request.onsuccess = () => resolve(request.result);

    request.onupgradeneeded = (event) => {
      const db = event.target.result;
      if (!db.objectStoreNames.contains('pendingActions')) {
        db.createObjectStore('pendingActions', { keyPath: 'id', autoIncrement: true });
      }
    };
  });
}

// Push notifications
self.addEventListener('push', (event) => {
  const data = event.data?.json() || {};

  const options = {
    body: data.body || 'Nouvelle notification',
    icon: '/icons/icon-192x192.png',
    badge: '/icons/icon-72x72.png',
    vibrate: [200, 100, 200],
    data: data.url || '/workspace'
  };

  event.waitUntil(
    self.registration.showNotification(data.title || 'Studia', options)
  );
});

self.addEventListener('notificationclick', (event) => {
  event.notification.close();
  event.waitUntil(
    clients.openWindow(event.notification.data || '/workspace')
  );
});

==================================================
FICHIER : frontend/hooks/useQuizLimit.ts
==================================================

'use client';

import { useUser } from '@clerk/nextjs';
import { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';

export function useQuizLimit() {
  const { user, isLoaded } = useUser();
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (isLoaded) {
      setLoading(false);
    }
  }, [isLoaded]);

  // üîì MODE GRATUIT ILLIMIT√â
  const canGenerateQuiz = true;
  const remaining = Infinity;
  const quizCount = 0;
  const isPremium = false;

  const incrementQuizCount = async () => {
    return;
  };

  const saveQuiz = async (quizData: any, score: number) => {
    if (!user) {
      throw new Error('Vous devez √™tre connect√© pour sauvegarder');
    }

    try {
      const { data: existingUser, error: userCheckError } = await supabase
        .from('users')
        .select('id')
        .eq('id', user.id)
        .single();

      if (userCheckError?.code === 'PGRST116' || !existingUser) {
        await supabase.from('users').insert({
          id: user.id,
          email: user.emailAddresses[0]?.emailAddress,
          created_at: new Date().toISOString()
        });
      }

      const { error } = await supabase
        .from('quiz_history')
        .insert({
          user_id: user.id,
          quiz_data: quizData,
          score: score,
          total_questions: quizData.questions?.length || 0,
          created_at: new Date().toISOString()
        });

      if (error) throw error;

      console.log('‚úÖ Quiz saved to history');
      return true;
    } catch (error) {
      console.error('Error saving quiz:', error);
      throw error;
    }
  };

  return {
    quizCount,
    isPremium,
    canGenerateQuiz,
    remaining,
    loading,
    incrementQuizCount,
    saveQuiz
  };
}

==================================================
FICHIER : frontend/lib/useSupabaseUser.ts
==================================================

import { useEffect } from 'react';
import { useUser } from '@clerk/nextjs';
import { supabase } from '@/lib/supabase';

export function useSupabaseUser() {
  const { user, isLoaded } = useUser();

  useEffect(() => {
    if (isLoaded && user) {
      const syncUser = async () => {
        try {
          console.log('üîÑ Synchronisation user:', user.id);

          // V√©rifier si l'utilisateur existe d√©j√†
          const { data: existingUser } = await supabase
            .from('users')
            .select('id')
            .eq('id', user.id)
            .single();

          if (existingUser) {
            console.log('‚úÖ User existe d√©j√†, pas besoin de sync');
            return;
          }

          // Cr√©er l'utilisateur s'il n'existe pas
          const { error } = await supabase
            .from('users')
            .insert({
              id: user.id,
              email: user.emailAddresses[0]?.emailAddress,
              created_at: new Date().toISOString()
            });

          if (error) {
            // Ignorer l'erreur de duplication (23505 = unique violation)
            if (error.code === '23505') {
              console.log('‚úÖ User existe d√©j√† (duplication d√©tect√©e)');
              return;
            }

            console.error('‚ö†Ô∏è Erreur sync user (non-bloquante):', {
              code: error.code,
              message: error.message,
              details: error.details,
              hint: error.hint
            });
          } else {
            console.log('‚úÖ User synchronis√© dans Supabase');
          }
        } catch (err) {
          console.error('‚ö†Ô∏è Erreur compl√®te (non-bloquante):', err);
        }
      };

      syncUser();
    }
  }, [isLoaded, user]);

  return { user, isLoaded };
}

==================================================
FICHIER : frontend/lib/api.ts
==================================================

// Configuration de l'API
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';

console.log('üîß API Configuration:', {
  API_BASE_URL,
  env: process.env.NEXT_PUBLIC_API_URL
});

// ============================================
// Types
// ============================================

export interface Quiz {
  id: string;
  source: string;
  difficulty: string;
  questions: QuizQuestion[];
  createdAt: string;
  extractedText: string;
}

export interface QuizQuestion {
  id: number;
  question: string;
  options: string[];
  correctAnswer: number;
  explanation: string;
}

export interface Flashcard {
  front: string;
  back: string;
  category: string;
  difficulty: string;
}

export interface FlashcardDeck {
  id: string;
  flashcards: Flashcard[];
  createdAt: string;
}

export interface ExtractedPage {
  pageNumber: number;
  text: string;
  wordCount: number;
}

export interface ExtractTextResult {
  totalImages: number;
  pagesExtracted: number;
  extractedText: string;
  pages: ExtractedPage[];
}

// ============================================
// Helper: Better error handling
// ============================================

async function handleApiResponse(response: Response): Promise<any> {
  const contentType = response.headers.get('content-type');

  // Si pas de content-type ou pas JSON
  if (!contentType || !contentType.includes('application/json')) {
    const text = await response.text();
    console.error('‚ùå Non-JSON Response:', {
      status: response.status,
      statusText: response.statusText,
      contentType,
      body: text.substring(0, 500)
    });
    throw new Error(`Erreur serveur (${response.status}): R√©ponse non-JSON`);
  }

  // Tenter de parser le JSON
  let data;
  try {
    data = await response.json();
  } catch (e) {
    console.error('‚ùå JSON Parse Error:', e);
    throw new Error('Impossible de parser la r√©ponse du serveur');
  }

  // Si erreur HTTP
  if (!response.ok) {
    console.error('‚ùå API Error Response:', {
      status: response.status,
      statusText: response.statusText,
      data
    });

    const errorMessage = data?.detail || data?.message || `Erreur HTTP ${response.status}`;
    throw new Error(errorMessage);
  }

  return data;
}

// ============================================
// API Functions
// ============================================

/**
 * Extract text from multiple images
 */
export async function extractTextFromMultipleImages(
  images: string[]
): Promise<ExtractTextResult> {
  console.log('üåê API Call: Extract text from images', {
    count: images.length,
    url: `${API_BASE_URL}/api/extract-text`,
    firstImagePreview: images[0]?.substring(0, 50) + '...'
  });

  try {
    const response = await fetch(`${API_BASE_URL}/api/extract-text`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        images: images,
      }),
    });

    const data = await handleApiResponse(response);

    console.log('‚úÖ API Response: Extract text success', {
      pagesExtracted: data.pagesExtracted,
      totalChars: data.extractedText?.length
    });

    return data;

  } catch (error: any) {
    console.error('‚ùå API Error:', {
      message: error.message,
      stack: error.stack,
      url: `${API_BASE_URL}/api/extract-text`
    });
    throw error;
  }
}

/**
 * Generate quiz from text
 */
export async function generateQuizFromText(
  courseText: string,
  numQuestions: number = 5,
  difficulty: 'easy' | 'medium' | 'hard' = 'medium'
): Promise<Quiz> {
  console.log('üåê API Call: Generate quiz from text', {
    numQuestions,
    difficulty,
    textLength: courseText.length,
    url: `${API_BASE_URL}/api/quiz/generate-from-text`
  });

  try {
    const response = await fetch(`${API_BASE_URL}/api/quiz/generate-from-text`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        course_text: courseText,
        num_questions: numQuestions,
        difficulty: difficulty,
      }),
    });

    const data = await handleApiResponse(response);

    console.log('‚úÖ API Response: Quiz generated', {
      questionsCount: data.questions?.length
    });

    return data;

  } catch (error: any) {
    console.error('‚ùå API Error:', {
      message: error.message,
      stack: error.stack,
      url: `${API_BASE_URL}/api/quiz/generate-from-text`
    });
    throw error;
  }
}

/**
 * Generate quiz from image
 */
export async function generateQuizFromImage(
  image: string,
  numQuestions: number = 5,
  difficulty: 'easy' | 'medium' | 'hard' = 'medium'
): Promise<Quiz> {
  console.log('üåê API Call: Generate quiz from image', {
    numQuestions,
    difficulty,
    imagePreview: image.substring(0, 50) + '...',
    url: `${API_BASE_URL}/api/quiz/generate-from-image`
  });

  try {
    const response = await fetch(`${API_BASE_URL}/api/quiz/generate-from-image`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        image: image,
        num_questions: numQuestions,
        difficulty: difficulty,
      }),
    });

    const data = await handleApiResponse(response);

    console.log('‚úÖ API Response: Quiz generated from image', {
      questionsCount: data.questions?.length
    });

    return data;

  } catch (error: any) {
    console.error('‚ùå API Error:', {
      message: error.message,
      stack: error.stack,
      url: `${API_BASE_URL}/api/quiz/generate-from-image`
    });
    throw error;
  }
}

/**
 * Generate flashcards from text
 */
export async function generateFlashcards(
  courseText: string,
  numCards: number = 10,
  difficulty: 'easy' | 'medium' | 'hard' = 'medium'
): Promise<FlashcardDeck> {
  console.log('üåê API Call: Generate flashcards', {
    numCards,
    difficulty,
    textLength: courseText.length,
    url: `${API_BASE_URL}/api/flashcards/generate`
  });

  try {
    const response = await fetch(`${API_BASE_URL}/api/flashcards/generate`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        course_text: courseText,
        num_cards: numCards,
        difficulty: difficulty,
      }),
    });

    const data = await handleApiResponse(response);

    console.log('‚úÖ API Response: Flashcards generated', {
      cardsCount: data.flashcards?.length
    });

    return data;

  } catch (error: any) {
    console.error('‚ùå API Error:', {
      message: error.message,
      stack: error.stack,
      url: `${API_BASE_URL}/api/flashcards/generate`
    });
    throw error;
  }
}

/**
 * Check API health
 */
export async function checkApiHealth(): Promise<boolean> {
  try {
    console.log('üè• Checking API health:', `${API_BASE_URL}/api/health`);

    const response = await fetch(`${API_BASE_URL}/api/health`, {
      method: 'GET',
    });

    if (response.ok) {
      const data = await response.json();
      console.log('‚úÖ API is healthy:', data);
      return true;
    } else {
      console.error('‚ùå API health check failed:', response.status);
      return false;
    }
  } catch (error: any) {
    console.error('‚ùå API Health Check Failed:', {
      message: error.message,
      url: `${API_BASE_URL}/api/health`
    });
    return false;
  }
}

==================================================
FICHIER : frontend/lib/exportService.ts
==================================================

import jsPDF from 'jspdf';

export async function exportCourseToPDF(
  title: string,
  content: string,
  metadata?: { date?: string; author?: string }
) {
  const doc = new jsPDF();

  // Header
  doc.setFontSize(20);
  doc.setFont('helvetica', 'bold');
  doc.text(title, 20, 20);

  // Metadata
  doc.setFontSize(10);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(100);
  if (metadata?.date) {
    doc.text(`Date: ${metadata.date}`, 20, 30);
  }
  if (metadata?.author) {
    doc.text(`Auteur: ${metadata.author}`, 20, 35);
  }

  // Content
  doc.setFontSize(12);
  doc.setTextColor(0);
  const lines = doc.splitTextToSize(content, 170);
  doc.text(lines, 20, 45);

  // Footer
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(10);
    doc.setTextColor(150);
    doc.text(`Page ${i} sur ${pageCount}`, 105, 285, { align: 'center' });
    doc.text('G√©n√©r√© par Studia - AI Learning', 105, 290, { align: 'center' });
  }

  doc.save(`${title}.pdf`);
}

export async function exportFlashcardsToPDF(
  title: string,
  flashcards: { front: string; back: string }[]
) {
  const doc = new jsPDF();

  doc.setFontSize(20);
  doc.setFont('helvetica', 'bold');
  doc.text(title, 105, 20, { align: 'center' });

  let yPosition = 40;

  flashcards.forEach((card, index) => {
    if (yPosition > 250) {
      doc.addPage();
      yPosition = 20;
    }

    // Card number
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text(`Carte ${index + 1}`, 20, yPosition);

    yPosition += 10;

    // Front
    doc.setFontSize(12);
    doc.setFont('helvetica', 'bold');
    doc.text('Question:', 20, yPosition);
    doc.setFont('helvetica', 'normal');
    const frontLines = doc.splitTextToSize(card.front, 170);
    doc.text(frontLines, 20, yPosition + 5);

    yPosition += frontLines.length * 5 + 10;

    // Back
    doc.setFont('helvetica', 'bold');
    doc.text('R√©ponse:', 20, yPosition);
    doc.setFont('helvetica', 'normal');
    const backLines = doc.splitTextToSize(card.back, 170);
    doc.text(backLines, 20, yPosition + 5);

    yPosition += backLines.length * 5 + 15;

    // Separator
    doc.setDrawColor(200);
    doc.line(20, yPosition, 190, yPosition);
    yPosition += 10;
  });

  doc.save(`${title}.pdf`);
}

==================================================
FICHIER : frontend/lib/translations.ts
==================================================

export const translations = {
  en: {
    nav: {
      home: 'Home',
      about: 'About',
      features: 'Features',
      why: 'Why Studia',
      creator: 'Creator',
      workspace: 'Workspace',
      joinWaitlist: 'Join Waitlist',
    },
    hero: {
      badge: 'AI-Powered Learning Platform',
      title: 'The Future of',
      titleHighlight: 'Learning',
      subtitle: 'Studia automates repetitive learning tasks with AI. Create flashcards, generate quizzes, and accelerate your learning journey‚Äîeffortlessly.',
      cta1: 'Get Early Access',
      cta2: 'Learn More',
      stat1Title: 'AI-Powered',
      stat1Desc: 'Smart Automation',
      stat2Title: '100%',
      stat2Desc: 'Free to Start',
      stat3Title: '‚àû',
      stat3Desc: 'Possibilities',
    },
    about: {
      title: 'What is',
      titleHighlight: 'Studia?',
      subtitle: 'Studia is an AI-powered learning platform designed to revolutionize how people study and retain information.',
      mission: 'Our Mission',
      missionDesc: 'To become the Microsoft of learning‚Äîempowering everyone with intelligent tools that make education accessible, efficient, and effective.',
      vision: 'Our Vision',
      visionDesc: 'A world where learning is personalized, automated, and optimized through artificial intelligence‚Äîsaving time and boosting results.',
      approach: 'Our Approach',
      approachDesc: 'Leverage cutting-edge AI to automate tedious tasks like flashcard creation and quiz generation, letting you focus on actual learning.',
    },
    features: {
      title: 'Powerful',
      titleHighlight: 'Features',
      subtitle: 'Everything you need to supercharge your learning, powered by artificial intelligence.',
      feature1: 'AI Flashcard Generator',
      feature1Desc: 'Transform any text, PDF, or notes into perfectly structured flashcards in seconds.',
      feature2: 'Smart Quiz Creation',
      feature2Desc: 'Generate custom quizzes tailored to your learning material with AI precision.',
      feature3: 'Spaced Repetition',
      feature3Desc: 'Optimize retention with intelligent spaced repetition algorithms.',
      feature4: 'Progress Tracking',
      feature4Desc: 'Monitor your learning journey with detailed analytics and insights.',
      feature5: 'Smart Summaries',
      feature5Desc: 'Get concise, AI-generated summaries of complex topics instantly.',
      feature6: 'Personalized Learning',
      feature6Desc: 'Adaptive learning paths that adjust to your pace and preferences.',
    },
    why: {
      title: 'Why Choose',
      titleHighlight: 'Studia?',
      subtitle: 'Learning shouldn\'t be a battle against tedious tasks. Studia eliminates the busywork so you can focus on what truly matters: understanding and mastering your subject.',
      benefit1: 'Save Hours Every Week',
      benefit1Desc: 'Stop wasting time manually creating study materials. Let AI do the heavy lifting.',
      benefit2: 'Learn Faster & Retain More',
      benefit2Desc: 'Science-backed techniques like spaced repetition ensure information sticks.',
      benefit3: 'Study Smarter, Not Harder',
      benefit3Desc: 'Focus on understanding concepts while Studia handles organization and review.',
      benefit4: 'Accessible Anywhere, Anytime',
      benefit4Desc: 'Web-based platform accessible from any device‚Äîstudy on your terms.',
      benefit5: 'Completely Free to Start',
      benefit5Desc: 'Get started with powerful features at no cost. Premium options available later.',
      benefit6: 'Built by Learners, for Learners',
      benefit6Desc: 'Designed by someone who understands the struggles of modern education.',
    },
    creator: {
      title: 'Meet the',
      titleHighlight: 'Creator',
      subtitle: 'Built with passion and dedication to transform learning',
      role: 'Founder & Developer',
      bio: 'As a passionate developer and lifelong learner, I created Studia to solve a problem I faced daily: the time-consuming nature of creating study materials. By combining my love for technology and education, Studia was born‚Äîa platform that empowers learners worldwide to study smarter, not harder.',
      quote: '"Education is the most powerful weapon we can use to change the world. Studia is my contribution to that change."',
    },
    cta: {
      title: 'Ready to Transform Your Learning?',
      subtitle: 'Join the waitlist and be among the first to experience the future of AI-powered education.',
      placeholder: 'Enter your email',
      button: 'Join Waitlist',
      success: 'Thanks! You\'re on the waitlist. Check your email!',
      trust1: 'No credit card required',
      trust2: 'Free to start',
      trust3: 'Cancel anytime',
    },
    footer: {
      description: 'AI-powered learning platform designed to revolutionize how people study and retain information.',
      quickLinks: 'Quick Links',
      legal: 'Legal',
      privacy: 'Privacy Policy',
      terms: 'Terms of Service',
      cookies: 'Cookie Policy',
      rights: 'All rights reserved.',
      madeWith: 'Made with',
      by: 'by Daniel Leo',
    },
  },
  fr: {
    nav: {
      home: 'Accueil',
      about: '√Ä propos',
      features: 'Fonctionnalit√©s',
      why: 'Pourquoi Studia',
      creator: 'Cr√©ateur',
      workspace: 'Workspace',
      joinWaitlist: 'Liste d\'attente',
    },
    hero: {
      badge: 'Plateforme d\'apprentissage IA',
      title: 'L\'avenir de',
      titleHighlight: 'l\'apprentissage',
      subtitle: 'Studia automatise les t√¢ches d\'apprentissage r√©p√©titives avec l\'IA. Cr√©ez des cartes m√©mo, g√©n√©rez des quiz et acc√©l√©rez votre parcours d\'apprentissage‚Äîsans effort.',
      cta1: 'Acc√®s anticip√©',
      cta2: 'En savoir plus',
      stat1Title: 'Propuls√© par IA',
      stat1Desc: 'Automation intelligente',
      stat2Title: '100%',
      stat2Desc: 'Gratuit pour commencer',
      stat3Title: '‚àû',
      stat3Desc: 'Possibilit√©s',
    },
    about: {
      title: 'Qu\'est-ce que',
      titleHighlight: 'Studia ?',
      subtitle: 'Studia est une plateforme d\'apprentissage propuls√©e par l\'IA con√ßue pour r√©volutionner la fa√ßon dont les gens √©tudient et retiennent l\'information.',
      mission: 'Notre Mission',
      missionDesc: 'Devenir le Microsoft de l\'apprentissage‚Äîdonner √† chacun des outils intelligents qui rendent l\'√©ducation accessible, efficace et performante.',
      vision: 'Notre Vision',
      visionDesc: 'Un monde o√π l\'apprentissage est personnalis√©, automatis√© et optimis√© gr√¢ce √† l\'intelligence artificielle‚Äî√©conomisant du temps et am√©liorant les r√©sultats.',
      approach: 'Notre Approche',
      approachDesc: 'Utiliser l\'IA de pointe pour automatiser les t√¢ches fastidieuses comme la cr√©ation de cartes m√©mo et de quiz, vous permettant de vous concentrer sur l\'apprentissage r√©el.',
    },
    features: {
      title: 'Fonctionnalit√©s',
      titleHighlight: 'puissantes',
      subtitle: 'Tout ce dont vous avez besoin pour booster votre apprentissage, propuls√© par l\'intelligence artificielle.',
      feature1: 'G√©n√©rateur de cartes IA',
      feature1Desc: 'Transformez n\'importe quel texte, PDF ou notes en cartes m√©mo parfaitement structur√©es en quelques secondes.',
      feature2: 'Cr√©ation de quiz intelligents',
      feature2Desc: 'G√©n√©rez des quiz personnalis√©s adapt√©s √† votre mat√©riel d\'apprentissage avec pr√©cision IA.',
      feature3: 'R√©p√©tition espac√©e',
      feature3Desc: 'Optimisez la r√©tention avec des algorithmes de r√©p√©tition espac√©e intelligents.',
      feature4: 'Suivi des progr√®s',
      feature4Desc: 'Surveillez votre parcours d\'apprentissage avec des analyses et insights d√©taill√©s.',
      feature5: 'R√©sum√©s intelligents',
      feature5Desc: 'Obtenez des r√©sum√©s concis g√©n√©r√©s par IA de sujets complexes instantan√©ment.',
      feature6: 'Apprentissage personnalis√©',
      feature6Desc: 'Parcours d\'apprentissage adaptatifs qui s\'ajustent √† votre rythme et pr√©f√©rences.',
    },
    why: {
      title: 'Pourquoi choisir',
      titleHighlight: 'Studia ?',
      subtitle: 'L\'apprentissage ne devrait pas √™tre une bataille contre des t√¢ches fastidieuses. Studia √©limine le travail r√©p√©titif pour que vous puissiez vous concentrer sur ce qui compte vraiment : comprendre et ma√Ætriser votre sujet.',
      benefit1: '√âconomisez des heures chaque semaine',
      benefit1Desc: 'Arr√™tez de perdre du temps √† cr√©er manuellement du mat√©riel d\'√©tude. Laissez l\'IA faire le travail.',
      benefit2: 'Apprenez plus vite et retenez plus',
      benefit2Desc: 'Des techniques scientifiques comme la r√©p√©tition espac√©e garantissent que l\'information reste.',
      benefit3: '√âtudiez plus intelligemment, pas plus dur',
      benefit3Desc: 'Concentrez-vous sur la compr√©hension des concepts pendant que Studia g√®re l\'organisation et la r√©vision.',
      benefit4: 'Accessible partout, √† tout moment',
      benefit4Desc: 'Plateforme web accessible depuis n\'importe quel appareil‚Äî√©tudiez √† vos conditions.',
      benefit5: 'Compl√®tement gratuit pour commencer',
      benefit5Desc: 'Commencez avec des fonctionnalit√©s puissantes sans frais. Options premium disponibles plus tard.',
      benefit6: 'Construit par des apprenants, pour des apprenants',
      benefit6Desc: 'Con√ßu par quelqu\'un qui comprend les d√©fis de l\'√©ducation moderne.',
    },
    creator: {
      title: 'Rencontrez le',
      titleHighlight: 'cr√©ateur',
      subtitle: 'Construit avec passion et d√©vouement pour transformer l\'apprentissage',
      role: 'Fondateur & D√©veloppeur',
      bio: 'En tant que d√©veloppeur passionn√© et apprenant √† vie, j\'ai cr√©√© Studia pour r√©soudre un probl√®me auquel je faisais face quotidiennement : la nature chronophage de la cr√©ation de mat√©riel d\'√©tude. En combinant mon amour pour la technologie et l\'√©ducation, Studia est n√©‚Äîune plateforme qui permet aux apprenants du monde entier d\'√©tudier plus intelligemment, pas plus dur.',
      quote: '"L\'√©ducation est l\'arme la plus puissante que nous pouvons utiliser pour changer le monde. Studia est ma contribution √† ce changement."',
    },
    cta: {
      title: 'Pr√™t √† transformer votre apprentissage ?',
      subtitle: 'Rejoignez la liste d\'attente et soyez parmi les premiers √† d√©couvrir l\'avenir de l\'√©ducation propuls√©e par l\'IA.',
      placeholder: 'Entrez votre email',
      button: 'Liste d\'attente',
      success: 'Merci ! Vous √™tes sur la liste d\'attente. V√©rifiez votre email !',
      trust1: 'Aucune carte de cr√©dit requise',
      trust2: 'Gratuit pour commencer',
      trust3: 'Annulez √† tout moment',
    },
    footer: {
      description: 'Plateforme d\'apprentissage propuls√©e par l\'IA con√ßue pour r√©volutionner la fa√ßon dont les gens √©tudient et retiennent l\'information.',
      quickLinks: 'Liens rapides',
      legal: 'L√©gal',
      privacy: 'Politique de confidentialit√©',
      terms: 'Conditions d\'utilisation',
      cookies: 'Politique des cookies',
      rights: 'Tous droits r√©serv√©s.',
      madeWith: 'Fait avec',
      by: 'par Daniel Leo',
    },
  },
};

export type Language = 'en' | 'fr';
export type Translations = typeof translations.en;

==================================================
FICHIER : frontend/lib/themeStore.ts
==================================================

import { create } from 'zustand';
import { persist } from 'zustand/middleware';

interface ThemeStore {
  isDark: boolean;
  toggle: () => void;
  setDark: (value: boolean) => void;
}

export const useTheme = create<ThemeStore>()(
  persist(
    (set) => ({
      isDark: false,
      toggle: () => set((state) => {
        const newIsDark = !state.isDark;

        // ‚úÖ CORRECTION : Appliquer sur document.documentElement
        if (typeof window !== 'undefined') {
          if (newIsDark) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
          } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
          }
        }

        return { isDark: newIsDark };
      }),
      setDark: (value: boolean) => set(() => {
        if (typeof window !== 'undefined') {
          if (value) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
          } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
          }
        }
        return { isDark: value };
      }),
    }),
    {
      name: 'studia-theme',
      // ‚úÖ CORRECTION : Charger le theme au d√©marrage
      onRehydrateStorage: () => (state) => {
        if (typeof window !== 'undefined' && state?.isDark) {
          document.documentElement.classList.add('dark');
        }
      },
    }
  )
);

==================================================
FICHIER : frontend/lib/courseService.ts
==================================================

import { supabase } from './supabase';

export interface Course {
  id: number;
  user_id: string;
  title: string;
  description?: string;
  extracted_text: string;
  created_at: string;
  exam_date?: string | null;
}

/**
 * Sauvegarde un nouveau cours dans Supabase
 * S'assure d'abord que l'utilisateur existe dans la table 'users'
 */
export async function saveCourse(userId: string, extractedText: string, title: string) {
  try {
    // 1. Synchronisation de l'utilisateur (Cr√©ation s'il n'existe pas)
    // C'est crucial pour √©viter l'erreur "foreign key constraint"
    const { error: userError } = await supabase
      .from('users')
      .upsert(
        {
          id: userId,
          // On peut ajouter d'autres champs par d√©faut ici si besoin
          // xp: 0, level: 1... (mais Supabase a d√©j√† des defaults)
        },
        { onConflict: 'id', ignoreDuplicates: true }
      );

    if (userError) {
      console.warn("‚ö†Ô∏è Warning: Impossible de synchroniser l'utilisateur", userError.message);
      // On ne bloque pas le processus, on tente quand m√™me de sauvegarder le cours
    }

    // 2. Sauvegarde du cours
    const { data, error } = await supabase
      .from('courses')
      .insert([
        {
          user_id: userId,
          title: title,
          extracted_text: extractedText,
        }
      ])
      .select()
      .single();

    if (error) {
      console.error('‚ùå Erreur Supabase (insert course):', error);
      throw new Error(error.message);
    }

    return data;

  } catch (err: any) {
    console.error('‚ùå Erreur Service:', err);
    throw new Error(err.message || 'Impossible de sauvegarder le cours');
  }
}

/**
 * R√©cup√®re tous les cours d'un utilisateur
 */
export async function getUserCourses(userId: string) {
  const { data, error } = await supabase
    .from('courses')
    .select('*')
    .eq('user_id', userId)
    .order('created_at', { ascending: false });

  if (error) {
    throw new Error(error.message);
  }

  return data as Course[];
}

/**
 * R√©cup√®re un cours sp√©cifique par son ID
 */
export async function getCourseById(courseId: number, userId: string) {
  const { data, error } = await supabase
    .from('courses')
    .select('*')
    .eq('id', courseId)
    .eq('user_id', userId)
    .single();

  if (error) {
    throw new Error(error.message);
  }

  return data as Course;
}

/**
 * Met √† jour un cours (titre, description)
 */
export async function updateCourse(courseId: number, userId: string, updates: Partial<Course>) {
  const { data, error } = await supabase
    .from('courses')
    .update(updates)
    .eq('id', courseId)
    .eq('user_id', userId)
    .select()
    .single();

  if (error) {
    throw new Error(error.message);
  }

  return data;
}

/**
 * Supprime un cours
 */
export async function deleteCourse(courseId: number, userId: string) {
  const { error } = await supabase
    .from('courses')
    .delete()
    .eq('id', courseId)
    .eq('user_id', userId);

  if (error) {
    throw new Error(error.message);
  }

  return true;
}

==================================================
FICHIER : frontend/lib/supabase.ts
==================================================

import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);

==================================================
FICHIER : frontend/lib/flashcardService.ts
==================================================

import { supabase } from './supabase';

export interface Flashcard {
  front: string;
  back: string;
  category: string;
  difficulty: string;
}

export interface FlashcardDeck {
  id: number;
  user_id: string;
  course_id: number | null;
  title: string;
  flashcards: Flashcard[];
  difficulty: string;
  created_at: string;
}

export interface FlashcardProgress {
  id: number;
  user_id: string;
  deck_id: number;
  card_index: number;
  last_reviewed: string;
  ease_factor: number;
  interval_days: number;
  repetitions: number;
}

/**
 * Sauvegarder un deck de flashcards
 */
export async function saveFlashcardDeck(
  userId: string,
  flashcards: Flashcard[],
  title: string,
  difficulty: string,
  courseId?: number
): Promise<FlashcardDeck> {
  const { data, error } = await supabase
    .from('flashcard_decks')
    .insert({
      user_id: userId,
      course_id: courseId || null,
      title,
      flashcards,
      difficulty,
      created_at: new Date().toISOString()
    })
    .select()
    .single();

  if (error) throw error;
  return data;
}

/**
 * R√©cup√©rer tous les decks d'un utilisateur
 */
export async function getUserFlashcardDecks(userId: string): Promise<FlashcardDeck[]> {
  const { data, error } = await supabase
    .from('flashcard_decks')
    .select('*')
    .eq('user_id', userId)
    .order('created_at', { ascending: false });

  if (error) throw error;
  return data || [];
}

/**
 * R√©cup√©rer les decks d'un cours sp√©cifique
 */
export async function getCourseFlashcardDecks(
  userId: string,
  courseId: number
): Promise<FlashcardDeck[]> {
  const { data, error } = await supabase
    .from('flashcard_decks')
    .select('*')
    .eq('user_id', userId)
    .eq('course_id', courseId)
    .order('created_at', { ascending: false });

  if (error) throw error;
  return data || [];
}

/**
 * R√©cup√©rer un deck par ID
 */
export async function getFlashcardDeckById(
  deckId: number,
  userId: string
): Promise<FlashcardDeck | null> {
  const { data, error } = await supabase
    .from('flashcard_decks')
    .select('*')
    .eq('id', deckId)
    .eq('user_id', userId)
    .single();

  if (error) return null;
  return data;
}

/**
 * Supprimer un deck
 */
export async function deleteFlashcardDeck(
  deckId: number,
  userId: string
): Promise<void> {
  const { error } = await supabase
    .from('flashcard_decks')
    .delete()
    .eq('id', deckId)
    .eq('user_id', userId);

  if (error) throw error;
}

/**
 * Sauvegarder la progression d'une carte (VERSION CORRIG√âE)
 */
export async function saveCardProgress(
  userId: string,
  deckId: number,
  cardIndex: number,
  remembered: boolean
): Promise<void> {
  try {
    console.log('üíæ Sauvegarde progression:', { userId, deckId, cardIndex, remembered });

    // 1. R√©cup√©rer la progression actuelle
    const { data: existing, error: fetchError } = await supabase
      .from('flashcard_progress')
      .select('*')
      .eq('user_id', userId)
      .eq('deck_id', deckId)
      .eq('card_index', cardIndex)
      .maybeSingle(); // ‚úÖ maybeSingle() pour √©viter les erreurs si pas de r√©sultat

    if (fetchError) {
      console.error('‚ùå Erreur lecture progression:', fetchError);
      throw fetchError;
    }

    console.log('üìä Progression existante:', existing);

    // 2. Calculer les nouvelles valeurs selon l'algorithme de r√©p√©tition espac√©e
    let easeFactor = existing?.ease_factor || 2.5;
    let intervalDays = existing?.interval_days || 1;
    let repetitions = existing?.repetitions || 0;

    if (remembered) {
      repetitions += 1;
      if (repetitions === 1) {
        intervalDays = 1;
      } else if (repetitions === 2) {
        intervalDays = 6;
      } else {
        intervalDays = Math.round(intervalDays * easeFactor);
      }
      easeFactor = Math.max(1.3, easeFactor + 0.1);
    } else {
      repetitions = 0;
      intervalDays = 1;
      easeFactor = Math.max(1.3, easeFactor - 0.2);
    }

    const progressData = {
      user_id: userId,
      deck_id: deckId,
      card_index: cardIndex,
      last_reviewed: new Date().toISOString(),
      ease_factor: easeFactor,
      interval_days: intervalDays,
      repetitions: repetitions
    };

    console.log('üíæ Donn√©es √† sauvegarder:', progressData);

    // 3. UPDATE si existe, sinon INSERT
    if (existing) {
      console.log('üîÑ UPDATE progression existante (id:', existing.id, ')');

      const { error } = await supabase
        .from('flashcard_progress')
        .update({
          last_reviewed: progressData.last_reviewed,
          ease_factor: progressData.ease_factor,
          interval_days: progressData.interval_days,
          repetitions: progressData.repetitions
        })
        .eq('user_id', userId)
        .eq('deck_id', deckId)
        .eq('card_index', cardIndex);

      if (error) {
        console.error('‚ùå Erreur UPDATE:', error);
        throw error;
      }

      console.log('‚úÖ UPDATE r√©ussi');

    } else {
      console.log('‚ûï INSERT nouvelle progression');

      const { error } = await supabase
        .from('flashcard_progress')
        .insert(progressData);

      if (error) {
        console.error('‚ùå Erreur INSERT:', error);
        throw error;
      }

      console.log('‚úÖ INSERT r√©ussi');
    }

    console.log('‚úÖ Progression sauvegard√©e avec succ√®s');

  } catch (error: any) {
    console.error('‚ùå ERREUR COMPL√àTE saveCardProgress:', {
      error,
      message: error?.message,
      code: error?.code,
      details: error?.details,
      hint: error?.hint,
      userId,
      deckId,
      cardIndex,
      remembered
    });
    throw error;
  }
}

/**
 * R√©cup√©rer la progression d'un deck
 */
export async function getDeckProgress(
  userId: string,
  deckId: number
): Promise<FlashcardProgress[]> {
  const { data, error } = await supabase
    .from('flashcard_progress')
    .select('*')
    .eq('user_id', userId)
    .eq('deck_id', deckId);

  if (error) throw error;
  return data || [];
}

==================================================
FICHIER : frontend/lib/gamificationService.ts
==================================================

import { supabase } from './supabase';

const XP_PER_LEVEL_BASE = 100;

export interface UserProgress {
  xp: number;
  level: number;
  streak_days: number;
  next_level_xp: number;
  progress_percent: number;
}

export function calculateLevel(totalXp: number): number {
  if (totalXp < 0) return 1;
  return Math.floor(Math.sqrt(totalXp / XP_PER_LEVEL_BASE)) + 1;
}

export function xpForNextLevel(currentLevel: number): number {
  return Math.pow(currentLevel, 2) * XP_PER_LEVEL_BASE;
}

export async function addXp(userId: string, amount: number, action: string) {
  try {
    // 1. On r√©cup√®re l'XP actuel (si l'user existe)
    const { data: user } = await supabase
      .from('users')
      .select('xp, level')
      .eq('id', userId)
      .single();

    // 2. Calcul des nouvelles valeurs
    const currentXp = user?.xp || 0;
    const newXp = currentXp + amount;
    const newLevel = calculateLevel(newXp);
    const leveledUp = newLevel > (user?.level || 1);

    // 3. Mise √† jour ou Cr√©ation (Upsert) pour √™tre s√ªr √† 100%
    const { error } = await supabase
      .from('users')
      .upsert({
        id: userId, // Cl√© primaire
        xp: newXp,
        level: newLevel,
        last_study_date: new Date().toISOString()
      }, { onConflict: 'id' });

    if (error) {
      console.error('‚ùå Erreur SQL Gamification:', error);
      return { success: false };
    }

    // 4. Notifier l'interface
    if (typeof window !== 'undefined') {
      window.dispatchEvent(new Event('xp-updated'));
      if (leveledUp) {
        // On peut ajouter une alerte ici plus tard
        console.log("üÜô LEVEL UP!");
      }
    }

    console.log(`üéâ XP Gained: +${amount} (${action}) | Total: ${newXp}`);
    return { success: true, newLevel, xpGained: amount };

  } catch (error) {
    console.error('‚ùå Erreur Gamification:', error);
    return { success: false };
  }
}

export async function getUserProgress(userId: string): Promise<UserProgress | null> {
  const { data: user } = await supabase
    .from('users')
    .select('xp, level, streak_days')
    .eq('id', userId)
    .single();

  if (!user) return {
    xp: 0, level: 1, streak_days: 0, next_level_xp: 100, progress_percent: 0
  };

  const currentLevel = user.level || 1;
  const nextLevelXp = xpForNextLevel(currentLevel);
  const currentLevelBaseXp = xpForNextLevel(currentLevel - 1);

  const xpInLevel = (user.xp || 0) - currentLevelBaseXp;
  const xpNeededForLevel = nextLevelXp - currentLevelBaseXp;

  const progress_percent = Math.min(100, Math.max(0, (xpInLevel / xpNeededForLevel) * 100));

  return {
    xp: user.xp || 0,
    level: currentLevel,
    streak_days: user.streak_days || 0,
    next_level_xp: nextLevelXp,
    progress_percent
  };
}

==================================================
FICHIER : frontend/lib/pwaService.ts
==================================================

export class PWAService {
  private static db: IDBDatabase | null = null;

  static async init() {
    if ('serviceWorker' in navigator) {
      try {
        const registration = await navigator.serviceWorker.register('/sw.js');
        console.log('‚úÖ Service Worker enregistr√©:', registration);

        // Listen for updates
        registration.addEventListener('updatefound', () => {
          const newWorker = registration.installing;
          newWorker?.addEventListener('statechange', () => {
            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
              // New version available
              if (confirm('Nouvelle version disponible ! Recharger ?')) {
                window.location.reload();
              }
            }
          });
        });

        // Background sync
        if ('sync' in registration) {
          console.log('‚úÖ Background Sync support√©');
        }

        // Push notifications
        if ('pushManager' in registration) {
          console.log('‚úÖ Push Notifications support√©es');
        }

      } catch (error) {
        console.error('‚ùå Erreur Service Worker:', error);
      }
    }

    // Init IndexedDB
    await this.initDB();
  }

  static async initDB(): Promise<void> {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open('StudiaDB', 1);

      request.onerror = () => reject(request.error);
      request.onsuccess = () => {
        this.db = request.result;
        resolve();
      };

      request.onupgradeneeded = (event) => {
        const db = (event.target as IDBOpenDBRequest).result;

        // Store for offline courses
        if (!db.objectStoreNames.contains('courses')) {
          const courseStore = db.createObjectStore('courses', { keyPath: 'id' });
          courseStore.createIndex('user_id', 'user_id', { unique: false });
        }

        // Store for offline flashcards
        if (!db.objectStoreNames.contains('flashcards')) {
          const flashcardStore = db.createObjectStore('flashcards', { keyPath: 'id' });
          flashcardStore.createIndex('user_id', 'user_id', { unique: false });
        }

        // Store for pending actions (sync queue)
        if (!db.objectStoreNames.contains('pendingActions')) {
          db.createObjectStore('pendingActions', { keyPath: 'id', autoIncrement: true });
        }
      };
    });
  }

  static async saveCourseOffline(course: any) {
    if (!this.db) await this.initDB();

    return new Promise((resolve, reject) => {
      const tx = this.db!.transaction('courses', 'readwrite');
      const store = tx.objectStore('courses');
      const request = store.put(course);

      request.onsuccess = () => resolve(request.result);
      request.onerror = () => reject(request.error);
    });
  }

  static async getCourseOffline(id: number) {
    if (!this.db) await this.initDB();

    return new Promise((resolve, reject) => {
      const tx = this.db!.transaction('courses', 'readonly');
      const store = tx.objectStore('courses');
      const request = store.get(id);

      request.onsuccess = () => resolve(request.result);
      request.onerror = () => reject(request.error);
    });
  }

  static async getCoursesOffline(userId: string) {
    if (!this.db) await this.initDB();

    return new Promise<any[]>((resolve, reject) => {
      const tx = this.db!.transaction('courses', 'readonly');
      const store = tx.objectStore('courses');
      const index = store.index('user_id');
      const request = index.getAll(userId);

      request.onsuccess = () => resolve(request.result || []);
      request.onerror = () => reject(request.error);
    });
  }

  static async addPendingAction(action: any) {
    if (!this.db) await this.initDB();

    return new Promise((resolve, reject) => {
      const tx = this.db!.transaction('pendingActions', 'readwrite');
      const store = tx.objectStore('pendingActions');
      const request = store.add(action);

      request.onsuccess = () => {
        // Try to sync immediately
        if ('serviceWorker' in navigator && 'sync' in ServiceWorkerRegistration.prototype) {
          navigator.serviceWorker.ready.then((registration) => {
            return (registration as any).sync.register('sync-data');
          });
        }
        resolve(request.result);
      };
      request.onerror = () => reject(request.error);
    });
  }

  static isOnline(): boolean {
    return navigator.onLine;
  }

  static async getInstallPrompt() {
    let deferredPrompt: any;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });

    return deferredPrompt;
  }

  static async showInstallPrompt() {
    const deferredPrompt = await this.getInstallPrompt();

    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      console.log(`User response: ${outcome}`);
      return outcome === 'accepted';
    }

    return false;
  }
}

==================================================
FICHIER : backend/src/studia/quiz.json
==================================================


[
    {
        "question": "Quelle est la formule de la production selon le cours?",
        "answer": "Production = Travail humain + Machines + Mat√©riel permanent (capital)"
    },
    {
        "question": "Quel organisme est repr√©sent√© par l'acronyme Insee?",
        "answer": "Institut national de la statistique et des √©tudes √©conomiques"
    },
    {
        "question": "Comment doit-on consid√©rer la production selon le cours?",
        "answer": "Comme une activit√© socialement organis√©e visant √† cr√©er des biens et des services."
    },
    {
        "question": "Qu'est-ce qu'un mod√®le dans le contexte du cours?",
        "answer": "Une repr√©sentation simplifi√©e de la r√©alit√©, qui ne retient que quelques √©l√©ments frais d‚Äôalgorithmes de causalit√© entre eux."
    },
    {
        "question": "Quels sont les trois √©l√©ments composant le sch√©ma de la production dans le cours?",
        "answer": "Production, Consommation, Repartition des ressources"
    },
    {
        "question": "Comment d√©finit-on un bien?",
        "answer": "Un produit mat√©riel r√©sultant de la production."
    },
    {
        "question": "Comment d√©finit-on un service?",
        "answer": "Un produit immat√©riel r√©sultant de la production."
    },
    {
        "question": "Quels sont les deux types de production mentionn√©s dans le cours?",
        "answer": "Marchande et Non marchande."
    },
    {
        "question": "Qu'est-ce que la production marchande?",
        "answer": "La production propos√©e et vendue sur le march√© en une qui couvre au moins les co√ªts de production."
    },
    {
        "question": "Qu'est-ce que la production non marchande?",
        "answer": "La production non marchande correspond aux services offerts gratuitement ou pour gratuitement par les administrations publiques."
    }
]


==================================================
FICHIER : venv_studia/lib/python3.13/site-packages/urllib3/contrib/emscripten/emscripten_fetch_worker.js
==================================================

let Status = {
  SUCCESS_HEADER: -1,
  SUCCESS_EOF: -2,
  ERROR_TIMEOUT: -3,
  ERROR_EXCEPTION: -4,
};

let connections = {};
let nextConnectionID = 1;
const encoder = new TextEncoder();

self.addEventListener("message", async function (event) {
  if (event.data.close) {
    let connectionID = event.data.close;
    delete connections[connectionID];
    return;
  } else if (event.data.getMore) {
    let connectionID = event.data.getMore;
    let { curOffset, value, reader, intBuffer, byteBuffer } =
      connections[connectionID];
    // if we still have some in buffer, then just send it back straight away
    if (!value || curOffset >= value.length) {
      // read another buffer if required
      try {
        let readResponse = await reader.read();

        if (readResponse.done) {
          // read everything - clear connection and return
          delete connections[connectionID];
          Atomics.store(intBuffer, 0, Status.SUCCESS_EOF);
          Atomics.notify(intBuffer, 0);
          // finished reading successfully
          // return from event handler
          return;
        }
        curOffset = 0;
        connections[connectionID].value = readResponse.value;
        value = readResponse.value;
      } catch (error) {
        console.log("Request exception:", error);
        let errorBytes = encoder.encode(error.message);
        let written = errorBytes.length;
        byteBuffer.set(errorBytes);
        intBuffer[1] = written;
        Atomics.store(intBuffer, 0, Status.ERROR_EXCEPTION);
        Atomics.notify(intBuffer, 0);
      }
    }

    // send as much buffer as we can
    let curLen = value.length - curOffset;
    if (curLen > byteBuffer.length) {
      curLen = byteBuffer.length;
    }
    byteBuffer.set(value.subarray(curOffset, curOffset + curLen), 0);

    Atomics.store(intBuffer, 0, curLen); // store current length in bytes
    Atomics.notify(intBuffer, 0);
    curOffset += curLen;
    connections[connectionID].curOffset = curOffset;

    return;
  } else {
    // start fetch
    let connectionID = nextConnectionID;
    nextConnectionID += 1;
    const intBuffer = new Int32Array(event.data.buffer);
    const byteBuffer = new Uint8Array(event.data.buffer, 8);
    try {
      const response = await fetch(event.data.url, event.data.fetchParams);
      // return the headers first via textencoder
      var headers = [];
      for (const pair of response.headers.entries()) {
        headers.push([pair[0], pair[1]]);
      }
      let headerObj = {
        headers: headers,
        status: response.status,
        connectionID,
      };
      const headerText = JSON.stringify(headerObj);
      let headerBytes = encoder.encode(headerText);
      let written = headerBytes.length;
      byteBuffer.set(headerBytes);
      intBuffer[1] = written;
      // make a connection
      connections[connectionID] = {
        reader: response.body.getReader(),
        intBuffer: intBuffer,
        byteBuffer: byteBuffer,
        value: undefined,
        curOffset: 0,
      };
      // set header ready
      Atomics.store(intBuffer, 0, Status.SUCCESS_HEADER);
      Atomics.notify(intBuffer, 0);
      // all fetching after this goes through a new postmessage call with getMore
      // this allows for parallel requests
    } catch (error) {
      console.log("Request exception:", error);
      let errorBytes = encoder.encode(error.message);
      let written = errorBytes.length;
      byteBuffer.set(errorBytes);
      intBuffer[1] = written;
      Atomics.store(intBuffer, 0, Status.ERROR_EXCEPTION);
      Atomics.notify(intBuffer, 0);
    }
  }
});
self.postMessage({ inited: true });
